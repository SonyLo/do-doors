import{_ as y}from"./AuthenticatedLayout-DWs3fbAz.js";import{m as $,o as l,c as i,b as e,f as c,v as h,g as a,e as d,F as _,r as p,d as f,t as r,h as k,i as v,j as w,a as b,u as C,w as g,Z as j}from"./app-CDSPXogr.js";import{P as F}from"./Pagination-CbKJCuuj.js";import{R as L}from"./RalColorSelector-Ck90R-47.js";import"./ApplicationLogo-07yOrteH.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-the-mask-BcuUQ0IT.js";const z={class:"row"},M={class:"col-12"},S={class:"input-group mb-3"},V={class:"form-floating"},A=e("label",{for:"search-colors"},"Поиск по цвету",-1),I=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),O=[I],T={style:{"overflow-y":"auto"}},U={key:0,class:"table"},E={key:0},P=e("i",{class:"fa-solid fa-caret-down"},null,-1),q=[P],B={key:1},N=e("i",{class:"fa-solid fa-caret-up"},null,-1),D=[N],R={key:0},G=e("i",{class:"fa-solid fa-caret-down"},null,-1),J=[G],Z={key:1},H=e("i",{class:"fa-solid fa-caret-up"},null,-1),K=[H],Q={key:0},W=e("i",{class:"fa-solid fa-caret-down"},null,-1),X=[W],Y={key:1},x=e("i",{class:"fa-solid fa-caret-up"},null,-1),ee=[x],se={key:0},te=e("i",{class:"fa-solid fa-caret-down"},null,-1),oe=[te],le={key:1},ie=e("i",{class:"fa-solid fa-caret-up"},null,-1),ne=[ie],de={key:0},re=e("i",{class:"fa-solid fa-caret-down"},null,-1),ae=[re],ce={key:1},ue=e("i",{class:"fa-solid fa-caret-up"},null,-1),he=[ue],_e={key:0},pe=e("i",{class:"fa-solid fa-caret-down"},null,-1),me=[pe],fe={key:1},be=e("i",{class:"fa-solid fa-caret-up"},null,-1),ge=[be],ye={key:0},$e=e("i",{class:"fa-solid fa-caret-down"},null,-1),ke=[$e],ve={key:1},we=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ce=[we],je=e("th",{scope:"col",class:"text-center"},"Действие",-1),Fe={scope:"row"},Le=["onClick"],ze={class:"text-center"},Me={key:0,class:"w-100"},Se=e("thead",null,[e("th",null,"опт"),e("th",null,"дилер"),e("th",null,"розница"),e("th",null,"себестоимость")],-1),Ve={style:{"min-width":"100px","text-align":"center"}},Ae={style:{"min-width":"100px","text-align":"center"}},Ie={style:{"min-width":"100px","text-align":"center"}},Oe={style:{"min-width":"100px","text-align":"center"}},Te={key:1},Ue={class:"text-center"},Ee={class:"text-center"},Pe={class:"text-center"},qe={class:"text-center"},Be={class:"text-center"},Ne={class:"dropdown"},De=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Re={class:"dropdown-menu"},Ge=["onClick"],Je=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Ze=["onClick"],He=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Ke={key:0,class:"alert alert-success",role:"alert"},Qe=e("h4",{class:"alert-heading"},"Цвета",-1),We=e("p",null,"К сожалению, раздел петель пуст. Вы еще не добавили ни одного цвета, которые можно отобразить на этой странице.",-1),Xe=e("hr",null,null,-1),Ye=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте первый цвет",-1),xe=[Qe,We,Xe,Ye],es={key:1,class:"row mb-3"},ss={class:"col-12"},ts={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...$(["getColors","getColorsPaginateObject"])},mounted(){this.loadColors()},methods:{sortAndLoad(n){this.sort.column=n,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadColors(this.current_page)},loadColors(n=0){this.current_page=n,this.$store.dispatch("loadColors",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(s=>{this.items=this.getColors,this.paginate_object=this.getColorsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(n){this.$emit("select",n)},duplicateItem(n){this.$store.dispatch("duplicateColor",{colorId:n}).then(()=>{this.sortAndLoad("id")})},removeItem(n){this.$store.dispatch("removeColor",{colorId:n}).then(()=>{this.sortAndLoad("id")})}}},os=Object.assign(ts,{__name:"ColorTable",setup(n){return(s,o)=>(l(),i(_,null,[e("form",z,[e("div",M,[e("div",S,[e("div",V,[c(e("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=t=>s.search=t),class:"form-control",id:"search-colors"},null,512),[[h,s.search]]),A]),e("button",{type:"button",onClick:o[1]||(o[1]=t=>s.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},O)])])]),e("div",T,[s.items.length>0?(l(),i("table",U,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=t=>s.sortAndLoad("id"))},[a("# "),s.sort.direction==="desc"&&s.sort.column==="id"?(l(),i("span",E,q)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="id"?(l(),i("span",B,D)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[3]||(o[3]=t=>s.sortAndLoad("title"))},[a("Название "),s.sort.direction==="desc"&&s.sort.column==="title"?(l(),i("span",R,J)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="title"?(l(),i("span",Z,K)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[4]||(o[4]=t=>s.sortAndLoad("price"))},[a("Цена "),s.sort.direction==="desc"&&s.sort.column==="price"?(l(),i("span",Q,X)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="price"?(l(),i("span",Y,ee)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[5]||(o[5]=t=>s.sortAndLoad("code"))},[a("Код цвета "),s.sort.direction==="desc"&&s.sort.column==="code"?(l(),i("span",se,oe)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="code"?(l(),i("span",le,ne)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[6]||(o[6]=t=>s.sortAndLoad("assign_with_size"))},[a("Привязан к размеру "),s.sort.direction==="desc"&&s.sort.column==="assign_with_size"?(l(),i("span",de,ae)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="assign_with_size"?(l(),i("span",ce,he)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[7]||(o[7]=t=>s.sortAndLoad("type"))},[a("Тип "),s.sort.direction==="desc"&&s.sort.column==="type"?(l(),i("span",_e,me)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="type"?(l(),i("span",fe,ge)):d("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[8]||(o[8]=t=>s.sortAndLoad("updated_at"))},[a(" Дата изменения "),s.sort.direction==="desc"&&s.sort.column==="updated_at"?(l(),i("span",ye,ke)):d("",!0),s.sort.direction==="asc"&&s.sort.column==="updated_at"?(l(),i("span",ve,Ce)):d("",!0)]),je])]),e("tbody",null,[(l(!0),i(_,null,p(s.items,(t,u)=>(l(),i("tr",null,[e("th",Fe,r(t.id||u),1),e("td",{class:"text-center",onClick:m=>s.selectItem(t)},r(t.title||"-"),9,Le),e("td",ze,[t.assign_with_size?(l(),i("p",Te," Цены к цвету указаны в таблице размеров ")):(l(),i("table",Me,[Se,e("tbody",null,[e("tr",null,[e("td",Ve,r(s.items[u].price.wholesale||0),1),e("td",Ae,r(s.items[u].price.dealer||0),1),e("td",Ie,r(s.items[u].price.retail||0),1),e("td",Oe,r(s.items[u].price.cost||0),1)])])]))]),e("td",Ue,r(t.code||"Не задан"),1),e("td",Ee,r(t.assign_with_size?"Да":"Нет"),1),e("td",Pe,r(t.type||"Не задан"),1),e("td",qe,r(t.updated_at||"-"),1),e("td",Be,[e("div",Ne,[De,e("ul",Re,[e("li",null,[e("a",{class:"dropdown-item",onClick:m=>s.selectItem(t),href:"javascript:void(0)"},[Je,a("Редактировать")],8,Ge)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:m=>s.removeItem(t.id),href:"javascript:void(0)"},[He,a("Удалить")],8,Ze)])])])])]))),256))])])):d("",!0)]),s.items.length===0?(l(),i("div",Ke,xe)):d("",!0),s.items.length>0?(l(),i("div",es,[e("div",ss,[s.paginate_object?(l(),f(F,{key:0,onPagination_page:s.loadColors,pagination:s.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0)],64))}}),ls={class:"form-floating mb-3"},is=e("label",{for:"color-title"},"Наименование цвета",-1),ns={class:"form-check form-switch mb-3"},ds=e("label",{class:"form-check-label",for:"color-assign_with_size"}," Цена связана с таблицей размеров (по названию цвета) ",-1),rs={key:0,class:"card rounded-0 mb-3 border-black"},as=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),cs={class:"card-body"},us={class:"row"},hs={class:"col-6"},_s={class:"form-floating mb-3"},ps=e("label",{for:"price-wholesale"},"Опт",-1),ms={class:"col-6"},fs={class:"form-floating mb-3"},bs=e("label",{for:"price-retail"},"Розница",-1),gs={class:"col-6"},ys={class:"form-floating"},$s=e("label",{for:"price-dealer"},"Дилер",-1),ks={class:"col-6"},vs={class:"form-floating"},ws=e("label",{for:"price-cost"},"Себестоимость",-1),Cs={class:"input-group mb-3"},js={class:"form-floating"},Fs=e("label",{for:"color-title"},"Код цвета",-1),Ls=e("i",{class:"fa-solid fa-palette"},null,-1),zs=[Ls],Ms={class:"row"},Ss={class:"col-md-6 col-12"},Vs={class:"form-floating mb-3"},As=e("option",{value:null},"Выберите один из вариантов",-1),Is=["value"],Os=e("label",{for:"floatingSelect"},"Вариант применения",-1),Ts={class:"col-md-6 col-12"},Us={class:"dropdown"},Es={class:"btn d-flex justify-content-start align-items-center btn-outline-secondary rounded-0 w-100 p-3",type:"button","data-bs-auto-close":"outside","data-bs-toggle":"dropdown","aria-expanded":"false"},Ps={key:0,class:"fw-bold ml-1"},qs={class:"dropdown-menu rounded-0 w-100"},Bs=["onClick"],Ns={key:0,class:"fa-solid fa-check"},Ds={class:"row"},Rs={class:"col-12"},Gs={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Js=e("strong",null,"Внимание!",-1),Zs=["onClick"],Hs={class:"row mt-5"},Ks={class:"col-12 d-flex justify-content-center"},Qs=["disabled"],Ws={key:0,class:"fa-regular fa-floppy-disk mr-1"},Xs={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},Ys=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1),xs={class:"modal fade",id:"choose-color",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},et={class:"modal-dialog"},st={class:"modal-content"},tt=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор цвета RAL"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),ot={class:"modal-body"},lt={props:["item"],data(){return{messages:[],loading:!1,colorModal:null,types:[{title:"Для всех",key:"all",usage:["type"]},{title:"Отделка сторон",key:"side_finish",usage:["type"]},{title:"Короб и каркас",key:"box_and_frame",usage:["type","excludes"]},{title:"Фурнитура",key:"fittings",usage:["type","excludes"]},{title:"Уплотнитель",key:"seal",usage:["type","excludes"]}],form:{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0},code:null,type:null,excludes:[],assign_with_size:!1}}},computed:{filteredTypes(){return this.types.filter(n=>n.usage.indexOf("type")!==-1)},filteredExcludes(){return this.types.filter(n=>n.usage.indexOf("excludes")!==-1)},needClearForm(){return this.form.id||this.form.title||this.form.price||this.form.code||this.form.type}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0},excludes:this.item.excludes||[],code:this.item.code||null,type:this.item.type||null,assign_with_size:this.item.assign_with_size||!1}})},methods:{addToExcludes(n){this.form.excludes||(this.form.excludes=[]);let s=this.form.excludes.findIndex(o=>o===n.key);s===-1?this.form.excludes.push(n.key):this.form.excludes.splice(s,1)},callbackSelectColor(n){this.form.title=n.names.en||n.color.code,this.form.code=n.color.code||n.color.hex||null,this.colorModal.hide()},selectColor(){this.colorModal=new bootstrap.Modal(document.getElementById("choose-color"),{}),this.colorModal.show()},alert(n){this.messages.push(n)},resetForm(){this.form.id=null,this.form.title=null,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.form.code=null,this.form.type=null,this.form.excludes=[],this.$emit("callback")},removeMessage(n){this.messages.splice(n,1)},submit(){let n=new FormData;Object.keys(this.form).forEach(s=>{const o=this.form[s]||"";typeof o=="object"?n.append(s,JSON.stringify(o)):n.append(s,o)}),this.$store.dispatch("storeColor",{colorForm:n}).then(s=>{this.$emit("callback"),this.resetForm()}).catch(s=>{})}}},it=Object.assign(lt,{__name:"ColorForm",setup(n){return(s,o)=>(l(),i(_,null,[e("form",{action:"",onSubmit:o[11]||(o[11]=w((...t)=>s.submit&&s.submit(...t),["prevent"]))},[e("div",ls,[c(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=t=>s.form.title=t),class:"form-control",id:"color-title",required:""},null,512),[[h,s.form.title]]),is]),e("div",ns,[c(e("input",{class:"form-check-input","onUpdate:modelValue":o[1]||(o[1]=t=>s.form.assign_with_size=t),type:"checkbox",role:"switch",id:"color-assign_with_size",checked:""},null,512),[[k,s.form.assign_with_size]]),ds]),s.form.assign_with_size?d("",!0):(l(),i("div",rs,[as,e("div",cs,[e("div",us,[e("div",hs,[e("div",_s,[c(e("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=t=>s.form.price.wholesale=t),class:"form-control",id:"price-wholesale",required:""},null,512),[[h,s.form.price.wholesale]]),ps])]),e("div",ms,[e("div",fs,[c(e("input",{type:"number","onUpdate:modelValue":o[3]||(o[3]=t=>s.form.price.retail=t),class:"form-control",id:"price-retail",required:""},null,512),[[h,s.form.price.retail]]),bs])]),e("div",gs,[e("div",ys,[c(e("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=t=>s.form.price.dealer=t),class:"form-control",id:"price-dealer",required:""},null,512),[[h,s.form.price.dealer]]),$s])]),e("div",ks,[e("div",vs,[c(e("input",{type:"number","onUpdate:modelValue":o[5]||(o[5]=t=>s.form.price.cost=t),class:"form-control",id:"price-cost",required:""},null,512),[[h,s.form.price.cost]]),ws])])])])])),e("div",Cs,[e("div",js,[c(e("input",{type:"text","onUpdate:modelValue":o[6]||(o[6]=t=>s.form.code=t),class:"form-control",id:"color-code"},null,512),[[h,s.form.code]]),Fs]),e("button",{type:"button",onClick:o[7]||(o[7]=(...t)=>s.selectColor&&s.selectColor(...t)),class:"btn btn-outline-secondary rounded-0",id:"basic-addon1"},zs)]),e("div",Ms,[e("div",Ss,[e("div",Vs,[c(e("select",{class:"form-select",onInvalid:o[8]||(o[8]=t=>s.alert("Вы не выбрали вариант использования!")),"onUpdate:modelValue":o[9]||(o[9]=t=>s.form.type=t),id:"floatingSelect","aria-label":"Floating label select example",required:""},[As,(l(!0),i(_,null,p(s.filteredTypes,t=>(l(),i("option",{value:t.key},r(t.title),9,Is))),256))],544),[[v,s.form.type]]),Os])]),e("div",Ts,[e("div",Us,[e("button",Es,[a(" Исключения из расчёта "),(s.form.excludes||[]).length>0?(l(),i("span",Ps,"("+r(s.form.excludes.length)+")",1)):d("",!0)]),e("ul",qs,[(l(!0),i(_,null,p(s.filteredExcludes,t=>(l(),i("li",null,[e("a",{class:"dropdown-item",onClick:u=>s.addToExcludes(t),href:"javascript:void(0)"},[s.form.excludes.indexOf(t.key)!=-1?(l(),i("i",Ns)):d("",!0),a(" "+r(t.title),1)],8,Bs)]))),256))])])])]),e("div",Ds,[e("div",Rs,[s.messages.length>0?(l(!0),i(_,{key:0},p(s.messages,(t,u)=>(l(),i("div",Gs,[Js,a(" "+r(t||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:m=>s.removeMessage(u)},null,8,Zs)]))),256)):d("",!0)])]),e("div",Hs,[e("div",Ks,[e("button",{disabled:!s.needClearForm,class:"btn btn-dark rounded-0"},[s.loading?(l(),i("span",Xs)):(l(),i("i",Ws)),a(" Сохранить цвет ")],8,Qs),s.needClearForm&&!s.loading?(l(),i("button",{key:0,type:"button",onClick:o[10]||(o[10]=(...t)=>s.resetForm&&s.resetForm(...t)),class:"btn btn-outline-secondary rounded-0 ml-2"},[Ys,a(" Очистить форму ")])):d("",!0)])])],32),e("div",xs,[e("div",et,[e("div",st,[tt,e("div",ot,[b(L,{onSelect:s.callbackSelectColor},null,8,["onSelect"])])])])])],64))}}),nt=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Цвета",-1),dt={class:"py-12"},rt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},at={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},ct={class:"p-6 text-gray-900"},ut=e("hr",{class:"hr my-5"},null,-1),ht={data(){return{loading:!1,selectedColor:null}},methods:{selectColor(n){this.selectedColor=n,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackColorForm(){this.loading=!0,this.selectedColor=null,this.$nextTick(()=>{this.loading=!1})}}},$t=Object.assign(ht,{__name:"ColorsPage",setup(n){return(s,o)=>(l(),i(_,null,[b(C(j),{title:"Цвета"}),b(y,null,{header:g(()=>[nt]),default:g(()=>[e("div",dt,[e("div",rt,[e("div",at,[e("div",ct,[s.loading?d("",!0):(l(),f(it,{key:0,item:s.selectedColor,onCallback:s.callbackColorForm},null,8,["item","onCallback"])),ut,s.loading?d("",!0):(l(),f(os,{key:1,onSelect:s.selectColor},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{$t as default};
