import{_ as y}from"./AuthenticatedLayout-U_NmAYPg.js";import{m as $,o as l,c as n,b as t,d as u,v as h,e as a,f as r,F as c,r as _,g as f,t as d,h as k,i as v,a as b,u as C,w as g,Z as w}from"./app-LHGxCz7D.js";import{P as j}from"./Pagination-DPVP2hwE.js";import{R as F}from"./RalColorSelector-XWHyJNTw.js";import"./ApplicationLogo-DNSrsL8n.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"row"},S={class:"col-12"},M={class:"input-group mb-3"},A={class:"form-floating"},I=t("label",{for:"search-colors"},"Поиск по цвету",-1),V=t("i",{class:"fa-solid fa-magnifying-glass"},null,-1),O=[V],P={style:{"overflow-y":"auto"}},T={key:0,class:"table"},B={key:0},N=t("i",{class:"fa-solid fa-caret-down"},null,-1),U=[N],q={key:1},D=t("i",{class:"fa-solid fa-caret-up"},null,-1),E=[D],R={key:0},G=t("i",{class:"fa-solid fa-caret-down"},null,-1),J=[G],Z={key:1},z=t("i",{class:"fa-solid fa-caret-up"},null,-1),H=[z],K={key:0},Q=t("i",{class:"fa-solid fa-caret-down"},null,-1),W=[Q],X={key:1},Y=t("i",{class:"fa-solid fa-caret-up"},null,-1),x=[Y],tt={key:0},ot=t("i",{class:"fa-solid fa-caret-down"},null,-1),st=[ot],et={key:1},lt=t("i",{class:"fa-solid fa-caret-up"},null,-1),it=[lt],nt={key:0},rt=t("i",{class:"fa-solid fa-caret-down"},null,-1),at=[rt],dt={key:1},ct=t("i",{class:"fa-solid fa-caret-up"},null,-1),ut=[ct],ht={key:0},mt=t("i",{class:"fa-solid fa-caret-down"},null,-1),pt=[mt],_t={key:1},ft=t("i",{class:"fa-solid fa-caret-up"},null,-1),bt=[ft],gt=t("th",{scope:"col",class:"text-center"},"Действие",-1),yt={scope:"row"},$t=["onClick"],kt={class:"text-center"},vt={class:"text-center"},Ct={class:"text-center"},wt={class:"text-center"},jt={class:"text-center"},Ft={class:"dropdown"},Lt=t("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa-solid fa-bars"})],-1),St={class:"dropdown-menu"},Mt=["onClick"],At=t("i",{class:"fa-solid fa-pen mr-2"},null,-1),It=["onClick"],Vt=t("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Ot={key:0,class:"alert alert-success",role:"alert"},Pt=t("h4",{class:"alert-heading"},"Цвета",-1),Tt=t("p",null,"К сожалению, раздел петель пуст. Вы еще не добавили ни одного цвета, которые можно отобразить на этой странице.",-1),Bt=t("hr",null,null,-1),Nt=t("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте первый цвет",-1),Ut=[Pt,Tt,Bt,Nt],qt={key:1,class:"row mb-3"},Dt={class:"col-12"},Et={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...$(["getColors","getColorsPaginateObject"])},mounted(){this.loadColors()},methods:{sortAndLoad(i){this.sort.column=i,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadColors(this.current_page)},loadColors(i=0){this.current_page=i,this.$store.dispatch("loadColors",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(o=>{this.items=this.getColors,this.paginate_object=this.getColorsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(i){this.$emit("select",i)},duplicateItem(i){this.$store.dispatch("duplicateColor",{colorId:i}).then(()=>{this.sortAndLoad("id")})},removeItem(i){this.$store.dispatch("removeColor",{colorId:i}).then(()=>{this.sortAndLoad("id")})}}},Rt=Object.assign(Et,{__name:"ColorTable",setup(i){return(o,s)=>(l(),n(c,null,[t("form",L,[t("div",S,[t("div",M,[t("div",A,[u(t("input",{type:"search","onUpdate:modelValue":s[0]||(s[0]=e=>o.search=e),class:"form-control",id:"search-colors"},null,512),[[h,o.search]]),I]),t("button",{type:"button",onClick:s[1]||(s[1]=e=>o.sortAndLoad("id")),class:"btn btn-outline-primary"},O)])])]),t("div",P,[o.items.length>0?(l(),n("table",T,[t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"cursor-pointer",onClick:s[2]||(s[2]=e=>o.sortAndLoad("id"))},[a("# "),o.sort.direction==="desc"&&o.sort.column==="id"?(l(),n("span",B,U)):r("",!0),o.sort.direction==="asc"&&o.sort.column==="id"?(l(),n("span",q,E)):r("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:s[3]||(s[3]=e=>o.sortAndLoad("title"))},[a("Название "),o.sort.direction==="desc"&&o.sort.column==="title"?(l(),n("span",R,J)):r("",!0),o.sort.direction==="asc"&&o.sort.column==="title"?(l(),n("span",Z,H)):r("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:s[4]||(s[4]=e=>o.sortAndLoad("price"))},[a("Цена "),o.sort.direction==="desc"&&o.sort.column==="price"?(l(),n("span",K,W)):r("",!0),o.sort.direction==="asc"&&o.sort.column==="price"?(l(),n("span",X,x)):r("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:s[5]||(s[5]=e=>o.sortAndLoad("code"))},[a("Код цвета "),o.sort.direction==="desc"&&o.sort.column==="code"?(l(),n("span",tt,st)):r("",!0),o.sort.direction==="asc"&&o.sort.column==="code"?(l(),n("span",et,it)):r("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:s[6]||(s[6]=e=>o.sortAndLoad("type"))},[a("Тип "),o.sort.direction==="desc"&&o.sort.column==="type"?(l(),n("span",nt,at)):r("",!0),o.sort.direction==="asc"&&o.sort.column==="type"?(l(),n("span",dt,ut)):r("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:s[7]||(s[7]=e=>o.sortAndLoad("updated_at"))},[a(" Дата изменения "),o.sort.direction==="desc"&&o.sort.column==="updated_at"?(l(),n("span",ht,pt)):r("",!0),o.sort.direction==="asc"&&o.sort.column==="updated_at"?(l(),n("span",_t,bt)):r("",!0)]),gt])]),t("tbody",null,[(l(!0),n(c,null,_(o.items,(e,m)=>(l(),n("tr",null,[t("th",yt,d(e.id||m),1),t("td",{class:"text-center",onClick:p=>o.selectItem(e)},d(e.title||"-"),9,$t),t("td",kt,d(e.price||0),1),t("td",vt,d(e.code||"Не задан"),1),t("td",Ct,d(e.type||"Не задан"),1),t("td",wt,d(e.updated_at||"-"),1),t("td",jt,[t("div",Ft,[Lt,t("ul",St,[t("li",null,[t("a",{class:"dropdown-item",onClick:p=>o.selectItem(e),href:"javascript:void(0)"},[At,a("Редактировать")],8,Mt)]),t("li",null,[t("a",{class:"dropdown-item text-danger",onClick:p=>o.removeItem(e.id),href:"javascript:void(0)"},[Vt,a("Удалить")],8,It)])])])])]))),256))])])):r("",!0)]),o.items.length===0?(l(),n("div",Ot,Ut)):r("",!0),o.items.length>0?(l(),n("div",qt,[t("div",Dt,[o.paginate_object?(l(),f(j,{key:0,onPagination_page:o.loadColors,pagination:o.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):r("",!0)],64))}}),Gt={class:"form-floating mb-3"},Jt=t("label",{for:"color-title"},"Наименование цвета",-1),Zt={class:"form-floating mb-3"},zt=t("label",{for:"color-title"},"Цена",-1),Ht={class:"input-group mb-3"},Kt={class:"form-floating"},Qt=t("label",{for:"color-title"},"Код цвета",-1),Wt=t("i",{class:"fa-solid fa-palette"},null,-1),Xt=[Wt],Yt={class:"form-floating mb-3"},xt=t("option",{value:null},"Выберите один из вариантов",-1),to=["value"],oo=t("label",{for:"floatingSelect"},"Вариант применения",-1),so={class:"row"},eo={class:"col-12"},lo={class:"alert alert-danger alert-dismissible fade show",role:"alert"},io=t("strong",null,"Внимание!",-1),no=["onClick"],ro={class:"row mt-5"},ao={class:"col-12 d-flex justify-content-center"},co=["disabled"],uo={key:0,class:"fa-regular fa-floppy-disk mr-1"},ho={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},mo=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1),po={class:"modal fade",id:"choose-color",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},_o={class:"modal-dialog"},fo={class:"modal-content"},bo=t("div",{class:"modal-header"},[t("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор цвета RAL"),t("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),go={class:"modal-body"},yo={props:["item"],data(){return{messages:[],loading:!1,colorModal:null,types:[{title:"Для всех",key:"all"},{title:"Отделка сторон",key:"side_finish"},{title:"Короб и каркас",key:"box_and_frame"},{title:"Фурнитура",key:"fittings"},{title:"Уплотнитель",key:"seal"}],form:{id:null,title:null,price:null,code:null,type:null}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price||this.form.code||this.form.type}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||0,code:this.item.code||null,type:this.item.type||null}})},methods:{callbackSelectColor(i){this.form.title=i.names.en||i.color.code,this.form.code=i.color.code||i.color.hex||null,this.colorModal.hide()},selectColor(){this.colorModal=new bootstrap.Modal(document.getElementById("choose-color"),{}),this.colorModal.show()},alert(i){this.messages.push(i)},resetForm(){this.form.id=null,this.form.title=null,this.form.price=0,this.form.code=null,this.form.type=null,this.$emit("callback")},removeMessage(i){this.messages.splice(i,1)},submit(){let i=new FormData;Object.keys(this.form).forEach(o=>{const s=this.form[o]||"";typeof s=="object"?i.append(o,JSON.stringify(s)):i.append(o,s)}),this.$store.dispatch("storeColor",{colorForm:i}).then(o=>{this.$emit("callback"),this.resetForm()}).catch(o=>{})}}},$o=Object.assign(yo,{__name:"ColorForm",setup(i){return(o,s)=>(l(),n(c,null,[t("form",{action:"",onSubmit:s[7]||(s[7]=v((...e)=>o.submit&&o.submit(...e),["prevent"]))},[t("div",Gt,[u(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=e=>o.form.title=e),class:"form-control",id:"color-title",required:""},null,512),[[h,o.form.title]]),Jt]),t("div",Zt,[u(t("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=e=>o.form.price=e),class:"form-control",id:"color-price",required:""},null,512),[[h,o.form.price]]),zt]),t("div",Ht,[t("div",Kt,[u(t("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=e=>o.form.code=e),class:"form-control",id:"color-code"},null,512),[[h,o.form.code]]),Qt]),t("button",{type:"button",onClick:s[3]||(s[3]=(...e)=>o.selectColor&&o.selectColor(...e)),class:"btn btn-outline-secondary rounded-0",id:"basic-addon1"},Xt)]),t("div",Yt,[u(t("select",{class:"form-select",onInvalid:s[4]||(s[4]=e=>o.alert("Вы не выбрали вариант использования!")),"onUpdate:modelValue":s[5]||(s[5]=e=>o.form.type=e),id:"floatingSelect","aria-label":"Floating label select example",required:""},[xt,(l(!0),n(c,null,_(o.types,e=>(l(),n("option",{value:e.key},d(e.title),9,to))),256))],544),[[k,o.form.type]]),oo]),t("div",so,[t("div",eo,[o.messages.length>0?(l(!0),n(c,{key:0},_(o.messages,(e,m)=>(l(),n("div",lo,[io,a(" "+d(e||"Ошибка")+" ",1),t("button",{type:"button",class:"btn-close",onClick:p=>o.removeMessage(m)},null,8,no)]))),256)):r("",!0)])]),t("div",ro,[t("div",ao,[t("button",{disabled:!o.needClearForm,class:"btn btn-outline-success rounded-5"},[o.loading?(l(),n("span",ho)):(l(),n("i",uo)),a(" Сохранить цвет ")],8,co),o.needClearForm&&!o.loading?(l(),n("button",{key:0,type:"button",onClick:s[6]||(s[6]=(...e)=>o.resetForm&&o.resetForm(...e)),class:"btn btn-outline-danger rounded-5 ml-2"},[mo,a(" Очистить форму ")])):r("",!0)])])],32),t("div",po,[t("div",_o,[t("div",fo,[bo,t("div",go,[b(F,{onSelect:o.callbackSelectColor},null,8,["onSelect"])])])])])],64))}}),ko=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Цвета",-1),vo={class:"py-12"},Co={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},wo={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},jo={class:"p-6 text-gray-900"},Fo=t("hr",{class:"hr my-5"},null,-1),Lo={data(){return{loading:!1,selectedColor:null}},methods:{selectColor(i){this.selectedColor=i,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackColorForm(){this.loading=!0,this.selectedColor=null,this.$nextTick(()=>{this.loading=!1})}}},Po=Object.assign(Lo,{__name:"ColorsPage",setup(i){return(o,s)=>(l(),n(c,null,[b(C(w),{title:"Цвета"}),b(y,null,{header:g(()=>[ko]),default:g(()=>[t("div",vo,[t("div",Co,[t("div",wo,[t("div",jo,[o.loading?r("",!0):(l(),f($o,{key:0,item:o.selectedColor,onCallback:o.callbackColorForm},null,8,["item","onCallback"])),Fo,o.loading?r("",!0):(l(),f(Rt,{key:1,onSelect:o.selectColor},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{Po as default};
