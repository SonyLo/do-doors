import{_}from"./AuthenticatedLayout-D_wEl0Tb.js";import{_ as g}from"./RoleTable-B236InO9.js";import{o as i,c as r,b as s,f as d,v as m,F as f,r as b,e as n,g as a,j as k,t as y,a as u,u as v,w as c,Z as $,d as h}from"./app-C8zytP-Q.js";import"./RalColorSelector-DXc2tzk9.js";import{E as F}from"./main-CpemCeA6.js";import"./ApplicationLogo-34l6Pbbb.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./Pagination-CxpG940Z.js";const w={class:"form-floating mb-3"},R=s("label",{for:"role-code"},"Название роли",-1),C={class:"form-floating mb-3"},D=s("label",{for:"role-code"},"Программный идентификатор роли",-1),V={class:"row"},x={class:"col-12"},T={class:"alert alert-danger alert-dismissible fade show",role:"alert"},j=s("strong",null,"Внимание!",-1),B=["onClick"],M={class:"row mt-5"},N={class:"col-12 d-flex justify-content-center"},S=["disabled"],E={key:0,class:"fa-regular fa-floppy-disk mr-1"},q={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},O=s("i",{class:"fa-solid fa-xmark mr-1"},null,-1),P={props:["item"],components:{VueDatePicker:F},data(){return{messages:[],loading:!1,form:{id:null,name:null,slug:null}}},computed:{needClearForm(){return this.form.id||this.form.name||this.form.slug}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,slug:this.item.slug||null,name:this.item.name||null}})},methods:{alert(t){this.messages.push(t)},resetForm(){this.form.id=null,this.form.name=null,this.form.slug=0,this.$emit("callback")},removeMessage(t){this.messages.splice(t,1)},submit(){this.$store.dispatch("storeRole",{roleForm:this.form}).then(t=>{this.$notify({title:"DoDoors",text:"Роль успешно добавлена",type:"success"}),this.$emit("callback"),this.resetForm()}).catch(t=>{this.$notify({title:"DoDoors",text:"Ошибка добавления роли",type:"error"})})}}},U=Object.assign(P,{__name:"RoleForm",setup(t){return(e,o)=>(i(),r("form",{action:"",onSubmit:o[3]||(o[3]=k((...l)=>e.submit&&e.submit(...l),["prevent"]))},[s("div",w,[d(s("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>e.form.name=l),class:"form-control",id:"role-name",required:""},null,512),[[m,e.form.name]]),R]),s("div",C,[d(s("input",{type:"text","onUpdate:modelValue":o[1]||(o[1]=l=>e.form.slug=l),class:"form-control",id:"role-slug",required:""},null,512),[[m,e.form.slug]]),D]),s("div",V,[s("div",x,[e.messages.length>0?(i(!0),r(f,{key:0},b(e.messages,(l,p)=>(i(),r("div",T,[j,a(" "+y(l||"Ошибка")+" ",1),s("button",{type:"button",class:"btn-close",onClick:J=>e.removeMessage(p)},null,8,B)]))),256)):n("",!0)])]),s("div",M,[s("div",N,[s("button",{disabled:!e.needClearForm,class:"btn btn-dark rounded-0"},[e.loading?(i(),r("span",q)):(i(),r("i",E)),a(" Сохранить роль ")],8,S),e.needClearForm&&!e.loading?(i(),r("button",{key:0,type:"button",onClick:o[2]||(o[2]=(...l)=>e.resetForm&&e.resetForm(...l)),class:"btn btn-outline-secondary rounded-0 ml-2"},[O,a(" Очистить форму ")])):n("",!0)])])],32))}}),L=s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Роли",-1),Z={class:"py-12"},z={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},A={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},G={class:"p-6 text-gray-900"},H=s("hr",{class:"hr my-5"},null,-1),I={data(){return{loading:!1,selectedRole:null}},methods:{selectRole(t){this.selectedRole=t,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackRoleForm(){this.loading=!0,this.selectedRole=null,this.$nextTick(()=>{this.loading=!1})}}},oe=Object.assign(I,{__name:"RolesPage",setup(t){return(e,o)=>(i(),r(f,null,[u(v($),{title:"Роли"}),u(_,null,{header:c(()=>[L]),default:c(()=>[s("div",Z,[s("div",z,[s("div",A,[s("div",G,[e.loading?n("",!0):(i(),h(U,{key:0,item:e.selectedRole,onCallback:e.callbackRoleForm},null,8,["item","onCallback"])),H,e.loading?n("",!0):(i(),h(g,{key:1,onSelect:e.selectRole},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{oe as default};
