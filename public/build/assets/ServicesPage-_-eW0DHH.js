import{_ as k}from"./AuthenticatedLayout-W_CymmRh.js";import{m as w,o as t,c as o,b as e,f as u,v as p,g as a,e as c,F as m,r as f,d as v,t as _,h as $,i as S,j as C,a as b,u as V,w as g,Z as j}from"./app-K7pY369U.js";import{P as F}from"./Pagination-BtEmCyXU.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-D1tkHKrI.js";import"./vue-the-mask-CB4ysAgb.js";const A={class:"row"},U={class:"col-12"},I={class:"input-group mb-3"},O={class:"form-floating"},P=e("label",{for:"search-services"},"Поиск по доступным сервисам",-1),M=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),T=[M],q={style:{"overflow-y":"auto"}},D={key:0,class:"table"},N={key:0},B=e("i",{class:"fa-solid fa-caret-down"},null,-1),E=[B],G={key:1},J=e("i",{class:"fa-solid fa-caret-up"},null,-1),Z=[J],z={key:0},H=e("i",{class:"fa-solid fa-caret-down"},null,-1),K=[H],Q={key:1},R=e("i",{class:"fa-solid fa-caret-up"},null,-1),W=[R],X={key:0},Y=e("i",{class:"fa-solid fa-caret-down"},null,-1),x=[Y],ee={key:1},se=e("i",{class:"fa-solid fa-caret-up"},null,-1),te=[se],oe={key:0},ie=e("i",{class:"fa-solid fa-caret-down"},null,-1),le=[ie],re={key:1},ne=e("i",{class:"fa-solid fa-caret-up"},null,-1),ce=[ne],de={key:0},ae=e("i",{class:"fa-solid fa-caret-down"},null,-1),_e=[ae],he={key:1},ue=e("i",{class:"fa-solid fa-caret-up"},null,-1),pe=[ue],me={key:0},fe=e("i",{class:"fa-solid fa-caret-down"},null,-1),ve=[fe],be={key:1},ge=e("i",{class:"fa-solid fa-caret-up"},null,-1),ye=[ge],ke={key:0},we=e("i",{class:"fa-solid fa-caret-down"},null,-1),$e=[we],Se={key:1},Ce=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ve=[Ce],je=e("th",{scope:"col",class:"text-center"},"Действие",-1),Fe={scope:"row"},Le=["onClick"],Ae={class:"text-center"},Ue={class:"text-center"},Ie={class:"text-center"},Oe={class:"text-center",style:{width:"50px"}},Pe={class:"text-center"},Me={class:"w-100"},Te=e("thead",null,[e("th",null,"опт, ₽"),e("th",null,"дилер, ₽"),e("th",null,"розница, ₽"),e("th",null,"себестоимость, ₽")],-1),qe={style:{"min-width":"100px","text-align":"center"}},De={style:{"min-width":"100px","text-align":"center"}},Ne={style:{"min-width":"100px","text-align":"center"}},Be={style:{"min-width":"100px","text-align":"center"}},Ee={class:"text-center"},Ge={class:"dropdown"},Je=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Ze={class:"dropdown-menu"},ze=["onClick"],He=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Ke=["onClick"],Qe=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Re={key:0,class:"alert alert-success",role:"alert"},We=e("h4",{class:"alert-heading"},"Варианты дверей",-1),Xe=e("p",null,"К сожалению, раздел Варианты дверей пуст. Вы еще не добавили ни одного варианта дверей, которые можно отобразить на этой странице.",-1),Ye=e("hr",null,null,-1),xe=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте свой первый вариант дверей",-1),es=[We,Xe,Ye,xe],ss={key:1,class:"row mb-3"},ts={class:"col-12"},os={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0},type:null,description:null,is_active:!0,order_position:0}]}},computed:{...w(["getServices","getServicesPaginateObject"])},mounted(){this.loadServices()},methods:{sortAndLoad(n){this.sort.column=n,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadServices(this.current_page)},loadServices(n=0){this.current_page=n,this.$store.dispatch("loadServices",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(s=>{this.items=this.getServices,this.paginate_object=this.getServicesPaginateObject}).catch(()=>{this.loading=!1})},selectItem(n){this.$emit("select",n)},duplicateItem(n){this.$store.dispatch("duplicateDoorVariant",{doorVariantId:n}).then(()=>{this.sortAndLoad("id")})},removeItem(n){this.$store.dispatch("removeDoorVariant",{doorVariantId:n}).then(()=>{this.sortAndLoad("id")})}}},is=Object.assign(os,{__name:"ServiceTable",setup(n){return(s,r)=>(t(),o(m,null,[e("form",A,[e("div",U,[e("div",I,[e("div",O,[u(e("input",{type:"search","onUpdate:modelValue":r[0]||(r[0]=d=>s.search=d),class:"form-control",id:"search-services"},null,512),[[p,s.search]]),P]),e("button",{type:"button",onClick:r[1]||(r[1]=d=>s.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},T)])])]),e("div",q,[s.items.length>0?(t(),o("table",D,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:r[2]||(r[2]=d=>s.sortAndLoad("id"))},[a("# "),s.sort.direction==="desc"&&s.sort.column==="id"?(t(),o("span",N,E)):c("",!0),s.sort.direction==="asc"&&s.sort.column==="id"?(t(),o("span",G,Z)):c("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[3]||(r[3]=d=>s.sortAndLoad("title"))},[a("Название "),s.sort.direction==="desc"&&s.sort.column==="title"?(t(),o("span",z,K)):c("",!0),s.sort.direction==="asc"&&s.sort.column==="title"?(t(),o("span",Q,W)):c("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[4]||(r[4]=d=>s.sortAndLoad("description"))},[a("Пояснение "),s.sort.direction==="desc"&&s.sort.column==="description"?(t(),o("span",X,x)):c("",!0),s.sort.direction==="asc"&&s.sort.column==="description"?(t(),o("span",ee,te)):c("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[5]||(r[5]=d=>s.sortAndLoad("type"))},[a("Тип сервиса "),s.sort.direction==="desc"&&s.sort.column==="type"?(t(),o("span",oe,le)):c("",!0),s.sort.direction==="asc"&&s.sort.column==="type"?(t(),o("span",re,ce)):c("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[6]||(r[6]=d=>s.sortAndLoad("order_position"))},[a("Позиция в выдаче "),s.sort.direction==="desc"&&s.sort.column==="order_position"?(t(),o("span",de,_e)):c("",!0),s.sort.direction==="asc"&&s.sort.column==="order_position"?(t(),o("span",he,pe)):c("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[7]||(r[7]=d=>s.sortAndLoad("is_active"))},[a("Отображается в калькуляторе "),s.sort.direction==="desc"&&s.sort.column==="is_active"?(t(),o("span",me,ve)):c("",!0),s.sort.direction==="asc"&&s.sort.column==="is_active"?(t(),o("span",be,ye)):c("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[8]||(r[8]=d=>s.sortAndLoad("price"))},[a("Цена "),s.sort.direction==="desc"&&s.sort.column==="price"?(t(),o("span",ke,$e)):c("",!0),s.sort.direction==="asc"&&s.sort.column==="price"?(t(),o("span",Se,Ve)):c("",!0)]),je])]),e("tbody",null,[(t(!0),o(m,null,f(s.items,(d,i)=>(t(),o("tr",null,[e("th",Fe,_(d.id||i),1),e("td",{class:"text-center",onClick:h=>s.selectItem(d)},_(d.title||"-"),9,Le),e("td",Ae,_(d.description||"-"),1),e("td",Ue,_(d.type||"-"),1),e("td",Ie,_(d.order_position||0),1),e("td",Oe,_(d.is_active?"да":"нет"),1),e("td",Pe,[e("table",Me,[Te,e("tbody",null,[e("tr",null,[e("td",qe,_(s.items[i].price.wholesale||0),1),e("td",De,_(s.items[i].price.dealer||0),1),e("td",Ne,_(s.items[i].price.retail||0),1),e("td",Be,_(s.items[i].price.cost||0),1)])])])]),e("td",Ee,[e("div",Ge,[Je,e("ul",Ze,[e("li",null,[e("a",{class:"dropdown-item",onClick:h=>s.selectItem(d),href:"javascript:void(0)"},[He,a("Редактировать")],8,ze)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:h=>s.removeItem(d.id),href:"javascript:void(0)"},[Qe,a("Удалить")],8,Ke)])])])])]))),256))])])):c("",!0)]),s.items.length===0?(t(),o("div",Re,es)):c("",!0),s.items.length>0?(t(),o("div",ss,[e("div",ts,[s.paginate_object?(t(),v(F,{key:0,onPagination_page:s.loadServices,pagination:s.paginate_object},null,8,["onPagination_page","pagination"])):c("",!0)])])):c("",!0)],64))}}),ls={props:["item"],data(){return{messages:[],loading:!1,types:[{title:"Работа с ручками",value:"service_handle"},{title:"Работа со стопором",value:"service_stopper"},{title:"Работа с порогом",value:"service_doorstep"},{title:"Работа с доводчиком",value:"service_door_closer"},{title:"Работа с плинтусом",value:"service_baseboard"},{title:"Установка двери",value:"service_door_install"},{title:"Упаковка двери",value:"service_door_wrapper"},{title:"Покраска элементов",value:"service_painting"}],form:{id:null,title:null,description:null,type:null,order_position:0,is_active:!0,price:{wholesale:0,dealer:0,retail:0,cost:0}}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.description||this.form.order_position||this.form.type}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,description:this.item.description||null,is_active:this.item.is_active||!0,type:this.item.type||null,order_position:this.item.order_position||0,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0}}})},methods:{alert(n){this.messages.push(n)},resetForm(){this.form.id=null,this.form.title=null,this.form.description=null,this.form.type=null,this.form.order_position=0,this.form.is_active=!1,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.$emit("callback")},removeMessage(n){this.messages.splice(n,1)},submit(){let n=new FormData;Object.keys(this.form).forEach(s=>{const r=this.form[s]||"";typeof r=="object"?n.append(s,JSON.stringify(r)):n.append(s,r)}),this.$store.dispatch("storeService",{serviceForm:n}).then(s=>{this.$emit("callback"),this.resetForm()}).catch(s=>{})}}},rs={class:"form-floating mb-3"},ns=e("label",{for:"service-title"},"Наименование варианта двери",-1),cs={class:"form-floating mb-3"},ds=e("label",{for:"service-description"},"Пояснение к параметру",-1),as={class:"form-check form-switch mb-3"},_s=e("label",{class:"form-check-label",for:"service-is_active"}," Отображается в калькуляторе ",-1),hs={class:"form-floating mb-3"},us=["value"],ps=e("label",{for:"service-type"},"Тип сервиса",-1),ms={class:"form-floating mb-3"},fs=e("label",{for:"service-order_position"},"Позиция в выдаче",-1),vs={class:"card rounded-0 mb-3 border-black"},bs=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),gs={class:"card-body"},ys={class:"row"},ks={class:"col-md-6 col-12"},ws={class:"form-floating mb-3"},$s={for:"price-wholesale"},Ss={key:0},Cs={key:1},Vs={class:"col-md-6 col-12"},js={class:"form-floating mb-3"},Fs={for:"price-retail"},Ls={key:0},As={key:1},Us={class:"col-md-6 col-12 mb-3"},Is={class:"form-floating"},Os={for:"price-dealer"},Ps={key:0},Ms={key:1},Ts={class:"col-md-6 col-12"},qs={class:"form-floating"},Ds={for:"price-cost"},Ns={key:0},Bs={key:1},Es={class:"row"},Gs={class:"col-12"},Js={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Zs=e("strong",null,"Внимание!",-1),zs=["onClick"],Hs={class:"row mt-5"},Ks={class:"col-12 d-flex justify-content-center"},Qs=["disabled"],Rs={key:0,class:"fa-regular fa-floppy-disk mr-1"},Ws={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},Xs=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1);function Ys(n,s,r,d,i,h){return t(),o("form",{action:"",onSubmit:s[10]||(s[10]=C((...l)=>h.submit&&h.submit(...l),["prevent"]))},[e("div",rs,[u(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=l=>i.form.title=l),class:"form-control",id:"service-title",required:""},null,512),[[p,i.form.title]]),ns]),e("div",cs,[u(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=l=>i.form.description=l),class:"form-control",id:"service-description"},null,512),[[p,i.form.description]]),ds]),e("div",as,[u(e("input",{class:"form-check-input","onUpdate:modelValue":s[2]||(s[2]=l=>i.form.is_active=l),type:"checkbox",role:"switch",id:"service-is_active"},null,512),[[$,i.form.is_active]]),_s]),e("div",hs,[u(e("select",{class:"form-select","onUpdate:modelValue":s[3]||(s[3]=l=>i.form.type=l),id:"service-type","aria-label":"Floating label select example"},[(t(!0),o(m,null,f(i.types,l=>(t(),o("option",{value:l.value},_(l.title||"-"),9,us))),256))],512),[[S,i.form.type]]),ps]),e("div",ms,[u(e("input",{type:"text","onUpdate:modelValue":s[4]||(s[4]=l=>i.form.order_position=l),class:"form-control",id:"service-order_position"},null,512),[[p,i.form.order_position]]),fs]),e("div",vs,[bs,e("div",gs,[e("div",ys,[e("div",ks,[e("div",ws,[u(e("input",{type:"number","onUpdate:modelValue":s[5]||(s[5]=l=>i.form.price.wholesale=l),class:"form-control",id:"price-wholesale",required:""},null,512),[[p,i.form.price.wholesale]]),e("label",$s,[a("Опт"),i.form.need_percent_price?(t(),o("span",Ss,", %")):(t(),o("span",Cs,", руб"))])])]),e("div",Vs,[e("div",js,[u(e("input",{type:"number","onUpdate:modelValue":s[6]||(s[6]=l=>i.form.price.retail=l),class:"form-control",id:"price-retail",required:""},null,512),[[p,i.form.price.retail]]),e("label",Fs,[a("Розница"),i.form.need_percent_price?(t(),o("span",Ls,", %")):(t(),o("span",As,", руб"))])])]),e("div",Us,[e("div",Is,[u(e("input",{type:"number","onUpdate:modelValue":s[7]||(s[7]=l=>i.form.price.dealer=l),class:"form-control",id:"price-dealer",required:""},null,512),[[p,i.form.price.dealer]]),e("label",Os,[a("Дилер"),i.form.need_percent_price?(t(),o("span",Ps,", %")):(t(),o("span",Ms,", руб"))])])]),e("div",Ts,[e("div",qs,[u(e("input",{type:"number","onUpdate:modelValue":s[8]||(s[8]=l=>i.form.price.cost=l),class:"form-control",id:"price-cost",required:""},null,512),[[p,i.form.price.cost]]),e("label",Ds,[a("Себестоимость"),i.form.need_percent_price?(t(),o("span",Ns,", %")):(t(),o("span",Bs,", руб"))])])])])])]),e("div",Es,[e("div",Gs,[i.messages.length>0?(t(!0),o(m,{key:0},f(i.messages,(l,y)=>(t(),o("div",Js,[Zs,a(" "+_(l||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:nt=>h.removeMessage(y)},null,8,zs)]))),256)):c("",!0)])]),e("div",Hs,[e("div",Ks,[e("button",{disabled:!h.needClearForm,class:"btn btn-dark rounded-0"},[i.loading?(t(),o("span",Ws)):(t(),o("i",Rs)),a(" Сохранить сервис ")],8,Qs),h.needClearForm&&!i.loading?(t(),o("button",{key:0,type:"button",onClick:s[9]||(s[9]=(...l)=>h.resetForm&&h.resetForm(...l)),class:"btn btn-outline-secondary rounded-0 ml-2"},[Xs,a(" Очистить форму ")])):c("",!0)])])],32)}const xs=L(ls,[["render",Ys]]),et=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Сервисы",-1),st={class:"py-12"},tt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},ot={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},it={class:"p-6 text-gray-900"},lt=e("hr",{class:"hr my-5"},null,-1),rt={data(){return{loading:!1,selectedService:null}},methods:{selectService(n){this.selectedService=n,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackServiceForm(){this.loading=!0,this.selectedService=null,this.$nextTick(()=>{this.loading=!1})}}},pt=Object.assign(rt,{__name:"ServicesPage",setup(n){return(s,r)=>(t(),o(m,null,[b(V(j),{title:"Сервисы"}),b(k,null,{header:g(()=>[et]),default:g(()=>[e("div",st,[e("div",tt,[e("div",ot,[e("div",it,[s.loading?c("",!0):(t(),v(xs,{key:0,item:s.selectedService,onCallback:s.callbackServiceForm},null,8,["item","onCallback"])),lt,s.loading?c("",!0):(t(),v(is,{key:1,onSelect:s.selectService},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{pt as default};
