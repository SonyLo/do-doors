import{_ as $}from"./AuthenticatedLayout-BwlFaWt8.js";import{m as y,o as l,c as i,b as e,f as h,v as u,g as c,e as n,F as m,r as p,d as f,t as _,n as b,j as k,a as g,u as w,w as v,Z as C}from"./app-CxYZ2Lw4.js";import{P as H}from"./Pagination-BLsYNeO3.js";import{R as j}from"./RalColorSelector-DPOAZ28v.js";import"./ApplicationLogo-CPHbI4qR.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-the-mask-8BRBEpNH.js";const L={class:"row"},U={class:"col-12"},I={class:"input-group mb-3"},V={class:"form-floating"},F=e("label",{for:"search-handles"},"Поиск по ручкам",-1),P=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),A=[P],S={style:{"overflow-y":"auto"}},M={key:0,class:"table"},O={key:0},T=e("i",{class:"fa-solid fa-caret-down"},null,-1),R=[T],N={key:1},q=e("i",{class:"fa-solid fa-caret-up"},null,-1),B=[q],D={key:0},E=e("i",{class:"fa-solid fa-caret-down"},null,-1),J=[E],z={key:1},G=e("i",{class:"fa-solid fa-caret-up"},null,-1),Z=[G],K={key:0},Q=e("i",{class:"fa-solid fa-caret-down"},null,-1),W=[Q],X={key:1},Y=e("i",{class:"fa-solid fa-caret-up"},null,-1),x=[Y],ee={key:0},te=e("i",{class:"fa-solid fa-caret-down"},null,-1),se=[te],oe={key:1},le=e("i",{class:"fa-solid fa-caret-up"},null,-1),ae=[le],ie=e("th",{scope:"col",class:"text-center"},"Варианты ручек",-1),ne={key:0},de=e("i",{class:"fa-solid fa-caret-down"},null,-1),re=[de],ce={key:1},he=e("i",{class:"fa-solid fa-caret-up"},null,-1),ue=[he],me=e("th",{scope:"col",class:"text-center"},"Действие",-1),_e={scope:"row"},pe=["onClick"],fe={class:"text-center"},ge={class:"text-center d-flex justify-center"},ve={key:1},be={class:"text-center"},$e={class:"text-center"},ye={class:"text-center"},ke={class:"dropdown"},we=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Ce={class:"dropdown-menu"},He=["onClick"],je=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Le=["onClick"],Ue=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Ie={key:0,class:"alert alert-success",role:"alert"},Ve=e("h4",{class:"alert-heading"},"Ручки",-1),Fe=e("p",null,"К сожалению, раздел ручек пуст. Вы еще не добавили ни одной ручки, которые можно отобразить на этой странице.",-1),Pe=e("hr",null,null,-1),Ae=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте свою первую ручку",-1),Se=[Ve,Fe,Pe,Ae],Me={key:1,class:"row mb-3"},Oe={class:"col-12"},Te={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0,variants:[]}]}},computed:{...y(["getHandles","getHandlesPaginateObject"])},mounted(){this.loadHandles()},methods:{sortAndLoad(a){this.sort.column=a,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadHandles(this.current_page)},loadHandles(a=0){this.current_page=a,this.$store.dispatch("loadHandles",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getHandles,this.paginate_object=this.getHandlesPaginateObject}).catch(()=>{this.loading=!1})},selectItem(a){this.$emit("select",a)},duplicateItem(a){this.$store.dispatch("duplicateHandle",{handleId:a}).then(()=>{this.sortAndLoad("id")})},removeItem(a){this.$store.dispatch("removeHandle",{handleId:a}).then(()=>{this.sortAndLoad("id")})}}},Re=Object.assign(Te,{__name:"HandleTable",setup(a){return(t,o)=>(l(),i(m,null,[e("form",L,[e("div",U,[e("div",I,[e("div",V,[h(e("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=s=>t.search=s),class:"form-control",id:"search-handles"},null,512),[[u,t.search]]),F]),e("button",{type:"button",onClick:o[1]||(o[1]=s=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},A)])])]),e("div",S,[t.items.length>0?(l(),i("table",M,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=s=>t.sortAndLoad("id"))},[c("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(l(),i("span",O,R)):n("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(l(),i("span",N,B)):n("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[3]||(o[3]=s=>t.sortAndLoad("title"))},[c("Название "),t.sort.direction==="desc"&&t.sort.column==="title"?(l(),i("span",D,J)):n("",!0),t.sort.direction==="asc"&&t.sort.column==="title"?(l(),i("span",z,Z)):n("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[4]||(o[4]=s=>t.sortAndLoad("price"))},[c("Цена "),t.sort.direction==="desc"&&t.sort.column==="price"?(l(),i("span",K,W)):n("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(l(),i("span",X,x)):n("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[5]||(o[5]=s=>t.sortAndLoad("color"))},[c("Цвет "),t.sort.direction==="desc"&&t.sort.column==="color"?(l(),i("span",ee,se)):n("",!0),t.sort.direction==="asc"&&t.sort.column==="color"?(l(),i("span",oe,ae)):n("",!0)]),ie,e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[6]||(o[6]=s=>t.sortAndLoad("updated_at"))},[c(" Дата изменения "),t.sort.direction==="desc"&&t.sort.column==="updated_at"?(l(),i("span",ne,re)):n("",!0),t.sort.direction==="asc"&&t.sort.column==="updated_at"?(l(),i("span",ce,ue)):n("",!0)]),me])]),e("tbody",null,[(l(!0),i(m,null,p(t.items,(s,d)=>(l(),i("tr",null,[e("th",_e,_(s.id||d),1),e("td",{class:"text-center",onClick:r=>t.selectItem(s)},_(s.title||"-"),9,pe),e("td",fe,_(s.price||0),1),e("td",ge,[s.color?(l(),i("span",{key:0,class:"d-block shadow-md",style:b([{"background-color":s.color},{width:"50px",height:"50px"}])},null,4)):(l(),i("span",ve,"Цвет не указан"))]),e("td",be,_(s.variants.length),1),e("td",$e,_(s.updated_at||"-"),1),e("td",ye,[e("div",ke,[we,e("ul",Ce,[e("li",null,[e("a",{class:"dropdown-item",onClick:r=>t.selectItem(s),href:"javascript:void(0)"},[je,c("Редактировать")],8,He)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:r=>t.removeItem(s.id),href:"javascript:void(0)"},[Ue,c("Удалить")],8,Le)])])])])]))),256))])])):n("",!0)]),t.items.length===0?(l(),i("div",Ie,Se)):n("",!0),t.items.length>0?(l(),i("div",Me,[e("div",Oe,[t.paginate_object?(l(),f(H,{key:0,onPagination_page:t.loadHandles,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):n("",!0)])])):n("",!0)],64))}}),Ne={class:"form-floating mb-3"},qe=e("label",{for:"handle-title"},"Название ручки",-1),Be={class:"form-floating mb-3"},De=e("label",{for:"handle-title"},"Цена ручки",-1),Ee={class:"input-group mb-3"},Je={class:"form-floating"},ze=e("label",{for:"fittings_color"},[e("i",{class:"fa-solid fa-palette"}),c(" Цвет ручки")],-1),Ge=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),Ze={class:"dropdown-menu dropdown-menu-end"},Ke=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),Qe={class:"form-floating mb-3 border-gray-100 border"},We=e("label",{for:"door-handle"},"Вариант ручки",-1),Xe={class:"row"},Ye={key:0,class:"col-12"},xe=e("h6",{class:"font-bold my-3"},"Новые фотографии к ручке",-1),et=[xe],tt={class:"col-md-4 mb-2 image-preview d-flex align-items-start"},st={class:"card w-100"},ot=["src"],lt={class:"card-body d-flex justify-center"},at=["onClick"],it={class:"card-body"},nt={class:"form-floating mb-3"},dt=["onUpdate:modelValue"],rt=e("label",{for:"floatingInput"},"Название",-1),ct={class:"form-floating"},ht=["onUpdate:modelValue"],ut=e("label",{for:"floatingTextarea"},"Описание",-1),mt={key:2,class:"col-12"},_t=e("h6",{class:"font-bold my-3"},"Ранее загруженные фотографии к ручке",-1),pt=[_t],ft={class:"col-md-4 mb-2 image-preview d-flex align-items-start"},gt={class:"card w-100"},vt=["src"],bt=["src"],$t={class:"card-body d-flex justify-center"},yt=["onClick"],kt={class:"card-body"},wt={class:"form-floating mb-3"},Ct=["onUpdate:modelValue"],Ht=e("label",{for:"floatingInput"},"Название",-1),jt={class:"form-floating"},Lt=["onUpdate:modelValue"],Ut=e("label",{for:"floatingTextarea"},"Описание",-1),It={class:"row"},Vt={class:"col-12"},Ft={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Pt=e("strong",null,"Внимание!",-1),At=["onClick"],St={class:"row mt-5"},Mt={class:"col-12 d-flex justify-content-center"},Ot=["disabled"],Tt={key:0,class:"fa-regular fa-floppy-disk mr-1"},Rt={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},Nt=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1),qt={class:"modal fade",id:"choose-color-handle",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Bt={class:"modal-dialog"},Dt={class:"modal-content"},Et=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор цвета RAL"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Jt={class:"modal-body"},zt={props:["item"],data(){return{messages:[],uploaded_variants_image:[],loading:!1,colorModal:null,form:{id:null,title:null,price:null,color:null,variants:[]}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price||this.form.color||this.uploaded_variants_image.length>0}},mounted(){this.colorModal=new bootstrap.Modal(document.getElementById("choose-color-handle"),{}),this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||0,color:this.item.color||null,variants:this.item.variants||[]}})},methods:{callbackSelectColor(a){this.form.color=a.color.hex,this.colorModal.hide()},selectColor(){this.colorModal.show()},isHex(a){return/^#[0-9A-F]{6}$/i.test(a)},alert(a){this.messages.push(a)},resetForm(){this.uploaded_variants_image=[],this.form.id=null,this.form.title=null,this.form.price=0,this.form.color=null,this.form.variants=[],this.$refs.handleImageRef.value=null,this.$emit("callback")},removeUploadedPhoto(a,t){this.form[a].splice(t,1)},removePhoto(a,t){this[a].splice(t,1)},getPhoto(a){return{imageUrl:URL.createObjectURL(a)}},onChangePhotos(a,t){const o=t.target.files;for(let s=0;s<o.length;s++)this[a].push({image:o[s],title:null,description:null})},removeMessage(a){this.messages.splice(a,1)},submit(){let a=new FormData;if(Object.keys(this.form).forEach(t=>{const o=this.form[t]||"";typeof o=="object"?a.append(t,JSON.stringify(o)):a.append(t,o)}),this.uploaded_variants_image.length>0){for(let t=0;t<this.uploaded_variants_image.length;t++)a.append("uploaded_variants_image[]",this.uploaded_variants_image[t].image),this.uploaded_variants_image[t].image_name=this.uploaded_variants_image[t].image.name||null;a.append("uploaded_image_info",JSON.stringify(this.uploaded_variants_image))}this.$store.dispatch("storeHandle",{handleForm:a}).then(t=>{this.$emit("callback"),this.resetForm()}).catch(t=>{})}}},Gt=Object.assign(zt,{__name:"HandleForm",setup(a){return(t,o)=>(l(),i(m,null,[e("form",{action:"",onSubmit:o[8]||(o[8]=k((...s)=>t.submit&&t.submit(...s),["prevent"]))},[e("div",Ne,[h(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=s=>t.form.title=s),class:"form-control",id:"handle-title",required:""},null,512),[[u,t.form.title]]),qe]),e("div",Be,[h(e("input",{type:"number","onUpdate:modelValue":o[1]||(o[1]=s=>t.form.price=s),class:"form-control",id:"handle-price",required:""},null,512),[[u,t.form.price]]),De]),e("div",Ee,[t.isHex(t.form.color)?(l(),i("span",{key:0,class:"input-group-text border-secondary rounded-0",style:b([{"background-color":t.form.color},{width:"40px"}]),id:"basic-addon1"},null,4)):n("",!0),e("div",Je,[h(e("input",{type:"text",onInvalid:o[2]||(o[2]=s=>t.alert("Вы не выбрали цвет фурнитуры")),"onUpdate:modelValue":o[3]||(o[3]=s=>t.form.color=s),class:"form-control",id:"fittings_color",required:""},null,544),[[u,t.form.color]]),ze]),Ge,e("ul",Ze,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:o[4]||(o[4]=s=>t.form.color=null)},"Не выбрано")]),Ke,e("li",null,[e("a",{class:"dropdown-item",onClick:o[5]||(o[5]=(...s)=>t.selectColor&&t.selectColor(...s)),href:"javascript:void(0)"},"Цвет RAL")])])]),e("div",Qe,[e("input",{type:"file",class:"form-control",accept:"image/*",id:"door-handle",ref:"handleImageRef",onChange:o[6]||(o[6]=s=>t.onChangePhotos("uploaded_variants_image",s)),multiple:""},null,544),We]),e("div",Xe,[t.uploaded_variants_image.length>0?(l(),i("div",Ye,et)):n("",!0),t.uploaded_variants_image.length>0?(l(!0),i(m,{key:1},p(t.uploaded_variants_image,(s,d)=>(l(),i("div",tt,[e("div",st,[e("img",{style:{"min-height":"200px"},src:t.getPhoto(s.image).imageUrl,class:"card-img-top uploaded-image-mini",alt:""},null,8,ot),e("div",lt,[e("a",{href:"javascript:void(0)",class:"text-danger",onClick:r=>t.removePhoto("uploaded_variants_image",d)},"Удалить фото",8,at)]),e("div",it,[e("div",nt,[h(e("input",{type:"text","onUpdate:modelValue":r=>t.uploaded_variants_image[d].title=r,class:"form-control border-gray-300 rounded-md",id:"floatingInput",required:""},null,8,dt),[[u,t.uploaded_variants_image[d].title]]),rt]),e("div",ct,[h(e("textarea",{class:"form-control","onUpdate:modelValue":r=>t.uploaded_variants_image[d].description=r,placeholder:"Leave a comment here",id:"floatingTextarea",required:""},null,8,ht),[[u,t.uploaded_variants_image[d].description]]),ut])])])]))),256)):n("",!0),t.form.variants.length>0?(l(),i("div",mt,pt)):n("",!0),(l(!0),i(m,null,p(t.form.variants,(s,d)=>(l(),i("div",ft,[e("div",gt,[s.image.indexOf("http")===-1?(l(),i("img",{key:0,style:{"min-height":"200px"},src:"/images/"+s.image,class:"card-img-top uploaded-image-mini",alt:""},null,8,vt)):(l(),i("img",{key:1,style:{"min-height":"200px"},src:s.image,class:"card-img-top uploaded-image-mini",alt:""},null,8,bt)),e("div",$t,[e("a",{href:"javascript:void(0)",class:"text-danger",onClick:r=>t.removeUploadedPhoto("variants",d)},"Удалить",8,yt)]),e("div",kt,[e("div",wt,[h(e("input",{type:"text","onUpdate:modelValue":r=>t.form.variants[d].title=r,class:"form-control border-gray-300 rounded-md",id:"floatingInput"},null,8,Ct),[[u,t.form.variants[d].title]]),Ht]),e("div",jt,[h(e("textarea",{class:"form-control","onUpdate:modelValue":r=>t.form.variants[d].description=r,placeholder:"Leave a comment here",id:"floatingTextarea"},null,8,Lt),[[u,t.form.variants[d].description]]),Ut])])])]))),256))]),e("div",It,[e("div",Vt,[t.messages.length>0?(l(!0),i(m,{key:0},p(t.messages,(s,d)=>(l(),i("div",Ft,[Pt,c(" "+_(s||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:r=>t.removeMessage(d)},null,8,At)]))),256)):n("",!0)])]),e("div",St,[e("div",Mt,[e("button",{disabled:!t.needClearForm,class:"btn btn-dark rounded-0"},[t.loading?(l(),i("span",Rt)):(l(),i("i",Tt)),c(" Сохранить ручку ")],8,Ot),t.needClearForm&&!t.loading?(l(),i("button",{key:0,type:"button",onClick:o[7]||(o[7]=(...s)=>t.resetForm&&t.resetForm(...s)),class:"btn btn-outline-secondary rounded-0 ml-2"},[Nt,c(" Очистить форму ")])):n("",!0)])])],32),e("div",qt,[e("div",Bt,[e("div",Dt,[Et,e("div",Jt,[g(j,{onSelect:t.callbackSelectColor},null,8,["onSelect"])])])])])],64))}}),Zt=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Ручки",-1),Kt={class:"py-12"},Qt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Wt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Xt={class:"p-6 text-gray-900"},Yt=e("hr",{class:"hr my-5"},null,-1),xt={data(){return{loading:!1,selectedHandle:null}},methods:{selectHandle(a){this.selectedHandle=a,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackHandleForm(){this.loading=!0,this.selectedHandle=null,this.$nextTick(()=>{this.loading=!1})}}},ns=Object.assign(xt,{__name:"HandlesPage",setup(a){return(t,o)=>(l(),i(m,null,[g(w(C),{title:"Ручки"}),g($,null,{header:v(()=>[Zt]),default:v(()=>[e("div",Kt,[e("div",Qt,[e("div",Wt,[e("div",Xt,[t.loading?n("",!0):(l(),f(Gt,{key:0,item:t.selectedHandle,onCallback:t.callbackHandleForm},null,8,["item","onCallback"])),Yt,t.loading?n("",!0):(l(),f(Re,{key:1,onSelect:t.selectHandle},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{ns as default};
