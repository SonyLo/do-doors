import{_ as y}from"./AuthenticatedLayout-DBgM4VQ5.js";import{m as $,o as s,c as i,b as e,f as _,v as m,g as h,e as r,F as p,r as v,d as f,t as u,j as w,a as g,u as H,w as b,Z as C}from"./app-NdxZFBuQ.js";import{P as j}from"./Pagination-B0hBMUy8.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BwtCGJ6R.js";import"./vue-the-mask-D9zh-Vm5.js";const V={class:"row"},L={class:"col-12"},A={class:"input-group mb-3"},I={class:"form-floating"},O=e("label",{for:"search-hinges"},"Поиск по производителям петель",-1),P=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),T=[P],U={style:{"overflow-y":"auto"}},q={key:0,class:"table"},N={key:0},S=e("i",{class:"fa-solid fa-caret-down"},null,-1),B=[S],M={key:1},D=e("i",{class:"fa-solid fa-caret-up"},null,-1),E=[D],G={key:0},J=e("i",{class:"fa-solid fa-caret-down"},null,-1),Z=[J],z={key:1},K=e("i",{class:"fa-solid fa-caret-up"},null,-1),Q=[K],R={key:0},W=e("i",{class:"fa-solid fa-caret-down"},null,-1),X=[W],Y={key:1},x=e("i",{class:"fa-solid fa-caret-up"},null,-1),ee=[x],te={key:0},se=e("i",{class:"fa-solid fa-caret-down"},null,-1),oe=[se],ie={key:1},ne=e("i",{class:"fa-solid fa-caret-up"},null,-1),le=[ne],re=e("th",{scope:"col",class:"text-center"},"Действие",-1),ae={scope:"row"},de=["onClick"],ce={class:"text-center"},he={class:"w-100"},ue=e("thead",null,[e("th",null,"опт"),e("th",null,"дилер"),e("th",null,"розница"),e("th",null,"себестоимость")],-1),_e={style:{"min-width":"100px","text-align":"center"}},me={style:{"min-width":"100px","text-align":"center"}},pe={style:{"min-width":"100px","text-align":"center"}},fe={style:{"min-width":"100px","text-align":"center"}},ge={class:"text-center"},be={class:"text-center"},ve={class:"dropdown"},ke=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),ye={class:"dropdown-menu"},$e=["onClick"],we=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),He=["onClick"],Ce=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),je={key:0,class:"alert alert-success",role:"alert"},Fe=e("h4",{class:"alert-heading"},"Петли",-1),Ve=e("p",null,"К сожалению, раздел петель пуст. Вы еще не добавили ни одного производителя петель, которые можно отобразить на этой странице.",-1),Le=e("hr",null,null,-1),Ae=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте своего первого производителя петель",-1),Ie=[Fe,Ve,Le,Ae],Oe={key:1,class:"row mb-3"},Pe={class:"col-12"},Te={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...$(["getHinges","getHingesPaginateObject"])},mounted(){this.loadHinges()},methods:{sortAndLoad(o){this.sort.column=o,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadHinges(this.current_page)},loadHinges(o=0){this.current_page=o,this.$store.dispatch("loadHinges",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getHinges,this.paginate_object=this.getHingesPaginateObject}).catch(()=>{this.loading=!1})},selectItem(o){this.$emit("select",o)},duplicateItem(o){this.$store.dispatch("duplicateHinge",{hingeId:o}).then(()=>{this.sortAndLoad("id")})},removeItem(o){this.$store.dispatch("removeHinge",{hingeId:o}).then(()=>{this.sortAndLoad("id")})}}},Ue=Object.assign(Te,{__name:"HingeTable",setup(o){return(t,l)=>(s(),i(p,null,[e("form",V,[e("div",L,[e("div",A,[e("div",I,[_(e("input",{type:"search","onUpdate:modelValue":l[0]||(l[0]=d=>t.search=d),class:"form-control",id:"search-hinges"},null,512),[[m,t.search]]),O]),e("button",{type:"button",onClick:l[1]||(l[1]=d=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},T)])])]),e("div",U,[t.items.length>0?(s(),i("table",q,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:l[2]||(l[2]=d=>t.sortAndLoad("id"))},[h("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(s(),i("span",N,B)):r("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(s(),i("span",M,E)):r("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[3]||(l[3]=d=>t.sortAndLoad("title"))},[h("Название "),t.sort.direction==="desc"&&t.sort.column==="title"?(s(),i("span",G,Z)):r("",!0),t.sort.direction==="asc"&&t.sort.column==="title"?(s(),i("span",z,Q)):r("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[4]||(l[4]=d=>t.sortAndLoad("price"))},[h("Цена "),t.sort.direction==="desc"&&t.sort.column==="price"?(s(),i("span",R,X)):r("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(s(),i("span",Y,ee)):r("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:l[5]||(l[5]=d=>t.sortAndLoad("updated_at"))},[h(" Дата изменения "),t.sort.direction==="desc"&&t.sort.column==="updated_at"?(s(),i("span",te,oe)):r("",!0),t.sort.direction==="asc"&&t.sort.column==="updated_at"?(s(),i("span",ie,le)):r("",!0)]),re])]),e("tbody",null,[(s(!0),i(p,null,v(t.items,(d,n)=>(s(),i("tr",null,[e("th",ae,u(d.id||n),1),e("td",{class:"text-center",onClick:c=>t.selectItem(d)},u(d.title||"-"),9,de),e("td",ce,[e("table",he,[ue,e("tbody",null,[e("tr",null,[e("td",_e,u(t.items[n].price.wholesale||0),1),e("td",me,u(t.items[n].price.dealer||0),1),e("td",pe,u(t.items[n].price.retail||0),1),e("td",fe,u(t.items[n].price.cost||0),1)])])])]),e("td",ge,u(d.updated_at||"-"),1),e("td",be,[e("div",ve,[ke,e("ul",ye,[e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItem(d),href:"javascript:void(0)"},[we,h("Редактировать")],8,$e)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(d.id),href:"javascript:void(0)"},[Ce,h("Удалить")],8,He)])])])])]))),256))])])):r("",!0)]),t.items.length===0?(s(),i("div",je,Ie)):r("",!0),t.items.length>0?(s(),i("div",Oe,[e("div",Pe,[t.paginate_object?(s(),f(j,{key:0,onPagination_page:t.loadHinges,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):r("",!0)])])):r("",!0)],64))}}),qe={props:["item"],data(){return{messages:[],loading:!1,form:{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0}}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0}}})},methods:{alert(o){this.messages.push(o)},resetForm(){this.form.id=null,this.form.title=null,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.$emit("callback")},removeMessage(o){this.messages.splice(o,1)},submit(){let o=new FormData;Object.keys(this.form).forEach(t=>{const l=this.form[t]||"";typeof l=="object"?o.append(t,JSON.stringify(l)):o.append(t,l)}),this.$store.dispatch("storeHinge",{hingeForm:o}).then(t=>{this.$emit("callback"),this.resetForm()}).catch(t=>{})}}},Ne={class:"form-floating mb-3"},Se=e("label",{for:"hinge-title"},"Наименование производителя петель",-1),Be={class:"card rounded-0 mb-3 border-black"},Me=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),De={class:"card-body"},Ee={class:"row"},Ge={class:"col-6"},Je={class:"form-floating mb-3"},Ze=e("label",{for:"price-wholesale"},"Опт",-1),ze={class:"col-6"},Ke={class:"form-floating mb-3"},Qe=e("label",{for:"price-retail"},"Розница",-1),Re={class:"col-6"},We={class:"form-floating"},Xe=e("label",{for:"price-dealer"},"Дилер",-1),Ye={class:"col-6"},xe={class:"form-floating"},et=e("label",{for:"price-cost"},"Себестоимость",-1),tt={class:"row"},st={class:"col-12"},ot={class:"alert alert-danger alert-dismissible fade show",role:"alert"},it=e("strong",null,"Внимание!",-1),nt=["onClick"],lt={class:"row mt-5"},rt={class:"col-12 d-flex justify-content-center"},at=["disabled"],dt={key:0,class:"fa-regular fa-floppy-disk mr-1"},ct={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},ht=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1);function ut(o,t,l,d,n,c){return s(),i("form",{action:"",onSubmit:t[6]||(t[6]=w((...a)=>c.submit&&c.submit(...a),["prevent"]))},[e("div",Ne,[_(e("input",{type:"text","onUpdate:modelValue":t[0]||(t[0]=a=>n.form.title=a),class:"form-control",id:"hinge-title",required:""},null,512),[[m,n.form.title]]),Se]),e("div",Be,[Me,e("div",De,[e("div",Ee,[e("div",Ge,[e("div",Je,[_(e("input",{type:"number","onUpdate:modelValue":t[1]||(t[1]=a=>n.form.price.wholesale=a),class:"form-control",id:"price-wholesale",required:""},null,512),[[m,n.form.price.wholesale]]),Ze])]),e("div",ze,[e("div",Ke,[_(e("input",{type:"number","onUpdate:modelValue":t[2]||(t[2]=a=>n.form.price.retail=a),class:"form-control",id:"price-retail",required:""},null,512),[[m,n.form.price.retail]]),Qe])]),e("div",Re,[e("div",We,[_(e("input",{type:"number","onUpdate:modelValue":t[3]||(t[3]=a=>n.form.price.dealer=a),class:"form-control",id:"price-dealer",required:""},null,512),[[m,n.form.price.dealer]]),Xe])]),e("div",Ye,[e("div",xe,[_(e("input",{type:"number","onUpdate:modelValue":t[4]||(t[4]=a=>n.form.price.cost=a),class:"form-control",id:"price-cost",required:""},null,512),[[m,n.form.price.cost]]),et])])])])]),e("div",tt,[e("div",st,[n.messages.length>0?(s(!0),i(p,{key:0},v(n.messages,(a,k)=>(s(),i("div",ot,[it,h(" "+u(a||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:yt=>c.removeMessage(k)},null,8,nt)]))),256)):r("",!0)])]),e("div",lt,[e("div",rt,[e("button",{disabled:!c.needClearForm,class:"btn btn-dark rounded-0"},[n.loading?(s(),i("span",ct)):(s(),i("i",dt)),h(" Сохранить производителя петель ")],8,at),c.needClearForm&&!n.loading?(s(),i("button",{key:0,type:"button",onClick:t[5]||(t[5]=(...a)=>c.resetForm&&c.resetForm(...a)),class:"btn btn-outline-secondary rounded-0 ml-2"},[ht,h(" Очистить форму ")])):r("",!0)])])],32)}const _t=F(qe,[["render",ut]]),mt=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Петли",-1),pt={class:"py-12"},ft={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},gt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},bt={class:"p-6 text-gray-900"},vt=e("hr",{class:"hr my-5"},null,-1),kt={data(){return{loading:!1,selectedHinge:null}},methods:{selectHinge(o){this.selectedHinge=o,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackHingeForm(){this.loading=!0,this.selectedHinge=null,this.$nextTick(()=>{this.loading=!1})}}},Vt=Object.assign(kt,{__name:"HingesPage",setup(o){return(t,l)=>(s(),i(p,null,[g(H(C),{title:"Петли"}),g(y,null,{header:b(()=>[mt]),default:b(()=>[e("div",pt,[e("div",ft,[e("div",gt,[e("div",bt,[t.loading?r("",!0):(s(),f(_t,{key:0,item:t.selectedHinge,onCallback:t.callbackHingeForm},null,8,["item","onCallback"])),vt,t.loading?r("",!0):(s(),f(Ue,{key:1,onSelect:t.selectHinge},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{Vt as default};
