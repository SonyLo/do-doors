import{_ as y}from"./AuthenticatedLayout-VxhPxQC7.js";import{m as $,o as e,c as i,b as t,f as _,v as m,g as h,e as l,F as p,r as v,d as f,t as u,j as w,a as g,u as V,w as b,Z as D}from"./app-IgJzOcEi.js";import{P as C}from"./Pagination-BIryTHWu.js";import{_ as j}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-DnOrubwk.js";const F={class:"row"},L={class:"col-12"},A={class:"input-group mb-3"},I={class:"form-floating"},O=t("label",{for:"search-door-variants"},"Поиск по производителям петель",-1),P=t("i",{class:"fa-solid fa-magnifying-glass"},null,-1),T=[P],U={style:{"overflow-y":"auto"}},q={key:0,class:"table"},N={key:0},S=t("i",{class:"fa-solid fa-caret-down"},null,-1),B=[S],M={key:1},E=t("i",{class:"fa-solid fa-caret-up"},null,-1),G=[E],J={key:0},Z=t("i",{class:"fa-solid fa-caret-down"},null,-1),z=[Z],H={key:1},K=t("i",{class:"fa-solid fa-caret-up"},null,-1),Q=[K],R={key:0},W=t("i",{class:"fa-solid fa-caret-down"},null,-1),X=[W],Y={key:1},x=t("i",{class:"fa-solid fa-caret-up"},null,-1),tt=[x],st={key:0},et=t("i",{class:"fa-solid fa-caret-down"},null,-1),ot=[et],it={key:1},nt=t("i",{class:"fa-solid fa-caret-up"},null,-1),rt=[nt],lt=t("th",{scope:"col",class:"text-center"},"Действие",-1),at={scope:"row"},dt=["onClick"],ct={class:"text-center"},ht={class:"w-100"},ut=t("thead",null,[t("th",null,"опт"),t("th",null,"дилер"),t("th",null,"розница"),t("th",null,"себестоимость")],-1),_t={style:{"min-width":"100px","text-align":"center"}},mt={style:{"min-width":"100px","text-align":"center"}},pt={style:{"min-width":"100px","text-align":"center"}},ft={style:{"min-width":"100px","text-align":"center"}},gt={class:"text-center"},bt={class:"text-center"},vt={class:"dropdown"},kt=t("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa-solid fa-bars"})],-1),yt={class:"dropdown-menu"},$t=["onClick"],wt=t("i",{class:"fa-solid fa-pen mr-2"},null,-1),Vt=["onClick"],Dt=t("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Ct={key:0,class:"alert alert-success",role:"alert"},jt=t("h4",{class:"alert-heading"},"Варианты дверей",-1),Ft=t("p",null,"К сожалению, раздел Варианты дверей пуст. Вы еще не добавили ни одного варианта дверей, которые можно отобразить на этой странице.",-1),Lt=t("hr",null,null,-1),At=t("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте свой первый вариант дверей",-1),It=[jt,Ft,Lt,At],Ot={key:1,class:"row mb-3"},Pt={class:"col-12"},Tt={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...$(["getDoorVariants","getDoorVariantsPaginateObject"])},mounted(){this.loadDoorVariants()},methods:{sortAndLoad(o){this.sort.column=o,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadDoorVariants(this.current_page)},loadDoorVariants(o=0){this.current_page=o,this.$store.dispatch("loadDoorVariants",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(s=>{this.items=this.getDoorVariants,this.paginate_object=this.getDoorVariantsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(o){this.$emit("select",o)},duplicateItem(o){this.$store.dispatch("duplicateDoorVariant",{doorVariantId:o}).then(()=>{this.sortAndLoad("id")})},removeItem(o){this.$store.dispatch("removeDoorVariant",{doorVariantId:o}).then(()=>{this.sortAndLoad("id")})}}},Ut=Object.assign(Tt,{__name:"DoorVariantTable",setup(o){return(s,r)=>(e(),i(p,null,[t("form",F,[t("div",L,[t("div",A,[t("div",I,[_(t("input",{type:"search","onUpdate:modelValue":r[0]||(r[0]=d=>s.search=d),class:"form-control",id:"search-door-variants"},null,512),[[m,s.search]]),O]),t("button",{type:"button",onClick:r[1]||(r[1]=d=>s.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},T)])])]),t("div",U,[s.items.length>0?(e(),i("table",q,[t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"cursor-pointer",onClick:r[2]||(r[2]=d=>s.sortAndLoad("id"))},[h("# "),s.sort.direction==="desc"&&s.sort.column==="id"?(e(),i("span",N,B)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="id"?(e(),i("span",M,G)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[3]||(r[3]=d=>s.sortAndLoad("title"))},[h("Название "),s.sort.direction==="desc"&&s.sort.column==="title"?(e(),i("span",J,z)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="title"?(e(),i("span",H,Q)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[4]||(r[4]=d=>s.sortAndLoad("price"))},[h("Цена "),s.sort.direction==="desc"&&s.sort.column==="price"?(e(),i("span",R,X)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="price"?(e(),i("span",Y,tt)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:r[5]||(r[5]=d=>s.sortAndLoad("updated_at"))},[h(" Дата изменения "),s.sort.direction==="desc"&&s.sort.column==="updated_at"?(e(),i("span",st,ot)):l("",!0),s.sort.direction==="asc"&&s.sort.column==="updated_at"?(e(),i("span",it,rt)):l("",!0)]),lt])]),t("tbody",null,[(e(!0),i(p,null,v(s.items,(d,n)=>(e(),i("tr",null,[t("th",at,u(d.id||n),1),t("td",{class:"text-center",onClick:c=>s.selectItem(d)},u(d.title||"-"),9,dt),t("td",ct,[t("table",ht,[ut,t("tbody",null,[t("tr",null,[t("td",_t,u(s.items[n].price.wholesale||0),1),t("td",mt,u(s.items[n].price.dealer||0),1),t("td",pt,u(s.items[n].price.retail||0),1),t("td",ft,u(s.items[n].price.cost||0),1)])])])]),t("td",gt,u(d.updated_at||"-"),1),t("td",bt,[t("div",vt,[kt,t("ul",yt,[t("li",null,[t("a",{class:"dropdown-item",onClick:c=>s.selectItem(d),href:"javascript:void(0)"},[wt,h("Редактировать")],8,$t)]),t("li",null,[t("a",{class:"dropdown-item text-danger",onClick:c=>s.removeItem(d.id),href:"javascript:void(0)"},[Dt,h("Удалить")],8,Vt)])])])])]))),256))])])):l("",!0)]),s.items.length===0?(e(),i("div",Ct,It)):l("",!0),s.items.length>0?(e(),i("div",Ot,[t("div",Pt,[s.paginate_object?(e(),f(C,{key:0,onPagination_page:s.loadDoorVariants,pagination:s.paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):l("",!0)],64))}}),qt={props:["item"],data(){return{messages:[],loading:!1,form:{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0}}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0}}})},methods:{alert(o){this.messages.push(o)},resetForm(){this.form.id=null,this.form.title=null,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.$emit("callback")},removeMessage(o){this.messages.splice(o,1)},submit(){let o=new FormData;Object.keys(this.form).forEach(s=>{const r=this.form[s]||"";typeof r=="object"?o.append(s,JSON.stringify(r)):o.append(s,r)}),this.$store.dispatch("storeDoorVariant",{doorVariantForm:o}).then(s=>{this.$emit("callback"),this.resetForm()}).catch(s=>{})}}},Nt={class:"form-floating mb-3"},St=t("label",{for:"door-variant-title"},"Наименование варианта двери",-1),Bt={class:"card rounded-0 mb-3 border-black"},Mt=t("div",{class:"card-header bg-dark text-white rounded-0"},[t("h6",null,"Настройка цены")],-1),Et={class:"card-body"},Gt={class:"row"},Jt={class:"col-6"},Zt={class:"form-floating mb-3"},zt=t("label",{for:"price-wholesale"},"Опт",-1),Ht={class:"col-6"},Kt={class:"form-floating mb-3"},Qt=t("label",{for:"price-retail"},"Розница",-1),Rt={class:"col-6"},Wt={class:"form-floating"},Xt=t("label",{for:"price-dealer"},"Дилер",-1),Yt={class:"col-6"},xt={class:"form-floating"},ts=t("label",{for:"price-cost"},"Себестоимость",-1),ss={class:"row"},es={class:"col-12"},os={class:"alert alert-danger alert-dismissible fade show",role:"alert"},is=t("strong",null,"Внимание!",-1),ns=["onClick"],rs={class:"row mt-5"},ls={class:"col-12 d-flex justify-content-center"},as=["disabled"],ds={key:0,class:"fa-regular fa-floppy-disk mr-1"},cs={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},hs=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1);function us(o,s,r,d,n,c){return e(),i("form",{action:"",onSubmit:s[6]||(s[6]=w((...a)=>c.submit&&c.submit(...a),["prevent"]))},[t("div",Nt,[_(t("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=a=>n.form.title=a),class:"form-control",id:"door-variant-title",required:""},null,512),[[m,n.form.title]]),St]),t("div",Bt,[Mt,t("div",Et,[t("div",Gt,[t("div",Jt,[t("div",Zt,[_(t("input",{type:"number","onUpdate:modelValue":s[1]||(s[1]=a=>n.form.price.wholesale=a),class:"form-control",id:"price-wholesale",required:""},null,512),[[m,n.form.price.wholesale]]),zt])]),t("div",Ht,[t("div",Kt,[_(t("input",{type:"number","onUpdate:modelValue":s[2]||(s[2]=a=>n.form.price.retail=a),class:"form-control",id:"price-retail",required:""},null,512),[[m,n.form.price.retail]]),Qt])]),t("div",Rt,[t("div",Wt,[_(t("input",{type:"number","onUpdate:modelValue":s[3]||(s[3]=a=>n.form.price.dealer=a),class:"form-control",id:"price-dealer",required:""},null,512),[[m,n.form.price.dealer]]),Xt])]),t("div",Yt,[t("div",xt,[_(t("input",{type:"number","onUpdate:modelValue":s[4]||(s[4]=a=>n.form.price.cost=a),class:"form-control",id:"price-cost",required:""},null,512),[[m,n.form.price.cost]]),ts])])])])]),t("div",ss,[t("div",es,[n.messages.length>0?(e(!0),i(p,{key:0},v(n.messages,(a,k)=>(e(),i("div",os,[is,h(" "+u(a||"Ошибка")+" ",1),t("button",{type:"button",class:"btn-close",onClick:ys=>c.removeMessage(k)},null,8,ns)]))),256)):l("",!0)])]),t("div",rs,[t("div",ls,[t("button",{disabled:!c.needClearForm,class:"btn btn-dark rounded-0"},[n.loading?(e(),i("span",cs)):(e(),i("i",ds)),h(" Сохранить вариант двери ")],8,as),c.needClearForm&&!n.loading?(e(),i("button",{key:0,type:"button",onClick:s[5]||(s[5]=(...a)=>c.resetForm&&c.resetForm(...a)),class:"btn btn-outline-secondary rounded-0 ml-2"},[hs,h(" Очистить форму ")])):l("",!0)])])],32)}const _s=j(qt,[["render",us]]),ms=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Варианты дверей",-1),ps={class:"py-12"},fs={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},gs={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},bs={class:"p-6 text-gray-900"},vs=t("hr",{class:"hr my-5"},null,-1),ks={data(){return{loading:!1,selectedDoorVariant:null}},methods:{selectDoorVariant(o){this.selectedDoorVariant=o,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackDoorVariantForm(){this.loading=!0,this.selectedDoorVariant=null,this.$nextTick(()=>{this.loading=!1})}}},js=Object.assign(ks,{__name:"DoorVariantsPage",setup(o){return(s,r)=>(e(),i(p,null,[g(V(D),{title:"Варианты дверей"}),g(y,null,{header:b(()=>[ms]),default:b(()=>[t("div",ps,[t("div",fs,[t("div",gs,[t("div",bs,[s.loading?l("",!0):(e(),f(_s,{key:0,item:s.selectedDoorVariant,onCallback:s.callbackDoorVariantForm},null,8,["item","onCallback"])),vs,s.loading?l("",!0):(e(),f(Ut,{key:1,onSelect:s.selectDoorVariant},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{js as default};
