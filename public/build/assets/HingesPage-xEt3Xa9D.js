import{_ as y}from"./AuthenticatedLayout-DKEVbNu6.js";import{m as $,o as s,c as i,b as t,d as m,v as p,e as h,f as l,F as _,r as k,g,t as u,i as w,a as f,u as H,w as b,Z as C}from"./app-n5g1UPt_.js";import{P as j}from"./Pagination-T7_qpnq1.js";import{_ as F}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-CRyn42vh.js";const L={class:"row"},A={class:"col-12"},I={class:"input-group mb-3"},O={class:"form-floating"},P=t("label",{for:"search-hinges"},"Поиск по производителям петель",-1),V=t("i",{class:"fa-solid fa-magnifying-glass"},null,-1),T=[V],N={key:0,class:"table"},S={key:0},B=t("i",{class:"fa-solid fa-caret-down"},null,-1),M=[B],D={key:1},U=t("i",{class:"fa-solid fa-caret-up"},null,-1),q=[U],E={key:0},G=t("i",{class:"fa-solid fa-caret-down"},null,-1),J=[G],Z={key:1},z=t("i",{class:"fa-solid fa-caret-up"},null,-1),K=[z],Q={key:0},R=t("i",{class:"fa-solid fa-caret-down"},null,-1),W=[R],X={key:1},Y=t("i",{class:"fa-solid fa-caret-up"},null,-1),x=[Y],tt={key:0},et=t("i",{class:"fa-solid fa-caret-down"},null,-1),st=[et],ot={key:1},it=t("i",{class:"fa-solid fa-caret-up"},null,-1),nt=[it],lt=t("th",{scope:"col",class:"text-center"},"Действие",-1),rt={scope:"row"},at=["onClick"],dt={class:"text-center"},ct={class:"text-center"},ht={class:"text-center"},ut={class:"dropdown"},_t=t("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[t("i",{class:"fa-solid fa-bars"})],-1),mt={class:"dropdown-menu"},pt=["onClick"],gt=t("i",{class:"fa-solid fa-pen mr-2"},null,-1),ft=["onClick"],bt=t("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),kt={key:1,class:"alert alert-success",role:"alert"},vt=t("h4",{class:"alert-heading"},"Петли",-1),yt=t("p",null,"К сожалению, раздел петель пуст. Вы еще не добавили ни одного производителя петель, которые можно отобразить на этой странице.",-1),$t=t("hr",null,null,-1),wt=t("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте своего первого производителя петель",-1),Ht=[vt,yt,$t,wt],Ct={key:2,class:"row mb-3"},jt={class:"col-12"},Ft={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0}]}},computed:{...$(["getHinges","getHingesPaginateObject"])},mounted(){this.loadHinges()},methods:{sortAndLoad(o){this.sort.column=o,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadHinges(this.current_page)},loadHinges(o=0){this.current_page=o,this.$store.dispatch("loadHinges",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(e=>{this.items=this.getHinges,this.paginate_object=this.getHingesPaginateObject}).catch(()=>{this.loading=!1})},selectItem(o){this.$emit("select",o)},duplicateItem(o){this.$store.dispatch("duplicateHinge",{hingeId:o}).then(()=>{this.sortAndLoad("id")})},removeItem(o){this.$store.dispatch("removeHinge",{hingeId:o}).then(()=>{this.sortAndLoad("id")})}}},Lt=Object.assign(Ft,{__name:"HingeTable",setup(o){return(e,n)=>(s(),i(_,null,[t("form",L,[t("div",A,[t("div",I,[t("div",O,[m(t("input",{type:"search","onUpdate:modelValue":n[0]||(n[0]=r=>e.search=r),class:"form-control",id:"search-hinges"},null,512),[[p,e.search]]),P]),t("button",{type:"button",onClick:n[1]||(n[1]=r=>e.sortAndLoad("id")),class:"btn btn-outline-primary"},T)])])]),e.items.length>0?(s(),i("table",N,[t("thead",null,[t("tr",null,[t("th",{scope:"col",class:"cursor-pointer",onClick:n[2]||(n[2]=r=>e.sortAndLoad("id"))},[h("# "),e.sort.direction==="desc"&&e.sort.column==="id"?(s(),i("span",S,M)):l("",!0),e.sort.direction==="asc"&&e.sort.column==="id"?(s(),i("span",D,q)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:n[3]||(n[3]=r=>e.sortAndLoad("title"))},[h("Название "),e.sort.direction==="desc"&&e.sort.column==="title"?(s(),i("span",E,J)):l("",!0),e.sort.direction==="asc"&&e.sort.column==="title"?(s(),i("span",Z,K)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:n[4]||(n[4]=r=>e.sortAndLoad("price"))},[h("Цена "),e.sort.direction==="desc"&&e.sort.column==="price"?(s(),i("span",Q,W)):l("",!0),e.sort.direction==="asc"&&e.sort.column==="price"?(s(),i("span",X,x)):l("",!0)]),t("th",{scope:"col",class:"text-center cursor-pointer",onClick:n[5]||(n[5]=r=>e.sortAndLoad("updated_at"))},[h(" Дата изменения "),e.sort.direction==="desc"&&e.sort.column==="updated_at"?(s(),i("span",tt,st)):l("",!0),e.sort.direction==="asc"&&e.sort.column==="updated_at"?(s(),i("span",ot,nt)):l("",!0)]),lt])]),t("tbody",null,[(s(!0),i(_,null,k(e.items,(r,a)=>(s(),i("tr",null,[t("th",rt,u(r.id||a),1),t("td",{class:"text-center",onClick:d=>e.selectItem(r)},u(r.title||"-"),9,at),t("td",dt,u(r.price||0),1),t("td",ct,u(r.updated_at||"-"),1),t("td",ht,[t("div",ut,[_t,t("ul",mt,[t("li",null,[t("a",{class:"dropdown-item",onClick:d=>e.selectItem(r),href:"javascript:void(0)"},[gt,h("Редактировать")],8,pt)]),t("li",null,[t("a",{class:"dropdown-item text-danger",onClick:d=>e.removeItem(r.id),href:"javascript:void(0)"},[bt,h("Удалить")],8,ft)])])])])]))),256))])])):l("",!0),e.items.length===0?(s(),i("div",kt,Ht)):l("",!0),e.items.length>0?(s(),i("div",Ct,[t("div",jt,[e.paginate_object?(s(),g(j,{key:0,onPagination_page:e.loadHinges,pagination:e.paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):l("",!0)],64))}}),At={props:["item"],data(){return{messages:[],loading:!1,form:{id:null,title:null,price:null}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price}},mounted(){this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||0}})},methods:{alert(o){this.messages.push(o)},resetForm(){this.form.id=null,this.form.title=null,this.form.price=0,this.$emit("callback")},removeMessage(o){this.messages.splice(o,1)},submit(){let o=new FormData;Object.keys(this.form).forEach(e=>{const n=this.form[e]||"";typeof n=="object"?o.append(e,JSON.stringify(n)):o.append(e,n)}),this.$store.dispatch("storeHinge",{hingeForm:o}).then(e=>{this.$emit("callback"),this.resetForm()}).catch(e=>{})}}},It={class:"form-floating mb-3"},Ot=t("label",{for:"hinge-title"},"Наименование производителя петель",-1),Pt={class:"form-floating mb-3"},Vt=t("label",{for:"hinge-title"},"Цена петель",-1),Tt={class:"row"},Nt={class:"col-12"},St={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Bt=t("strong",null,"Внимание!",-1),Mt=["onClick"],Dt={class:"row mt-5"},Ut={class:"col-12 d-flex justify-content-center"},qt=["disabled"],Et={key:0,class:"fa-regular fa-floppy-disk mr-1"},Gt={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},Jt=t("i",{class:"fa-solid fa-xmark mr-1"},null,-1);function Zt(o,e,n,r,a,d){return s(),i("form",{action:"",onSubmit:e[3]||(e[3]=w((...c)=>d.submit&&d.submit(...c),["prevent"]))},[t("div",It,[m(t("input",{type:"text","onUpdate:modelValue":e[0]||(e[0]=c=>a.form.title=c),class:"form-control",id:"hinge-title",required:""},null,512),[[p,a.form.title]]),Ot]),t("div",Pt,[m(t("input",{type:"number","onUpdate:modelValue":e[1]||(e[1]=c=>a.form.price=c),class:"form-control",id:"hinge-price",required:""},null,512),[[p,a.form.price]]),Vt]),t("div",Tt,[t("div",Nt,[a.messages.length>0?(s(!0),i(_,{key:0},k(a.messages,(c,v)=>(s(),i("div",St,[Bt,h(" "+u(c||"Ошибка")+" ",1),t("button",{type:"button",class:"btn-close",onClick:te=>d.removeMessage(v)},null,8,Mt)]))),256)):l("",!0)])]),t("div",Dt,[t("div",Ut,[t("button",{disabled:!d.needClearForm,class:"btn btn-outline-success rounded-5"},[a.loading?(s(),i("span",Gt)):(s(),i("i",Et)),h(" Сохранить производителя петель ")],8,qt),d.needClearForm&&!a.loading?(s(),i("button",{key:0,type:"button",onClick:e[2]||(e[2]=(...c)=>d.resetForm&&d.resetForm(...c)),class:"btn btn-outline-danger rounded-5 ml-2"},[Jt,h(" Очистить форму ")])):l("",!0)])])],32)}const zt=F(At,[["render",Zt]]),Kt=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Петли",-1),Qt={class:"py-12"},Rt={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Wt={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Xt={class:"p-6 text-gray-900"},Yt=t("hr",{class:"hr my-5"},null,-1),xt={data(){return{loading:!1,selectedHinge:null}},methods:{selectHinge(o){this.selectedHinge=o,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackHingeForm(){this.loading=!0,this.selectedHinge=null,this.$nextTick(()=>{this.loading=!1})}}},le=Object.assign(xt,{__name:"HingesPage",setup(o){return(e,n)=>(s(),i(_,null,[f(H(C),{title:"Петли"}),f(y,null,{header:b(()=>[Kt]),default:b(()=>[t("div",Qt,[t("div",Rt,[t("div",Wt,[t("div",Xt,[e.loading?l("",!0):(s(),g(zt,{key:0,item:e.selectedHinge,onCallback:e.callbackHingeForm},null,8,["item","onCallback"])),Yt,e.loading?l("",!0):(s(),g(Lt,{key:1,onSelect:e.selectHinge},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{le as default};
