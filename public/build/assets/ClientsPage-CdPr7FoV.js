import{v,_ as w}from"./AuthenticatedLayout-DsbX7nKY.js";import{o as l,c as n,a as s,w as $,F as p,m as y,b as h,v as m,d as u,e as d,r as f,f as g,g as b,t as _,h as C,i as q,j as U,u as V,k,Z as D}from"./app-18_fjooi.js";import{P as F}from"./Pagination-CxuXhhjE.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{_ as M}from"./UserTable-DyMBZMDw.js";import"./ApplicationLogo-4aOqyZwU.js";const S={data(){return{file:null}},methods:{onChangeFile(e){const t=e.target.files;this.file=t[0]},submit(e){let t=new FormData;t.append("file",this.file),t.append("type",e),this.$store.dispatch("updateContractTemplate",{contractTemplateForm:t}).then(o=>{e===1&&(this.$refs.doorFileContract1.value=null),e===0&&(this.$refs.doorFileContract2.value=null),this.$notify({title:"DoDoors",text:"Договор успешно загружен",type:"success"}),this.$emit("callback")}).catch(o=>{this.$notify({title:"DoDoors",text:"Ошибка загрузки договора",type:"error"})})}}},j=s("div",{class:"row"},[s("div",{class:"col-12"},[s("h6",{class:"font-bold"},"Справочная информация"),s("div",{class:"alert alert-light my-3",role:"alert"}," Ниже представлены ключи, которые подставляются в шаблоны договоров клиента. "),s("table",{class:"table"},[s("thead",null,[s("tr",null,[s("th",{scope:"col",style:{width:"30px"}},"#"),s("th",{scope:"col",style:{width:"100px"}},"Ключ"),s("th",{scope:"col"},"Описание")])]),s("tbody",null,[s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"1"),s("td",{style:{width:"100px"}},[s("strong",null,"${phone}")]),s("td",null,"Номер телефона клиента")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"2"),s("td",{style:{width:"100px"}},[s("strong",null,"${title}")]),s("td",null,"Название ООО или же ФИО индивидуального предпринимателя")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"3"),s("td",{style:{width:"100px"}},[s("strong",null,"${email}")]),s("td",null,"Почтовый адрес")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"4"),s("td",{style:{width:"100px"}},[s("strong",null,"${fact_address}")]),s("td",null,"Фактический адрес")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"5"),s("td",{style:{width:"100px"}},[s("strong",null,"${law_address}")]),s("td",null,"Юридический адрес")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"6"),s("td",{style:{width:"100px"}},[s("strong",null,"${inn}")]),s("td",null,"ИНН")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"7"),s("td",{style:{width:"100px"}},[s("strong",null,"${kpp}")]),s("td",null,"КПП")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"8"),s("td",{style:{width:"100px"}},[s("strong",null,"${ogrn}")]),s("td",null,"ОГРН")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"9"),s("td",{style:{width:"100px"}},[s("strong",null,"${okpo}")]),s("td",null,"ОКПО")]),s("tr",null,[s("th",{scope:"row",style:{width:"30px"}},"10"),s("td",{style:{width:"100px"}},[s("strong",null,"${requisites}")]),s("td",null,'Банковские реквизиты, выбранные как "по умолчанию"')])])])])],-1),A=s("div",{class:"col-12"},[s("a",{class:"mb-0 small text-red-600",href:"/orders/download-template?type=1",target:"_blank"},"Скачать текущий шаблон для ООО")],-1),B={class:"col-md-10"},I={class:"form-floating border-gray-100 border"},T=s("label",{for:"door-contract-1"},"Договор для ООО",-1),O=s("div",{class:"col-md-2"},[s("button",{class:"btn btn-dark rounded-0 w-100 h-100"},"Загрузить")],-1),P=s("div",{class:"col-12"},[s("a",{class:"mb-0 small text-red-600",href:"/orders/download-template?type=0",target:"_blank"},"Скачать текущий шаблон ИП")],-1),R={class:"col-md-10"},E={class:"form-floating border-gray-100 border"},N=s("label",{for:"door-contract-2"},"Договор для ИП",-1),G=s("div",{class:"col-md-2"},[s("button",{class:"btn btn-dark rounded-0 w-100 h-100"},"Загрузить")],-1);function J(e,t,o,a,i,r){return l(),n(p,null,[j,s("form",{onSubmit:t[1]||(t[1]=$(c=>r.submit(1),["prevent"])),class:"row mb-3"},[A,s("div",B,[s("div",I,[s("input",{type:"file",class:"form-control",accept:"doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",id:"door-contract-1",ref:"doorFileContract1",onChange:t[0]||(t[0]=(...c)=>r.onChangeFile&&r.onChangeFile(...c)),placeholder:"name@example.com",required:""},null,544),T])]),O],32),s("form",{onSubmit:t[3]||(t[3]=$(c=>r.submit(0),["prevent"])),class:"row mb-3"},[P,s("div",R,[s("div",E,[s("input",{type:"file",class:"form-control",accept:"doc,.docx,application/msword,application/vnd.openxmlformats-officedocument.wordprocessingml.document",id:"door-contract-2",ref:"doorFileContract2",onChange:t[2]||(t[2]=(...c)=>r.onChangeFile&&r.onChangeFile(...c)),placeholder:"name@example.com",required:""},null,544),N])]),G],32)],64)}const Z=L(S,[["render",J]]),z={class:"row"},H={class:"col-12"},K={class:"input-group mb-3"},Q={class:"form-floating"},W=s("label",{for:"search-clients"},"Поиск по клиентам",-1),X=s("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Y=[X],x={class:"d-flex scrollable-area py-5 mb-3"},ss={key:0,class:"table table-responsive"},ts={key:0},os=s("i",{class:"fa-solid fa-caret-down"},null,-1),es=[os],ls={key:1},ns=s("i",{class:"fa-solid fa-caret-up"},null,-1),is=[ns],rs={key:0},ds=s("i",{class:"fa-solid fa-caret-down"},null,-1),as=[ds],cs={key:1},us=s("i",{class:"fa-solid fa-caret-up"},null,-1),hs=[us],ms={key:0},_s=s("i",{class:"fa-solid fa-caret-down"},null,-1),ps=[_s],fs={key:1},bs=s("i",{class:"fa-solid fa-caret-up"},null,-1),$s=[bs],gs={key:0},ks=s("i",{class:"fa-solid fa-caret-down"},null,-1),ys=[ks],vs={key:1},ws=s("i",{class:"fa-solid fa-caret-up"},null,-1),Cs=[ws],qs={key:0},Us=s("i",{class:"fa-solid fa-caret-down"},null,-1),Vs=[Us],Ds={key:1},Fs=s("i",{class:"fa-solid fa-caret-up"},null,-1),Ls=[Fs],Ms={key:0},Ss=s("i",{class:"fa-solid fa-caret-down"},null,-1),js=[Ss],As={key:1},Bs=s("i",{class:"fa-solid fa-caret-up"},null,-1),Is=[Bs],Ts={key:0},Os=s("i",{class:"fa-solid fa-caret-down"},null,-1),Ps=[Os],Rs={key:1},Es=s("i",{class:"fa-solid fa-caret-up"},null,-1),Ns=[Es],Gs={key:0},Js=s("i",{class:"fa-solid fa-caret-down"},null,-1),Zs=[Js],zs={key:1},Hs=s("i",{class:"fa-solid fa-caret-up"},null,-1),Ks=[Hs],Qs={key:0},Ws=s("i",{class:"fa-solid fa-caret-down"},null,-1),Xs=[Ws],Ys={key:1},xs=s("i",{class:"fa-solid fa-caret-up"},null,-1),st=[xs],tt={key:0},ot=s("i",{class:"fa-solid fa-caret-down"},null,-1),et=[ot],lt={key:1},nt=s("i",{class:"fa-solid fa-caret-up"},null,-1),it=[nt],rt={key:0},dt=s("i",{class:"fa-solid fa-caret-down"},null,-1),at=[dt],ct={key:1},ut=s("i",{class:"fa-solid fa-caret-up"},null,-1),ht=[ut],mt={key:0},_t=s("i",{class:"fa-solid fa-caret-down"},null,-1),pt=[_t],ft={key:1},bt=s("i",{class:"fa-solid fa-caret-up"},null,-1),$t=[bt],gt=s("th",{scope:"col",class:"text-center"},"Действие",-1),kt={scope:"row"},yt=["onClick"],vt={class:"text-center"},wt={class:"text-center"},Ct={class:"text-center"},qt={class:"text-center"},Ut={class:"text-center"},Vt={class:"text-center"},Dt={class:"text-center"},Ft={class:"text-center"},Lt={class:"text-center"},Mt={class:"text-center"},St={class:"text-center"},jt={class:"dropdown"},At=s("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[s("i",{class:"fa-solid fa-bars"})],-1),Bt={class:"dropdown-menu"},It=["onClick"],Tt=s("i",{class:"fa-solid fa-pen mr-2"},null,-1),Ot=["onClick"],Pt=s("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Rt={key:0,class:"alert alert-success",role:"alert"},Et=s("h4",{class:"alert-heading"},"Клиенты",-1),Nt=s("p",null,"К сожалению, раздел клиентов пуст. Вы еще не добавили ни одного клиента, которых можно отобразить на этой странице.",-1),Gt=s("hr",null,null,-1),Jt=s("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте своего первого клиента",-1),Zt=[Et,Nt,Gt,Jt],zt={key:1,class:"row mb-3"},Ht={class:"col-12"},Kt={data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,statuses:[],items:[{id:null,status:null,phone:null,email:null,fact_address:null,comment:null,user_id:null,title:null,law_address:null,inn:null,kpp:null,ogrn:null,okpo:null,requisites:[]}]}},computed:{...y(["getClients","getClientsPaginateObject","getDictionary"])},mounted(){this.loadClients(),this.statuses=this.getDictionary.statuses||[]},methods:{preparedLawStatus(e){let t=this.statuses.find(o=>o.value===e)||null;return t?t.title:null},sortAndLoad(e){this.sort.column=e,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadClients(this.current_page)},loadClients(e=0){this.current_page=e,this.$store.dispatch("loadClients",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getClients,this.paginate_object=this.getClientsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(e){this.$emit("select",e)},duplicateItem(e){this.$store.dispatch("duplicateClient",{materialId:e}).then(()=>{this.sortAndLoad("id")})},removeItem(e){this.$store.dispatch("removeClient",{materialId:e}).then(()=>{this.sortAndLoad("id")})}}},Qt=Object.assign(Kt,{__name:"ClientTable",setup(e){return(t,o)=>(l(),n(p,null,[s("form",z,[s("div",H,[s("div",K,[s("div",Q,[h(s("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=a=>t.search=a),class:"form-control",id:"search-clients"},null,512),[[m,t.search]]),W]),s("button",{type:"button",onClick:o[1]||(o[1]=a=>t.sortAndLoad("id")),class:"btn btn-outline-primary"},Y)])])]),s("div",x,[t.items.length>0?(l(),n("table",ss,[s("thead",null,[s("tr",null,[s("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=a=>t.sortAndLoad("id"))},[u("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(l(),n("span",ts,es)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(l(),n("span",ls,is)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[3]||(o[3]=a=>t.sortAndLoad("title"))},[u("Название \\ ФИО "),t.sort.direction==="desc"&&t.sort.column==="title"?(l(),n("span",rs,as)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="title"?(l(),n("span",cs,hs)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[4]||(o[4]=a=>t.sortAndLoad("phone"))},[u("Телефон "),t.sort.direction==="desc"&&t.sort.column==="phone"?(l(),n("span",ms,ps)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="phone"?(l(),n("span",fs,$s)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[5]||(o[5]=a=>t.sortAndLoad("status"))},[u("Статус клиента "),t.sort.direction==="desc"&&t.sort.column==="status"?(l(),n("span",gs,ys)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="status"?(l(),n("span",vs,Cs)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[6]||(o[6]=a=>t.sortAndLoad("fact_address"))},[u("Фактический адрес "),t.sort.direction==="desc"&&t.sort.column==="fact_address"?(l(),n("span",qs,Vs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="fact_address"?(l(),n("span",Ds,Ls)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[7]||(o[7]=a=>t.sortAndLoad("law_address"))},[u("Юридический адрес "),t.sort.direction==="desc"&&t.sort.column==="law_address"?(l(),n("span",Ms,js)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="law_address"?(l(),n("span",As,Is)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[8]||(o[8]=a=>t.sortAndLoad("inn"))},[u("ИНН "),t.sort.direction==="desc"&&t.sort.column==="inn"?(l(),n("span",Ts,Ps)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="inn"?(l(),n("span",Rs,Ns)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[9]||(o[9]=a=>t.sortAndLoad("kpp"))},[u("КПП "),t.sort.direction==="desc"&&t.sort.column==="kpp"?(l(),n("span",Gs,Zs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="kpp"?(l(),n("span",zs,Ks)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[10]||(o[10]=a=>t.sortAndLoad("ogrn"))},[u("ОГРН "),t.sort.direction==="desc"&&t.sort.column==="ogrn"?(l(),n("span",Qs,Xs)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="ogrn"?(l(),n("span",Ys,st)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[11]||(o[11]=a=>t.sortAndLoad("okpo"))},[u("ОКПО "),t.sort.direction==="desc"&&t.sort.column==="okpo"?(l(),n("span",tt,et)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="okpo"?(l(),n("span",lt,it)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[12]||(o[12]=a=>t.sortAndLoad("comment"))},[u("Комментарий "),t.sort.direction==="desc"&&t.sort.column==="comment"?(l(),n("span",rt,at)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="comment"?(l(),n("span",ct,ht)):d("",!0)]),s("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[13]||(o[13]=a=>t.sortAndLoad("updated_at"))},[u(" Дата изменения "),t.sort.direction==="desc"&&t.sort.column==="updated_at"?(l(),n("span",mt,pt)):d("",!0),t.sort.direction==="asc"&&t.sort.column==="updated_at"?(l(),n("span",ft,$t)):d("",!0)]),gt])]),s("tbody",null,[(l(!0),n(p,null,f(t.items,(a,i)=>(l(),n("tr",null,[s("th",kt,_(a.id||i),1),s("td",{class:"text-center",onClick:r=>t.selectItem(a)},_(a.title||"-"),9,yt),s("td",vt,_(a.phone||"-"),1),s("td",wt,_(t.preparedLawStatus(a.status)||"-"),1),s("td",Ct,_(a.fact_address||"-"),1),s("td",qt,_(a.law_address||"-"),1),s("td",Ut,_(a.inn||"-"),1),s("td",Vt,_(a.kpp||"-"),1),s("td",Dt,_(a.ogrn||"-"),1),s("td",Ft,_(a.okpo||"-"),1),s("td",Lt,_(a.comment||"-"),1),s("td",Mt,_(a.updated_at||"-"),1),s("td",St,[s("div",jt,[At,s("ul",Bt,[s("li",null,[s("a",{class:"dropdown-item",onClick:r=>t.selectItem(a),href:"javascript:void(0)"},[Tt,u("Редактировать")],8,It)]),s("li",null,[s("a",{class:"dropdown-item text-danger",onClick:r=>t.removeItem(a.id),href:"javascript:void(0)"},[Pt,u("Удалить")],8,Ot)])])])])]))),256))])])):d("",!0)]),t.items.length===0?(l(),n("div",Rt,Zt)):d("",!0),t.items.length>0?(l(),n("div",zt,[s("div",Ht,[t.paginate_object?(l(),g(F,{key:0,onPagination_page:t.loadClients,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):d("",!0)])])):d("",!0),b(Z)],64))}}),Wt={class:"row mb-3"},Xt={class:"col-md-6 col-12"},Yt={class:"row"},xt={class:"col-md-6 col-12"},so={class:"form-floating"},to=s("option",{value:null},"Не выбрано",-1),oo=["value"],eo=s("label",{for:"status"},"Тип контрагента",-1),lo={class:"col-md-6 col-12"},no={class:"form-floating mb-3"},io=s("label",{for:"client-title"},"Наименование компании \\ Ф.И.О.",-1),ro={class:"col-12"},ao={class:"form-floating mb-3"},co={class:"form-floating"},uo=s("label",{for:"law_address"},"Юридический адрес",-1),ho={class:"col-md-6 col-12"},mo={class:"form-floating mb-3"},_o=s("label",{for:"client-email"},"Электронная почта",-1),po={class:"col-md-6 col-12"},fo={class:"form-floating mb-3"},bo=s("label",{for:"client-phone"},"Телефон",-1),$o={class:"col-md-12 col-12"},go={class:"form-floating mb-3"},ko={class:"form-floating"},yo=s("label",{for:"comment"},"Комментарий",-1),vo={class:"col-md-6 col-12 mb-3"},wo={class:"input-group"},Co={class:"form-floating"},qo=s("label",{for:"client-inn"},"ИНН",-1),Uo=["disabled"],Vo=s("i",{class:"fa-solid fa-magnifying-glass"},null,-1),Do=[Vo],Fo=["href"],Lo={class:"col-md-6 col-12"},Mo={class:"form-floating mb-3"},So=s("label",{for:"client-kpp"},"КПП",-1),jo={class:"col-md-6 col-12"},Ao={class:"form-floating mb-3"},Bo=s("label",{for:"client-ogrn"},"ОГРН",-1),Io={class:"col-md-6 col-12"},To={class:"form-floating mb-3"},Oo=s("label",{for:"client-okpo"},"ОКПО",-1),Po={class:"col-md-6 col-12 mb-3"},Ro={class:"input-group"},Eo={key:0,class:"form-control rounded-0 border-secondary"},No={key:1,class:"form-control rounded-0 border-secondary"},Go=s("label",{for:"client-user_id"},"Пользователь",-1),Jo=s("i",{class:"fa-solid fa-ban"},null,-1),Zo=[Jo],zo={class:"row"},Ho={class:"col-12 my-2"},Ko=s("i",{class:"fa-solid fa-plus mr-1"},null,-1),Qo={class:"col-md-6 col-12 mb-3"},Wo={class:"card rounded-0 border-secondary"},Xo={class:"card-header d-flex justify-between align-items-center border-secondary"},Yo={class:"form-check form-switch"},xo=["onChange","onUpdate:modelValue","id"],se=["for"],te=["onClick"],oe=s("i",{class:"fa-solid fa-xmark mr-2"},null,-1),ee={class:"card-body"},le={class:"row"},ne={class:"col-md-6 col-12"},ie={class:"input-group mb-3"},re={class:"form-floating"},de=["onUpdate:modelValue","id"],ae=["for"],ce=["disabled","onClick"],ue=s("i",{class:"fa-solid fa-magnifying-glass"},null,-1),he=[ue],me={class:"col-md-6 col-12"},_e={class:"form-floating mb-3"},pe=["onUpdate:modelValue","id"],fe=["for"],be={class:"col-md-12 col-12"},$e={class:"form-floating mb-3"},ge=["onUpdate:modelValue","id"],ke=["for"],ye={class:"col-md-6 col-12"},ve={class:"form-floating mb-3"},we=["onUpdate:modelValue","id"],Ce=["for"],qe={class:"col-md-6 col-12"},Ue={class:"form-floating"},Ve=["onUpdate:modelValue","id"],De=["for"],Fe={class:"row"},Le={class:"col-12"},Me={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Se=s("strong",null,"Внимание!",-1),je=["onClick"],Ae={class:"row mt-5"},Be={class:"col-12 d-flex justify-content-center"},Ie={class:"btn btn-dark rounded-0"},Te={key:0,class:"fa-regular fa-floppy-disk mr-1"},Oe={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},Pe=s("i",{class:"fa-solid fa-xmark mr-1"},null,-1),Re={class:"modal fade",id:"search-users",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ee={class:"modal-dialog modal-lg"},Ne={class:"modal-content rounded-0 border-secondary"},Ge=s("div",{class:"modal-header"},[s("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Поиск пользователя"),s("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Je={class:"modal-body 0"},Ze=s("div",{class:"modal-footer"},[s("button",{type:"button",class:"btn btn-outline-secondary rounded-0 border-secondary","data-bs-dismiss":"modal"},"Закрыть ")],-1),ze={components:{},directives:{mask:v.mask},props:["item"],data(){return{messages:[],userSearchModal:null,loading:!1,link_for_document:null,statuses:[],form:{id:null,status:null,phone:null,email:null,fact_address:null,comment:null,user:null,user_id:null,title:null,law_address:null,inn:null,kpp:null,ogrn:null,okpo:null,requisites:[]}}},computed:{...y(["getDictionary"])},mounted(){this.statuses=this.getDictionary.statuses||[],this.userSearchModal=new bootstrap.Modal(document.getElementById("search-users"),{}),this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,status:this.item.status||null,phone:this.item.phone||null,email:this.item.email||null,fact_address:this.item.fact_address||null,comment:this.item.comment||null,user_id:this.item.user_id||null,user:this.item.user||null,title:this.item.title||null,law_address:this.item.law_address||null,inn:this.item.inn||null,kpp:this.item.kpp||null,ogrn:this.item.ogrn||null,okpo:this.item.okpo||null,requisites:this.item.requisites||[]}})},methods:{openUserSearchModal(){this.userSearchModal.show()},requestByBik(e){this.$notify({title:"DoDoors",text:"Ищем по БИК..."}),this.$store.dispatch("requestByBik",{bik:this.form.requisites[e].bik}).then(t=>{this.form.requisites[e].bank=(t.name||"").replaceAll("&quot;","'"),this.form.requisites[e].address=t.address?(t.index||"")+", "+(t.city||"")+", "+(t.address||""):null,this.form.requisites[e].correspondent_account=t.ks||null,this.$notify({title:"DoDoors",text:"Отлично! Данные найдены",type:"success"})}).catch(t=>{this.$notify({title:"DoDoors",text:"Данные не найдено",type:"error"})})},requestByInn(){this.link_for_document=null,this.$notify({title:"DoDoors",text:"Ищем по ИНН..."}),this.$store.dispatch("requestByInn",{inn:this.form.inn}).then(e=>{this.form.title=e[0].c||null,this.form.kpp=e[0].p||null,this.form.ogrn=e[0].o||null;let t=new Date;this.link_for_document=(e[0].t||null)+`?r=${t.getTime()}&_=${t.getTime()}`,this.$notify({title:"DoDoors",text:"Отлично! Данные найдены",type:"success"})}).catch(e=>{this.$notify({title:"DoDoors",text:"Данные не найдено",type:"error"})})},changeRequisitesMain(e){this.form.requisites.forEach(t=>t.is_main=!1),this.form.requisites[e].is_main=!0},alert(e){this.messages.push(e)},removeRequisite(e){this.form.requisites.splice(e,1)},addRequisites(){this.form.requisites.push({bik:null,bank:null,address:null,correspondent_account:null,checking_account:null,is_main:!1})},selectUserId(e){this.form.user_id=e.id,this.form.user=e,this.userSearchModal.hide()},resetForm(){const e={id:null,status:null,phone:null,email:null,fact_address:null,comment:null,user_id:null,title:null,law_address:null,inn:null,kpp:null,ogrn:null,okpo:null,requisites:[]};this.form=e,this.$emit("callback")},removeMessage(e){this.messages.splice(e,1)},submit(){let e=new FormData;Object.keys(this.form).forEach(t=>{const o=this.form[t]||"";typeof o=="object"?e.append(t,JSON.stringify(o)):e.append(t,o)}),this.$store.dispatch("storeClient",{clientForm:e}).then(t=>{this.$emit("callback"),this.resetForm()}).catch(t=>{})}}},He=Object.assign(ze,{__name:"ClientForm",setup(e){return(t,o)=>{const a=C("mask");return l(),n(p,null,[s("div",Wt,[s("div",Xt,[s("button",{type:"button",class:"btn btn-dark rounded-0",onClick:o[0]||(o[0]=(...i)=>t.resetForm&&t.resetForm(...i))},"Очистить форму ")])]),s("form",{action:"",onSubmit:o[16]||(o[16]=$((...i)=>t.submit&&t.submit(...i),["prevent"]))},[s("div",Yt,[s("div",xt,[s("div",so,[h(s("select",{class:"form-select","onUpdate:modelValue":o[1]||(o[1]=i=>t.form.status=i),id:"status","aria-label":"Floating label select example"},[to,(l(!0),n(p,null,f(t.statuses,i=>(l(),n("option",{value:i.value},_(i.title||"Не указано"),9,oo))),256))],512),[[q,t.form.status]]),eo])]),s("div",lo,[s("div",no,[h(s("input",{type:"text","onUpdate:modelValue":o[2]||(o[2]=i=>t.form.title=i),class:"form-control",id:"client-title",required:""},null,512),[[m,t.form.title]]),io])]),s("div",ro,[s("div",ao,[s("div",co,[h(s("textarea",{class:"form-control rounded-0 border-secondary","onUpdate:modelValue":o[3]||(o[3]=i=>t.form.law_address=i),placeholder:"Leave a comment here",id:"law_address"},null,512),[[m,t.form.law_address]]),uo])])]),s("div",ho,[s("div",mo,[h(s("input",{type:"email","onUpdate:modelValue":o[4]||(o[4]=i=>t.form.email=i),class:"form-control",id:"client-email"},null,512),[[m,t.form.email]]),_o])]),s("div",po,[s("div",fo,[h(s("input",{type:"text","onUpdate:modelValue":o[5]||(o[5]=i=>t.form.phone=i),class:"form-control",id:"client-phone"},null,512),[[m,t.form.phone],[a,"+7(###)###-##-##"]]),bo])]),s("div",$o,[s("div",go,[s("div",ko,[h(s("textarea",{class:"form-control rounded-0 border-secondary","onUpdate:modelValue":o[6]||(o[6]=i=>t.form.comment=i),placeholder:"Leave a comment here",id:"comment"},null,512),[[m,t.form.comment]]),yo])])]),s("div",vo,[s("div",wo,[s("div",Co,[h(s("input",{type:"text","onUpdate:modelValue":o[7]||(o[7]=i=>t.form.inn=i),maxlength:"12",class:"form-control",id:"client-inn",required:""},null,512),[[m,t.form.inn]]),qo]),s("button",{type:"button",disabled:!t.form.inn,onClick:o[8]||(o[8]=(...i)=>t.requestByInn&&t.requestByInn(...i)),class:"btn btn-outline-secondary rounded-0"},Do,8,Uo)]),t.link_for_document?(l(),n("a",{key:0,href:"https://egrul.nalog.ru/vyp-download/"+t.link_for_document,target:"_blank",class:"btn btn-link my-0 py-0 px-0",style:{color:"red"}},"Скачать выписку",8,Fo)):d("",!0)]),s("div",Lo,[s("div",Mo,[h(s("input",{type:"text",maxlength:"9","onUpdate:modelValue":o[9]||(o[9]=i=>t.form.kpp=i),class:"form-control",id:"client-kpp"},null,512),[[m,t.form.kpp]]),So])]),s("div",jo,[s("div",Ao,[h(s("input",{type:"text",maxlength:"15","onUpdate:modelValue":o[10]||(o[10]=i=>t.form.ogrn=i),class:"form-control",id:"client-ogrn"},null,512),[[m,t.form.ogrn]]),Bo])]),s("div",Io,[s("div",To,[h(s("input",{type:"text","onUpdate:modelValue":o[11]||(o[11]=i=>t.form.okpo=i),maxlength:"10",class:"form-control",id:"client-okpo"},null,512),[[m,t.form.okpo]]),Oo])]),s("div",Po,[s("div",Ro,[s("div",{class:"form-floating",onClick:o[12]||(o[12]=(...i)=>t.openUserSearchModal&&t.openUserSearchModal(...i))},[t.form.user?(l(),n("p",Eo,_(t.form.user.email),1)):(l(),n("p",No,"Не выбран")),Go]),t.form.user?(l(),n("button",{key:0,type:"button",class:"btn btn-outline-secondary rounded-0",onClick:o[13]||(o[13]=i=>t.form.user=null)},Zo)):d("",!0)])])]),s("div",zo,[s("div",Ho,[s("button",{type:"button",onClick:o[14]||(o[14]=(...i)=>t.addRequisites&&t.addRequisites(...i)),class:"btn btn-dark rounded-0"},[Ko,u("Добавить расчётный счёт ")])]),(l(!0),n(p,null,f(t.form.requisites,(i,r)=>(l(),n("div",Qo,[s("div",Wo,[s("div",Xo,[s("div",Yo,[h(s("input",{class:"form-check-input",onChange:c=>t.changeRequisitesMain(r),"onUpdate:modelValue":c=>t.form.requisites[r].is_main=c,type:"checkbox",role:"switch",id:"form-requisites-checking_account"+r,checked:""},null,40,xo),[[U,t.form.requisites[r].is_main]]),s("label",{class:"form-check-label",for:"form-requisites-checking_account"+r}," Основной расчетный счёт ",8,se)]),s("a",{href:"javascript:void(0)",class:"btn btn-outline-secondary rounded-0",onClick:c=>t.removeRequisite(r)},[oe,u(" Удалить")],8,te)]),s("div",ee,[s("div",le,[s("div",ne,[s("div",ie,[s("div",re,[h(s("input",{type:"text",maxlength:"11","onUpdate:modelValue":c=>t.form.requisites[r].bik=c,class:"form-control",id:"form-requisites-bik"+r,required:""},null,8,de),[[m,t.form.requisites[r].bik]]),s("label",{for:"form-requisites-bik"+r},"БИК",8,ae)]),s("button",{type:"button",disabled:!t.form.requisites[r].bik,onClick:c=>t.requestByBik(r),class:"btn btn-outline-secondary rounded-0"},he,8,ce)])]),s("div",me,[s("div",_e,[h(s("input",{type:"text","onUpdate:modelValue":c=>t.form.requisites[r].bank=c,class:"form-control",id:"form-requisites-bank"+r},null,8,pe),[[m,t.form.requisites[r].bank]]),s("label",{for:"form-requisites-bank"+r},"Банк",8,fe)])]),s("div",be,[s("div",$e,[h(s("input",{type:"text","onUpdate:modelValue":c=>t.form.requisites[r].address=c,class:"form-control",id:"form-requisites-address"+r},null,8,ge),[[m,t.form.requisites[r].address]]),s("label",{for:"form-requisites-address"+r},"Адрес",8,ke)])]),s("div",ye,[s("div",ve,[h(s("input",{type:"text",maxlength:"20","onUpdate:modelValue":c=>t.form.requisites[r].correspondent_account=c,class:"form-control",id:"form-requisites-correspondent_account"+r},null,8,we),[[m,t.form.requisites[r].correspondent_account]]),s("label",{for:"form-requisites-correspondent_account"+r},"Кор.счёт",8,Ce)])]),s("div",qe,[s("div",Ue,[h(s("input",{type:"text","onUpdate:modelValue":c=>t.form.requisites[r].checking_account=c,maxlength:"20",class:"form-control",id:"form-requisites-checking_account"+r,required:""},null,8,Ve),[[m,t.form.requisites[r].checking_account]]),s("label",{for:"form-requisites-checking_account"+r},"Расчетный счет",8,De)])])])])])]))),256))]),s("div",Fe,[s("div",Le,[t.messages.length>0?(l(!0),n(p,{key:0},f(t.messages,(i,r)=>(l(),n("div",Me,[Se,u(" "+_(i||"Ошибка")+" ",1),s("button",{type:"button",class:"btn-close",onClick:c=>t.removeMessage(r)},null,8,je)]))),256)):d("",!0)])]),s("div",Ae,[s("div",Be,[s("button",Ie,[t.loading?(l(),n("span",Oe)):(l(),n("i",Te)),u(" Сохранить клиента ")]),t.loading?d("",!0):(l(),n("button",{key:0,type:"button",onClick:o[15]||(o[15]=(...i)=>t.resetForm&&t.resetForm(...i)),class:"btn btn-outline-secondary rounded-0 ml-2"},[Pe,u(" Очистить клиента ")]))])])],32),s("div",Re,[s("div",Ee,[s("div",Ne,[Ge,s("div",Je,[b(M,{"for-select":!0,onSelect:t.selectUserId},null,8,["onSelect"])]),Ze])])])],64)}}}),Ke=s("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Клиенты",-1),Qe={class:"py-12"},We={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Xe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Ye={class:"p-6 text-gray-900"},xe=s("hr",{class:"hr my-5"},null,-1),sl={data(){return{loading:!1,selectedClient:null}},methods:{selectClient(e){this.selectedClient=e,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackClientForm(){this.loading=!0,this.selectedClient=null,this.$nextTick(()=>{this.loading=!1})}}},rl=Object.assign(sl,{__name:"ClientsPage",setup(e){return(t,o)=>(l(),n(p,null,[b(V(D),{title:"Клиенты"}),b(w,null,{header:k(()=>[Ke]),default:k(()=>[s("div",Qe,[s("div",We,[s("div",Xe,[s("div",Ye,[t.loading?d("",!0):(l(),g(He,{key:0,item:t.selectedClient,onCallback:t.callbackClientForm},null,8,["item","onCallback"])),xe,t.loading?d("",!0):(l(),g(Qt,{key:1,onSelect:t.selectClient},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{rl as default};
