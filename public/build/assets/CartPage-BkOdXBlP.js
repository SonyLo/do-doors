import{C as F,_ as w}from"./AuthenticatedLayout-CrtMkR6K.js";import{m as y,o as i,c as a,b as t,t as c,e as r,g as p,k as C,f as m,v as u,F as b,r as v,h as P,j as g,a as f,u as D,w as k,Z as V}from"./app-DffmZpem.js";import{_ as x}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{v as q}from"./vue-the-mask-CZY2fNDe.js";import"./ApplicationLogo-B1Mbw-7k.js";const T={props:["item"],computed:{...y(["getDictionary"])},methods:{removeProduct(){this.$store.dispatch("removeProduct",this.item.product.id)},changeQuantityProductInCart(n="increment"){let e=n==="increment"?this.item.quantity+1:this.item.quantity-1;if(e===0){this.$store.dispatch("removeProduct",this.item.product.id);return}this.$store.dispatch("setQuantity",{id:this.item.product.id,quantity:e})}}},j={class:"row mb-4 d-flex justify-content-between align-items-center"},U={class:"col-md-5 col-lg-5 col-xl-5"},S={class:"text-muted font-bold"},I={class:"text-black mb-0"},B={key:0},$={key:1,class:"ml-1"},E={key:2,class:"ml-1"},M={key:3},N={key:4,class:"ml-1"},O={key:5,class:"ml-1"},Q={key:6,class:"ml-1"},L={key:7,class:"ml-1"},R={key:8,class:"ml-1"},G={key:9,class:"ml-1"},J={key:10,class:"ml-1"},K={key:11,class:"ml-1"},Z={key:12,class:"ml-1"},z={key:13,class:"ml-1"},A={key:14,class:"ml-1"},H={key:15,class:"ml-1"},W={key:16,class:"ml-1"},X={class:"col-md-3 col-lg-3 col-xl-3 d-flex"},Y=t("i",{class:"fas fa-minus"},null,-1),tt=[Y],et=["value"],ot=t("i",{class:"fas fa-plus"},null,-1),st=[ot],lt={class:"col-md-3 col-lg-2 col-xl-2 offset-lg-1"},nt={class:"mb-0"},it={class:"col-md-1 col-lg-1 col-xl-1 text-end"},at=t("i",{class:"fas fa-times"},null,-1),rt=[at];function ct(n,e,o,_,l,d){return i(),a("div",j,[t("div",U,[t("h6",S,c(o.item.product.door_type.title)+" "+c(o.item.product.width)+"x"+c(o.item.product.height)+"x"+c(o.item.product.depth),1),t("h6",I,[o.item.product.box_and_frame_color.title?(i(),a("span",B,"("+c(o.item.product.box_and_frame_color.title)+")",1)):r("",!0),p(" лицо "),o.item.product.front_side_finish.title?(i(),a("span",$,c(o.item.product.front_side_finish.title),1)):r("",!0),p("/ "),o.item.product.back_side_finish.title?(i(),a("span",E,c(o.item.product.back_side_finish.title)+",",1)):r("",!0),p(" петли "),o.item.product.loops.title?(i(),a("span",M,c(o.item.product.loops.title)+",",1)):r("",!0),o.item.product.hinge_manufacturer.title?(i(),a("span",N,c(o.item.product.hinge_manufacturer.title)+",",1)):r("",!0),o.item.product.fittings_color.title?(i(),a("span",O,"("+c(o.item.product.fittings_color.title)+"),",1)):r("",!0),o.item.product.opening_type.title?(i(),a("span",Q,c(o.item.product.opening_type.title)+",",1)):r("",!0),o.item.product.handle_holes.title?(i(),a("span",L,c(o.item.product.handle_holes.title)+",",1)):r("",!0),o.item.product.need_automatic_doorstep?(i(),a("span",R," автоматический порожек,")):r("",!0),o.item.product.need_upper_jumper?(i(),a("span",G," верхняя перемычка,")):r("",!0),o.item.product.need_handle_holes?(i(),a("span",J," дверная ручка,")):r("",!0),o.item.product.handle_holes_type.title?(i(),a("span",K,c(o.item.product.handle_holes_type.title)+",",1)):r("",!0),o.item.product.handle_holes.title?(i(),a("span",Z,c(o.item.product.handle_holes.title)+",",1)):r("",!0),o.item.product.need_hidden_door_closer?(i(),a("span",z," скрытый доводчик,")):r("",!0),o.item.product.need_hidden_skirting_board?(i(),a("span",A," скрытый плинтус,")):r("",!0),o.item.product.need_hidden_stopper?(i(),a("span",H," скрытый стопор,")):r("",!0),o.item.product.need_door_install?(i(),a("span",W," установка двери")):r("",!0)])]),t("div",X,[t("button",{class:"btn btn-outline-secondary rounded-0 px-2",type:"button",onClick:e[0]||(e[0]=h=>d.changeQuantityProductInCart("decrement"))},tt),t("input",{id:"form1",min:"0",name:"quantity",value:o.item.quantity,type:"text",readonly:"",class:"form-control form-control-sm text-center border-none rounded-md"},null,8,et),t("button",{class:"btn btn-dark rounded-0 px-2",type:"button",onClick:e[1]||(e[1]=h=>d.changeQuantityProductInCart("increment"))},st)]),t("div",lt,[t("h6",nt,c(o.item.quantity*(o.item.product.price||0))+" ₽",1)]),t("div",it,[t("a",{href:"javascript:void(0)",onClick:e[2]||(e[2]=(...h)=>d.removeProduct&&d.removeProduct(...h)),class:"text-muted"},rt)])])}const dt=x(T,[["render",ct]]),mt={directives:{mask:q.mask},computed:{...y(["getErrors","getDictionary","cartTotalCount","cartTotalPrice","cartProducts"])},watch:{"clientForm.payed_percent":{handler(n){this.clientForm.current_payed=Math.round(this.cartTotalPrice*this.clientForm.payed_percent/100)},deep:!0}},data(){return{tab:0,step:0,discount:0,self_clients:[],flgDays:!0,clientForm:{id:null,name:null,phone:null,email:null,passport:null,passport_issued:null,delivery_address:null,info:null,promo:null,work_with_nds:1,items:[],current_payed:0,payed_percent:0,delivery_terms:null,work_days:0}}},mounted(){this.loadSelfClients()},methods:{hasRoles(n){let e=!1;return typeof n=="object"?this.$page.props.auth.roles.forEach(o=>{e=e||n.includes(o)}):this.$page.props.auth.roles.includes(n),e},back(){this.$emit("back")},preparedLawStatus(n){let o=(this.getDictionary.statuses||[]).find(_=>_.value===n)||null;return o?o.title:null},selectInfo(n){if(n==null){this.clientForm.id=null,this.clientForm.name=null,this.clientForm.email=null,this.clientForm.phone=null,this.clientForm.pasport=null,this.clientForm.pasport_issued=null,this.clientForm.fact_address=null;return}this.clientForm.id=n.id||null,this.clientForm.name=n.title||null,this.clientForm.email=n.email||null,this.clientForm.phone=n.phone||null,this.clientForm.delivery_address=n.fact_address||null,this.clientForm.pasport=n.pasport||null,this.clientForm.pasport_issued=n.pasport_issued||null},clearCart(){this.$store.dispatch("clearCart").then(n=>{this.$notify({title:"DoDoors",text:"Успешно очищено",type:"success"})}).catch(n=>{this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})},findPromo(){this.discount=0,!((this.clientForm.promo||"").length<=5)&&this.$store.dispatch("findPromoCode",{code:this.clientForm.promo}).then(n=>{this.discount=n.discount||0})},loadSelfClients(){this.$store.dispatch("loadSelfClients").then(n=>{this.self_clients=n.data||[]}).catch(()=>{})},submit(){this.clientForm.items=this.cartProducts;let n=new FormData;Object.keys(this.clientForm).forEach(e=>{const o=this.clientForm[e]||"";typeof o=="object"?n.append(e,JSON.stringify(o)):n.append(e,o)}),n.append("total_price",this.cartTotalPrice),n.append("total_count",this.cartTotalCount),this.$store.dispatch("checkoutItems",{clientForm:n}).then(e=>{this.step=0,this.$store.dispatch("clearCart"),this.clientForm={name:null,phone:null,email:null,info:null},this.$notify({title:"DoDoors",text:"Заказ передан менеджеру!",type:"success"})}).catch(e=>{this.$notify({title:"DoDoors",text:"Ошибочка...",type:"error"})})}}},ut={class:"input-group mb-3"},_t={class:"form-floating"},ht=t("label",{for:"checkout-name"},"Ваше Ф.И.О.",-1),pt={key:0,class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},ft=t("i",{class:"fa-solid fa-up-right-and-down-left-from-center"},null,-1),bt=[ft],yt={class:"dropdown-menu dropdown-menu-end rounded-0"},kt=t("li",null,[t("hr",{class:"dropdown-divider"})],-1),vt=["onClick"],gt={class:"form-floating mb-3"},xt=t("label",{for:"checkout-phone"},"Ваш номер телефона",-1),Ft={class:"form-floating mb-3"},wt=t("label",{for:"checkout-email"},"Ваш email",-1),Ct={class:"form-floating mb-3"},Pt=t("label",{for:"checkout-email"},"Паспорт",-1),Dt={class:"form-floating mb-3"},Vt=t("label",{for:"checkout-email"},"Выдан",-1),qt={class:"form-floating mb-3"},Tt=t("label",{for:"checkout-email"},"Адрес доставки",-1),jt={class:"form-floating mb-3"},Ut=t("label",{for:"checkout-email"},"Дополнительная информация",-1),St=t("hr",{class:"hr hr-blurry my-3"},null,-1),It={class:"font-bold"},Bt={key:0},$t=t("p",{class:"mb-2"},[t("small",null,"Возможно в рассрочку!")],-1),Et=t("p",{class:"mb-2",style:{"line-height":"80%"}},[t("small",null,"От цвета шпона или цвета покраски стекла цена не зависит, просто уточните эти детали в беседе с менеджером")],-1),Mt={class:"form-floating mb-3"},Nt=t("label",{for:"checkout-promo"},"Промокод",-1),Ot={key:0},Qt={class:"form-floating mb-3"},Lt=t("label",{for:"checkout-name"},"Начальная внесенная покупателем сумма, руб",-1),Rt={class:"form-floating mb-3"},Gt=t("label",{for:"checkout-name"},"Процент внесенной суммы от полной стоимости",-1),Jt={class:"form-check form-switch"},Kt=t("label",{class:"form-check-label",for:"flexSwitchCheckDefault"},"Указать кол-во рабочих дней / Выбрать конкретную дату",-1),Zt={key:0,class:"form-floating mb-3"},zt=t("label",{for:"checkout-name"},"Кол-во рабочих дней",-1),At={key:1,class:"form-floating mb-3"},Ht=t("label",{for:"checkout-name"},"Срок передачи товара покупателю",-1),Wt=t("button",{class:"btn btn-dark w-100 my-2 rounded-0"},"Отправить и скачать договор",-1),Xt={key:1,class:"btn btn-dark w-100 my-2 rounded-0"},Yt={key:1,class:"card rounded-0"},te=t("div",{class:"card-body"},[t("p",null,"Вы должны добавить в корзину хотя бы одно изделие")],-1),ee=[te];function oe(n,e,o,_,l,d){const h=C("mask");return n.cartTotalCount>0?(i(),a("form",{key:0,onSubmit:e[17]||(e[17]=g((...s)=>d.submit&&d.submit(...s),["prevent"]))},[t("div",ut,[t("div",_t,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[0]||(e[0]=s=>l.clientForm.name=s),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[u,l.clientForm.name]]),ht]),l.self_clients.length>0?(i(),a("button",pt,bt)):r("",!0),t("ul",yt,[t("li",null,[t("a",{class:"dropdown-item",onClick:e[1]||(e[1]=s=>d.selectInfo(null)),href:"javascript:void(0)"},"Не выбрано")]),kt,t("li",null,[(i(!0),a(b,null,v(l.self_clients,s=>(i(),a(b,null,[s.status=="individual"||s.status=="new_client"?(i(),a("a",{key:0,class:"dropdown-item",href:"javascript:void(0)",onClick:qe=>d.selectInfo(s)},c(s.title||null)+" ("+c(d.preparedLawStatus(s.status)||"Не указан")+")",9,vt)):r("",!0)],64))),256))])])]),t("div",gt,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[2]||(e[2]=s=>l.clientForm.phone=s),id:"checkout-phone",placeholder:"name@example.com",required:""},null,512),[[h,"+7(###)###-##-##"],[u,l.clientForm.phone]]),xt]),t("div",Ft,[m(t("input",{type:"email",class:"form-control","onUpdate:modelValue":e[3]||(e[3]=s=>l.clientForm.email=s),id:"checkout-email",placeholder:"name@example.com",required:""},null,512),[[u,l.clientForm.email]]),wt]),t("div",Ct,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[4]||(e[4]=s=>l.clientForm.passport=s),id:"checkout-email",placeholder:"name@example.com"},null,512),[[h,"## ##  ######"],[u,l.clientForm.passport]]),Pt]),t("div",Dt,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[5]||(e[5]=s=>l.clientForm.passport_issued=s),id:"checkout-email",placeholder:"name@example.com"},null,512),[[u,l.clientForm.passport_issued]]),Vt]),t("div",qt,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[6]||(e[6]=s=>l.clientForm.delivery_address=s),id:"checkout-email",placeholder:"name@example.com",required:""},null,512),[[u,l.clientForm.delivery_address]]),Tt]),t("div",jt,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[7]||(e[7]=s=>l.clientForm.info=s),id:"checkout-email",placeholder:"name@example.com"},null,512),[[u,l.clientForm.info]]),Ut]),St,t("h6",It,[p("Итого цена "+c(Math.round(n.cartTotalPrice*(1-l.discount/100)))+" ₽ ",1),l.discount>0?(i(),a("span",Bt,"(скидка "+c(l.discount)+"%)",1)):r("",!0)]),$t,Et,t("div",Mt,[m(t("input",{type:"text",class:"form-control",onKeyup:e[8]||(e[8]=(...s)=>d.findPromo&&d.findPromo(...s)),"onUpdate:modelValue":e[9]||(e[9]=s=>l.clientForm.promo=s),id:"checkout-promo",placeholder:"name@example.com"},null,544),[[u,l.clientForm.promo]]),Nt]),d.hasRoles(["manager","administrator"])?(i(),a("div",Ot,[p(c(l.clientForm.client)+" ",1),t("div",Qt,[m(t("input",{disabled:"",type:"text",class:"form-control","onUpdate:modelValue":e[10]||(e[10]=s=>l.clientForm.current_payed=s),id:"checkout-name",placeholder:"",required:""},null,512),[[u,l.clientForm.current_payed]]),Lt]),t("div",Rt,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[11]||(e[11]=s=>l.clientForm.payed_percent=s),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[u,l.clientForm.payed_percent]]),Gt]),t("div",Jt,[m(t("input",{onClick:e[12]||(e[12]=s=>l.flgDays=!l.flgDays),"onUpdate:modelValue":e[13]||(e[13]=s=>l.flgDays=s),class:"form-check-input",type:"checkbox",role:"switch",id:""},null,512),[[P,l.flgDays]]),Kt]),l.flgDays?(i(),a("div",Zt,[m(t("input",{type:"text",class:"form-control","onUpdate:modelValue":e[14]||(e[14]=s=>l.clientForm.work_days=s),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[u,l.clientForm.work_days]]),zt])):(i(),a("div",At,[m(t("input",{type:"date",class:"form-control","onUpdate:modelValue":e[15]||(e[15]=s=>l.clientForm.delivery_terms=s),id:"checkout-name",placeholder:"name@example.com",required:""},null,512),[[u,l.clientForm.delivery_terms]]),Ht])),Wt])):(i(),a("button",Xt,"Отправить")),t("button",{type:"button",class:"btn btn-outline-secondary w-100 rounded-0",onClick:e[16]||(e[16]=(...s)=>d.back&&d.back(...s))},"Назад ")],32)):(i(),a("div",Yt,ee))}const se=x(mt,[["render",oe]]),le={class:"container h-100"},ne={class:"col-lg-8"},ie={class:"p-5"},ae={class:"d-flex justify-content-between align-items-center mb-5"},re=t("h1",{class:"fw-bold mb-0 text-black"},"Позиций товаров в корзине",-1),ce={class:"mb-0 text-muted"},de=t("hr",{class:"my-4"},null,-1),me=t("hr",{class:"my-4"},null,-1),ue={class:"pt-5"},_e={class:"mb-0"},he=t("i",{class:"fas fa-long-arrow-alt-left me-2"},null,-1),pe={class:"col-lg-4 bg-grey"},fe=t("ul",{class:"nav nav-tabs mb-3",id:"legal-or-individual-tab",role:"tablist"},[t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link active",id:"home-tab","data-bs-toggle":"tab","data-bs-target":"#legal_entity-tab-pane",type:"button",role:"tab","aria-controls":"legal_entity-tab-pane","aria-selected":"true"},"Юридическое лицо")]),t("li",{class:"nav-item",role:"presentation"},[t("button",{class:"nav-link",id:"profile-tab","data-bs-toggle":"tab","data-bs-target":"#individual-tab-pane",type:"button",role:"tab","aria-controls":"profile-tab-pane","aria-selected":"false"},"Физическое лицо")])],-1),be={class:"tab-content",id:"legal-or-individual-tabContent"},ye={class:"tab-pane fade show active",id:"legal_entity-tab-pane",role:"tabpanel","aria-labelledby":"legal_entity"},ke={class:"tab-pane fade show",id:"individual-tab-pane",role:"tabpanel","aria-labelledby":"legal_entity"},ve={computed:{...y(["getErrors","cartTotalCount","cartProducts","cartTotalPrice"])},methods:{goToCheckout(){this.$emit("callback")},back(){window.location="/dashboard"}}},ge=Object.assign(ve,{__name:"CartForm",setup(n){return(e,o)=>(i(),a("div",le,[t("form",{onSubmit:o[1]||(o[1]=g((..._)=>e.goToCheckout&&e.goToCheckout(..._),["prevent"])),class:"row g-0"},[t("div",ne,[t("div",ie,[t("div",ae,[re,t("h6",ce,c((e.cartProducts||[]).length)+" ед.",1)]),de,(i(!0),a(b,null,v(e.cartProducts,_=>(i(),a("div",null,[f(dt,{item:_},null,8,["item"]),me]))),256)),t("div",ue,[t("h6",_e,[t("a",{onClick:o[0]||(o[0]=(..._)=>e.back&&e.back(..._)),href:"javascript:void(0)",class:"text-body"},[he,p("К калькулятору")])])])])]),t("div",pe,[fe,t("div",be,[t("div",ye,[f(F,{onBack:e.back},null,8,["onBack"])]),t("div",ke,[f(se,{onBack:e.back},null,8,["onBack"])])])])],32)]))}}),xe=t("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Корзина",-1),Fe={class:"py-12"},we={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},Ce={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},Pe={key:0,class:"p-6 text-gray-900"},De={key:1,class:"p-6 text-gray-900"},Ve={data(){return{tab:0}}},Be=Object.assign(Ve,{__name:"CartPage",setup(n){return(e,o)=>(i(),a(b,null,[f(D(V),{title:"Калькулятор"}),f(w,null,{header:k(()=>[xe]),default:k(()=>[t("div",Fe,[t("div",we,[t("div",Ce,[e.tab===0?(i(),a("div",Pe,[f(ge,{onCallback:o[0]||(o[0]=_=>e.tab++)})])):r("",!0),e.tab===1?(i(),a("div",De)):r("",!0)])])])]),_:1})],64))}});export{Be as default};
