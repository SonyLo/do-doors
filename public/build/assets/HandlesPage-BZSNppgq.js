import{_ as F}from"./AuthenticatedLayout-BF5q2yhP.js";import{k as C,o as i,c as r,b as e,f as h,v as p,n as w,e as a,F as _,r as b,i as m,j as y,a as v,t as u,m as H,d as g,l as j,p as f,u as x,w as $,Z as I}from"./app-CVZ-3-e_.js";import{P as M}from"./Pagination-D2K4Aw9P.js";import{R as S}from"./RalColorSelector-9o_Ne2n4.js";import{H as D}from"./HandleDetail-C79hdR8H.js";import{_ as E}from"./_plugin-vue_export-helper-DlAUqK2U.js";import"./ApplicationLogo-BVqzOZzU.js";import"./vue-the-mask-CRw-LUie.js";const G={class:"form-floating mb-3"},L=e("label",{for:"handle-title"},"Название ручки",-1),U={class:"card rounded-0 mb-3 border-black"},V=e("div",{class:"card-header bg-dark text-white rounded-0"},[e("h6",null,"Настройка цены")],-1),O={class:"card-body"},P={class:"row"},T={class:"col-6"},A={class:"form-floating mb-3"},N=e("label",{for:"price-wholesale"},"Опт",-1),R={class:"col-6"},q={class:"form-floating mb-3"},B=e("label",{for:"price-retail"},"Розница",-1),z={class:"col-6"},J={class:"form-floating"},W=e("label",{for:"price-dealer"},"Дилер",-1),Z={class:"col-6"},K={class:"form-floating"},Q=e("label",{for:"price-cost"},"Себестоимость",-1),X={class:"input-group mb-3"},Y={class:"form-floating"},ee=e("label",{for:"fittings_color"},[e("i",{class:"fa-solid fa-palette"}),m(" Цвет ручки")],-1),te=e("button",{class:"btn btn-outline-secondary",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),oe={class:"dropdown-menu dropdown-menu-end"},se=e("li",null,[e("hr",{class:"dropdown-divider"})],-1),le={class:"form-floating mb-3 border-gray-100 border"},ie=e("label",{for:"door-handle"},"Вариант ручки",-1),ne={class:"row"},re={key:0,class:"col-12"},ae=e("h6",{class:"font-bold my-3"},"Новые фотографии к ручке",-1),de=[ae],ce={class:"col-md-4 mb-2 image-preview d-flex align-items-start"},me={class:"card w-100 rounded-0"},he={style:{"min-height":"200px"},class:"card-img-top uploaded-image-mini",alt:""},pe={class:"card-body d-flex justify-center"},ue=["onClick"],_e={class:"card-body"},fe={class:"form-floating mb-2"},ge=["onUpdate:modelValue"],be=e("label",{for:"floatingInput"},"Название",-1),ve={class:"form-floating"},ye=["onUpdate:modelValue"],$e=e("label",{for:"floatingTextarea"},"Описание",-1),we={key:2,class:"col-12"},ke=e("h6",{class:"font-bold my-3"},"Ранее загруженные фотографии к ручке",-1),Fe=[ke],Ce={class:"col-md-4 mb-2 image-preview d-flex align-items-start"},He={class:"card w-100"},je={style:{"min-height":"200px"},class:"card-img-top uploaded-image-mini",alt:""},xe={class:"card-body d-flex justify-center"},Ie=["onClick"],Me={class:"card-body"},Se={class:"form-floating mb-3"},De=["onUpdate:modelValue"],Ee=e("label",{for:"floatingInput"},"Название",-1),Ge={class:"form-floating"},Le=["onUpdate:modelValue"],Ue=e("label",{for:"floatingTextarea"},"Описание",-1),Ve={class:"row"},Oe={class:"col-12"},Pe={class:"alert alert-danger alert-dismissible fade show",role:"alert"},Te=e("strong",null,"Внимание!",-1),Ae=["onClick"],Ne={class:"row mt-5"},Re={class:"col-12 d-flex justify-content-center"},qe=["disabled"],Be={key:0,class:"fa-regular fa-floppy-disk mr-1"},ze={key:1,class:"spinner-border spinner-border-sm text-success",role:"status"},Je=e("i",{class:"fa-solid fa-xmark mr-1"},null,-1),We={class:"modal fade",id:"choose-color-handle",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ze={class:"modal-dialog"},Ke={class:"modal-content"},Qe=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Выбор цвета RAL"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Xe={class:"modal-body"},Ye={props:["item"],data(){return{messages:[],need_import_from_google:!1,uploaded_variants_image:[],loading:!1,colorModal:null,form:{id:null,title:null,price:{wholesale:0,dealer:0,retail:0,cost:0},color:null,variants:[]}}},computed:{needClearForm(){return this.form.id||this.form.title||this.form.price||this.form.color||this.uploaded_variants_image.length>0}},mounted(){this.colorModal=new bootstrap.Modal(document.getElementById("choose-color-handle"),{}),this.item&&this.$nextTick(()=>{this.form={id:this.item.id||null,title:this.item.title||null,price:this.item.price||{wholesale:0,dealer:0,retail:0,cost:0},color:this.item.color||null,variants:this.item.variants||[]}})},methods:{prepareImage(s){return typeof s!="string"||!s.trim()?"/images/default.png":s.startsWith("http://")||s.startsWith("https://")?s:`/images/${s}`},callbackSelectColor(s){this.form.color=s.color.hex,this.colorModal.hide()},selectColor(){this.colorModal.show()},isHex(s){return/^#[0-9A-F]{6}$/i.test(s)},alert(s){this.messages.push(s)},resetForm(){this.uploaded_variants_image=[],this.form.id=null,this.form.title=null,this.form.price={wholesale:0,dealer:0,retail:0,cost:0},this.form.color=null,this.form.variants=[],this.$refs.handleImageRef.value=null,this.$emit("callback")},removeUploadedPhoto(s,t){this.form[s].splice(t,1)},removePhoto(s,t){this[s].splice(t,1)},getPhoto(s){return{imageUrl:URL.createObjectURL(s)}},onChangePhotos(s,t){const o=t.target.files;for(let n=0;n<o.length;n++)this[s].push({image:o[n],title:null,description:null})},removeMessage(s){this.messages.splice(s,1)},submit(){let s=new FormData;if(Object.keys(this.form).forEach(t=>{const o=this.form[t]||"";typeof o=="object"?s.append(t,JSON.stringify(o)):s.append(t,o)}),this.uploaded_variants_image.length>0){for(let t=0;t<this.uploaded_variants_image.length;t++)s.append("uploaded_variants_image[]",this.uploaded_variants_image[t].image),this.uploaded_variants_image[t].image_name=this.uploaded_variants_image[t].image.name||null;s.append("uploaded_image_info",JSON.stringify(this.uploaded_variants_image))}this.$store.dispatch("storeHandle",{handleForm:s}).then(t=>{this.$store.dispatch("updatedFormattedSizes").then(o=>{window.dispatchEvent(new CustomEvent("load-sizes",{detail:null})),window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.$notify({title:"DoDoors",text:"Вы успешно обновили данные"})}),this.$emit("callback"),this.resetForm()}).catch(t=>{})},importFromGoogleSubmit(){let s=new FormData;localStorage.setItem("google_excel_handles_export_sheet_id",this.importGoogleForm.sheet_id),this.timer=0;let t=setInterval(()=>{this.timer++},1e3);Object.keys(this.importGoogleForm).forEach(o=>{const n=this.importGoogleForm[o]||"";typeof n=="object"?s.append(o,JSON.stringify(n)):s.append(o,n)}),this.$store.dispatch("importHandlesFromGoogle",{importForm:s}).then(o=>{window.open(o.url,"_blank").focus(),window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})},importSubmit(){let s=new FormData;this.timer=0;let t=setInterval(()=>{this.timer++},1e3);if(Object.keys(this.importForm).forEach(o=>{const n=this.importForm[o]||"";typeof n=="object"?s.append(o,JSON.stringify(n)):s.append(o,n)}),this.importForm.files.length>0){s.delete("files");for(let o=0;o<this.importForm.files.length;o++)s.append("files[]",this.importForm.files[o])}this.$store.dispatch("importHandlesFromExcel",{importForm:s}).then(o=>{window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})}}},k=Object.assign(Ye,{__name:"HandleForm",setup(s){return(t,o)=>{const n=C("lazy");return i(),r(_,null,[e("form",{action:"",onSubmit:o[11]||(o[11]=y((...l)=>t.submit&&t.submit(...l),["prevent"]))},[e("div",G,[h(e("input",{type:"text","onUpdate:modelValue":o[0]||(o[0]=l=>t.form.title=l),class:"form-control",id:"handle-title",required:""},null,512),[[p,t.form.title]]),L]),e("div",U,[V,e("div",O,[e("div",P,[e("div",T,[e("div",A,[h(e("input",{type:"number","onUpdate:modelValue":o[1]||(o[1]=l=>t.form.price.wholesale=l),class:"form-control",id:"price-wholesale",required:""},null,512),[[p,t.form.price.wholesale]]),N])]),e("div",R,[e("div",q,[h(e("input",{type:"number","onUpdate:modelValue":o[2]||(o[2]=l=>t.form.price.retail=l),class:"form-control",id:"price-retail",required:""},null,512),[[p,t.form.price.retail]]),B])]),e("div",z,[e("div",J,[h(e("input",{type:"number","onUpdate:modelValue":o[3]||(o[3]=l=>t.form.price.dealer=l),class:"form-control",id:"price-dealer",required:""},null,512),[[p,t.form.price.dealer]]),W])]),e("div",Z,[e("div",K,[h(e("input",{type:"number","onUpdate:modelValue":o[4]||(o[4]=l=>t.form.price.cost=l),class:"form-control",id:"price-cost",required:""},null,512),[[p,t.form.price.cost]]),Q])])])])]),e("div",X,[t.isHex(t.form.color)?(i(),r("span",{key:0,class:"input-group-text border-secondary rounded-0",style:w([{"background-color":t.form.color},{width:"40px"}]),id:"basic-addon1"},null,4)):a("",!0),e("div",Y,[h(e("input",{type:"text",onInvalid:o[5]||(o[5]=l=>t.alert("Вы не выбрали цвет фурнитуры")),"onUpdate:modelValue":o[6]||(o[6]=l=>t.form.color=l),class:"form-control",id:"fittings_color",required:""},null,544),[[p,t.form.color]]),ee]),te,e("ul",oe,[e("li",null,[e("a",{class:"dropdown-item",href:"#",onClick:o[7]||(o[7]=l=>t.form.color=null)},"Не выбрано")]),se,e("li",null,[e("a",{class:"dropdown-item",onClick:o[8]||(o[8]=(...l)=>t.selectColor&&t.selectColor(...l)),href:"javascript:void(0)"},"Цвет RAL")])])]),e("div",le,[e("input",{type:"file",class:"form-control",accept:"image/*",id:"door-handle",ref:"handleImageRef",onChange:o[9]||(o[9]=l=>t.onChangePhotos("uploaded_variants_image",l)),multiple:""},null,544),ie]),e("div",ne,[t.uploaded_variants_image.length>0?(i(),r("div",re,de)):a("",!0),t.uploaded_variants_image.length>0?(i(!0),r(_,{key:1},b(t.uploaded_variants_image,(l,c)=>(i(),r("div",ce,[e("div",me,[h(e("img",he,null,512),[[n,t.getPhoto(l.image).imageUrl]]),e("div",pe,[e("a",{href:"javascript:void(0)",class:"text-danger",onClick:d=>t.removePhoto("uploaded_variants_image",c)},"Удалить фото",8,ue)]),e("div",_e,[e("div",fe,[h(e("input",{type:"text","onUpdate:modelValue":d=>t.uploaded_variants_image[c].title=d,class:"form-control border-gray-300 rounded-0",id:"floatingInput",required:""},null,8,ge),[[p,t.uploaded_variants_image[c].title]]),be]),e("div",ve,[h(e("textarea",{class:"form-control rounded-0","onUpdate:modelValue":d=>t.uploaded_variants_image[c].description=d,placeholder:"Leave a comment here",id:"floatingTextarea",required:""},null,8,ye),[[p,t.uploaded_variants_image[c].description]]),$e])])])]))),256)):a("",!0),t.form.variants.length>0?(i(),r("div",we,Fe)):a("",!0),(i(!0),r(_,null,b(t.form.variants,(l,c)=>(i(),r("div",Ce,[e("div",He,[h(e("img",je,null,512),[[n,t.prepareImage(l.image)]]),e("div",xe,[e("a",{href:"javascript:void(0)",class:"text-danger",onClick:d=>t.removeUploadedPhoto("variants",c)},"Удалить",8,Ie)]),e("div",Me,[e("div",Se,[h(e("input",{type:"text","onUpdate:modelValue":d=>t.form.variants[c].title=d,class:"form-control border-gray-300 rounded-md",id:"floatingInput"},null,8,De),[[p,t.form.variants[c].title]]),Ee]),e("div",Ge,[h(e("textarea",{class:"form-control","onUpdate:modelValue":d=>t.form.variants[c].description=d,placeholder:"Leave a comment here",id:"floatingTextarea"},null,8,Le),[[p,t.form.variants[c].description]]),Ue])])])]))),256))]),e("div",Ve,[e("div",Oe,[t.messages.length>0?(i(!0),r(_,{key:0},b(t.messages,(l,c)=>(i(),r("div",Pe,[Te,m(" "+u(l||"Ошибка")+" ",1),e("button",{type:"button",class:"btn-close",onClick:d=>t.removeMessage(c)},null,8,Ae)]))),256)):a("",!0)])]),e("div",Ne,[e("div",Re,[e("button",{disabled:!t.needClearForm,class:"btn btn-dark rounded-0"},[t.loading?(i(),r("span",ze)):(i(),r("i",Be)),m(" Сохранить ручку ")],8,qe),t.needClearForm&&!t.loading?(i(),r("button",{key:0,type:"button",onClick:o[10]||(o[10]=(...l)=>t.resetForm&&t.resetForm(...l)),class:"btn btn-outline-secondary rounded-0 ml-2"},[Je,m(" Очистить форму ")])):a("",!0)])])],32),e("div",We,[e("div",Ze,[e("div",Ke,[Qe,e("div",Xe,[v(S,{onSelect:t.callbackSelectColor},null,8,["onSelect"])])])])])],64)}}}),et={class:"row"},tt={class:"col-12"},ot={class:"input-group mb-3"},st={class:"form-floating"},lt=e("label",{for:"search-handles"},"Поиск по ручкам",-1),it=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),nt=[it],rt={style:{"overflow-y":"auto"}},at={key:0,class:"table"},dt={key:0},ct=e("i",{class:"fa-solid fa-caret-down"},null,-1),mt=[ct],ht={key:1},pt=e("i",{class:"fa-solid fa-caret-up"},null,-1),ut=[pt],_t=e("th",{scope:"col",class:"text-center"},"Действие",-1),ft={key:0},gt=e("i",{class:"fa-solid fa-caret-down"},null,-1),bt=[gt],vt={key:1},yt=e("i",{class:"fa-solid fa-caret-up"},null,-1),$t=[yt],wt={key:0},kt=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ft=[kt],Ct={key:1},Ht=e("i",{class:"fa-solid fa-caret-up"},null,-1),jt=[Ht],xt=j('<table class="w-100"><thead><th style="width:100px;">опт</th><th style="width:100px;">дилер</th><th style="width:100px;">розница</th><th style="width:100px;">себестоимость</th></thead></table>',1),It={key:0},Mt=e("i",{class:"fa-solid fa-caret-down"},null,-1),St=[Mt],Dt={key:1},Et=e("i",{class:"fa-solid fa-caret-up"},null,-1),Gt=[Et],Lt=e("th",{scope:"col",class:"text-center"},"Изображения к ручке",-1),Ut={scope:"row"},Vt={class:"text-center"},Ot={class:"dropdown"},Pt=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),Tt={class:"dropdown-menu"},At=["onClick"],Nt=e("i",{class:"fa-solid fa-info mr-2"},null,-1),Rt=["onClick"],qt=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Bt=["onClick"],zt=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Jt=["onClick"],Wt={class:"text-center"},Zt={class:"w-100"},Kt={style:{width:"100px","text-align":"center"}},Qt={style:{width:"100px","text-align":"center"}},Xt={style:{width:"100px","text-align":"center"}},Yt={style:{width:"100px","text-align":"center"}},eo={class:"text-center"},to={class:"d-flex justify-center flex-column align-items-center"},oo={class:"text-center"},so={key:0,class:"alert alert-success",role:"alert"},lo=e("h4",{class:"alert-heading"},"Ручки",-1),io=e("p",null,"К сожалению, раздел ручек пуст. Вы еще не добавили ни одной ручки, которые можно отобразить на этой странице.",-1),no=e("hr",null,null,-1),ro=e("p",{class:"mb-0"},"Воспользуйтесь формой выше и добавьте свою первую ручку",-1),ao=[lo,io,no,ro],co={key:1,class:"row mb-3"},mo={class:"col-12"},ho={class:"modal fade",id:"show-current-handle-details",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},po={class:"modal-dialog"},uo={class:"modal-content"},_o=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Просмотр деталей"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),fo={class:"modal-body"},go={class:"modal fade",id:"handle-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},bo={class:"modal-dialog modal-lg"},vo={class:"modal-content rounded-0"},yo={class:"modal-body"},$o={data(){return{editor_modal:null,selected_item:null,selectedHandle:null,detailsModal:null,sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0,variants:[]}]}},computed:{...H(["getHandles","getHandlesPaginateObject"])},mounted(){this.loadHandles(),window.addEventListener("load-handles",()=>{this.loadHandles()}),this.editor_modal=new bootstrap.Modal(document.getElementById("handle-editor-modal"),{}),this.detailsModal=new bootstrap.Modal(document.getElementById("show-current-handle-details"),{})},methods:{showDetails(s){this.selectedHandle=null,this.$nextTick(()=>{this.selectedHandle=s,this.detailsModal.show()})},isHex(s){return/^#[0-9A-F]{6}$/i.test(s)},sortAndLoad(s){this.sort.column=s,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadHandles(this.current_page)},loadHandles(s=0){this.current_page=s,this.$store.dispatch("loadHandles",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getHandles,this.paginate_object=this.getHandlesPaginateObject}).catch(()=>{this.loading=!1})},selectItem(s){if(s==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=s,this.editor_modal.show()})},duplicateItem(s){this.$store.dispatch("duplicateHandle",{handleId:s}).then(()=>{this.sortAndLoad("id")})},removeItem(s){this.$store.dispatch("removeHandle",{handleId:s}).then(()=>{this.sortAndLoad("id")})}}},wo=Object.assign($o,{__name:"HandleTable",setup(s){return(t,o)=>(i(),r(_,null,[e("form",et,[e("div",tt,[e("div",ot,[e("div",st,[h(e("input",{type:"search","onUpdate:modelValue":o[0]||(o[0]=n=>t.search=n),class:"form-control",id:"search-handles"},null,512),[[p,t.search]]),lt]),e("button",{type:"button",onClick:o[1]||(o[1]=n=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},nt)])])]),e("div",rt,[t.items.length>0?(i(),r("table",at,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:o[2]||(o[2]=n=>t.sortAndLoad("id"))},[m("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(i(),r("span",dt,mt)):a("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(i(),r("span",ht,ut)):a("",!0)]),_t,e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[3]||(o[3]=n=>t.sortAndLoad("title"))},[m("Название "),t.sort.direction==="desc"&&t.sort.column==="title"?(i(),r("span",ft,bt)):a("",!0),t.sort.direction==="asc"&&t.sort.column==="title"?(i(),r("span",vt,$t)):a("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[4]||(o[4]=n=>t.sortAndLoad("price"))},[m("Цена, ₽ "),t.sort.direction==="desc"&&t.sort.column==="price"?(i(),r("span",wt,Ft)):a("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(i(),r("span",Ct,jt)):a("",!0),xt]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:o[5]||(o[5]=n=>t.sortAndLoad("color"))},[m("Цвет "),t.sort.direction==="desc"&&t.sort.column==="color"?(i(),r("span",It,St)):a("",!0),t.sort.direction==="asc"&&t.sort.column==="color"?(i(),r("span",Dt,Gt)):a("",!0)]),Lt])]),e("tbody",null,[(i(!0),r(_,null,b(t.items,(n,l)=>(i(),r("tr",null,[e("th",Ut,u(n.id||l),1),e("td",Vt,[e("div",Ot,[Pt,e("ul",Tt,[e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.showDetails(n),href:"javascript:void(0)"},[Nt,m("Детали")],8,At)]),e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItem(n),href:"javascript:void(0)"},[qt,m("Редактировать")],8,Rt)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(n.id),href:"javascript:void(0)"},[zt,m("Удалить")],8,Bt)])])])]),e("td",{class:"text-center",onClick:c=>t.selectItem(n)},u(n.title||"-"),9,Jt),e("td",Wt,[e("table",Zt,[e("tbody",null,[e("tr",null,[e("td",Kt,u(t.items[l].price.wholesale||0),1),e("td",Qt,u(t.items[l].price.dealer||0),1),e("td",Xt,u(t.items[l].price.retail||0),1),e("td",Yt,u(t.items[l].price.cost||0),1)])])])]),e("td",eo,[e("div",to,[e("p",null,u(n.color??"-"),1),t.isHex(n.color)?(i(),r("span",{key:0,class:"d-block shadow-md mt-1",style:w([{"background-color":n.color},{width:"50px",height:"50px"}])},null,4)):a("",!0)])]),e("td",oo,u(n.variants.length),1)]))),256))])])):a("",!0)]),t.items.length===0?(i(),r("div",so,ao)):a("",!0),t.items.length>0?(i(),r("div",co,[e("div",mo,[t.paginate_object?(i(),g(M,{key:0,onPagination_page:t.loadHandles,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):a("",!0)])])):a("",!0),e("div",ho,[e("div",po,[e("div",uo,[_o,e("div",fo,[t.selectedHandle?(i(),g(D,{key:0,"selected-handle":t.selectedHandle},null,8,["selected-handle"])):a("",!0)])])])]),e("div",go,[e("div",bo,[e("div",vo,[e("div",yo,[t.selected_item?(i(),g(k,{key:0,item:t.selected_item,onCallback:o[6]||(o[6]=n=>t.selectItem(null))},null,8,["item"])):a("",!0)])])])])],64))}}),ko={props:["item"],data(){return{need_import_from_google:!1,uploaded_variants_image:[],timer:null,importHandlesModal:null,importGoogleForm:{sheet_id:null,part:"handles",need_rewrite:!0},importForm:{files:[],need_rewrite:!0}}},mounted(){this.importHandlesModal=new bootstrap.Modal(document.getElementById("import-handles-form"),{}),this.importGoogleForm.sheet_id=localStorage.getItem("google_excel_handles_export_sheet_id")||null},methods:{onChangeFile(s){const t=s.target.files;for(let o=0;o<t.length;o++)this.importForm.files.push(t[o])},openImportFormModal(){this.importHandlesModal.show()},importFromGoogleSubmit(){let s=new FormData;localStorage.setItem("google_excel_handles_export_sheet_id",this.importGoogleForm.sheet_id),this.timer=0;let t=setInterval(()=>{this.timer++},1e3);Object.keys(this.importGoogleForm).forEach(o=>{const n=this.importGoogleForm[o]||"";typeof n=="object"?s.append(o,JSON.stringify(n)):s.append(o,n)}),this.$store.dispatch("importHandlesFromGoogle",{importForm:s}).then(o=>{window.open(o.url,"_blank").focus(),window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})},importSubmit(){let s=new FormData;this.timer=0;let t=setInterval(()=>{this.timer++},1e3);if(Object.keys(this.importForm).forEach(o=>{const n=this.importForm[o]||"";typeof n=="object"?s.append(o,JSON.stringify(n)):s.append(o,n)}),this.importForm.files.length>0){s.delete("files");for(let o=0;o<this.importForm.files.length;o++)s.append("files[]",this.importForm.files[o])}this.$store.dispatch("importHandlesFromExcel",{importForm:s}).then(o=>{window.dispatchEvent(new CustomEvent("load-handles",{detail:null})),this.importHandlesModal.hide(),this.$notify({title:"DoDoors",text:"Вы успешно загрузили данные"}),clearInterval(t),this.timer=null}).catch(()=>{clearInterval(t),this.timer=null,this.$notify({title:"DoDoors",text:"Ошибка загрузки данных",type:"error"})})}}},Fo=e("i",{class:"fa-solid fa-file-import"},null,-1),Co={class:"modal fade",id:"import-handles-form",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Ho={class:"modal-dialog"},jo={class:"modal-content rounded-0"},xo=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Форма загрузки таблицы"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),Io={class:"modal-body"},Mo={class:"row mb-3"},So={class:"col"},Do={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},Eo={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Go={key:0,class:"fa-solid fa-check mr-2"},Lo={class:"col"},Uo={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},Vo={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Oo={key:0,class:"fa-solid fa-check mr-2"},Po={class:"row mb-3"},To={class:"col"},Ao={class:"card-body cursor-pointer d-flex justify-content-center align-items-center"},No={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Ro={key:0,class:"fa-solid fa-check mr-2"},qo={class:"col"},Bo={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},zo={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},Jo={key:0,class:"fa-solid fa-check mr-2"},Wo={class:"form-floating my-3 border-gray-100 border"},Zo=e("label",{for:"excel-file-for-import"},"Файл-эксель",-1),Ko=["disabled"],Qo={key:0},Xo={class:"row mb-3"},Yo={class:"col"},es={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},ts={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},os={key:0,class:"fa-solid fa-check mr-2"},ss={class:"col"},ls={class:"card-body d-flex justify-content-center align-items-center text-center cursor-pointer"},is={style:{"line-height":"100%"},class:"d-flex justify-content-center align-items-center text-center mb-0"},ns={key:0,class:"fa-solid fa-check mr-2"},rs={class:"form-floating my-3 border-gray-100 border"},as=e("label",{for:"sheet-id"},"Идентификатор таблицы",-1),ds=["disabled"],cs={key:0},ms=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary rounded-0","data-bs-dismiss":"modal"},"Закрыть")],-1);function hs(s,t,o,n,l,c){return i(),r(_,null,[e("button",{class:"my-3 p-3 border-gray-100 border btn rounded-0",type:"button",onClick:t[0]||(t[0]=(...d)=>c.openImportFormModal&&c.openImportFormModal(...d))},[Fo,m(" Загрузить данные из таблицы ")]),e("div",Co,[e("div",Ho,[e("div",jo,[xo,e("div",Io,[e("div",Mo,[e("div",So,[e("div",{style:{"min-height":"80px"},onClick:t[1]||(t[1]=d=>l.need_import_from_google=!0),class:f([{"bg-dark text-white":l.need_import_from_google},"card rounded-0"])},[e("div",Do,[e("p",Eo,[l.need_import_from_google?(i(),r("i",Go)):a("",!0),m(" Загрузить из Google-таблицы")])])],2)]),e("div",Lo,[e("div",{style:{"min-height":"80px"},onClick:t[2]||(t[2]=d=>l.need_import_from_google=!1),class:f([{"bg-dark text-white":!l.need_import_from_google},"card rounded-0"])},[e("div",Uo,[e("p",Vo,[l.need_import_from_google?a("",!0):(i(),r("i",Oo)),m(" Загрузить из Excel-файла")])])],2)])]),l.need_import_from_google?(i(),r("form",{key:1,onSubmit:t[10]||(t[10]=y((...d)=>c.importFromGoogleSubmit&&c.importFromGoogleSubmit(...d),["prevent"]))},[e("div",Xo,[e("div",Yo,[e("div",{style:{"min-height":"80px"},onClick:t[7]||(t[7]=d=>l.importGoogleForm.need_rewrite=!0),class:f([{"bg-dark text-white":l.importGoogleForm.need_rewrite},"card rounded-0"])},[e("div",es,[e("p",ts,[l.importGoogleForm.need_rewrite?(i(),r("i",os)):a("",!0),m(" Перезаписать старые значения")])])],2)]),e("div",ss,[e("div",{style:{"min-height":"80px"},onClick:t[8]||(t[8]=d=>l.importGoogleForm.need_rewrite=!1),class:f([{"bg-dark text-white":!l.importGoogleForm.need_rewrite},"card rounded-0"])},[e("div",ls,[e("p",is,[l.importGoogleForm.need_rewrite?a("",!0):(i(),r("i",ns)),m(" Добавить новые значения")])])],2)])]),e("div",rs,[h(e("input",{type:"text",class:"form-control","onUpdate:modelValue":t[9]||(t[9]=d=>l.importGoogleForm.sheet_id=d),id:"sheet-id",placeholder:"name@example.com"},null,512),[[p,l.importGoogleForm.sheet_id]]),as]),e("button",{type:"submit",disabled:l.timer!=null,class:"btn btn-dark rounded-0 w-100 p-3"},[m("Загрузить "),l.timer!=null?(i(),r("span",cs,u(l.timer)+" сек",1)):a("",!0)],8,ds)],32)):(i(),r("form",{key:0,onSubmit:t[6]||(t[6]=y((...d)=>c.importSubmit&&c.importSubmit(...d),["prevent"]))},[e("div",Po,[e("div",To,[e("div",{style:{"min-height":"80px"},onClick:t[3]||(t[3]=d=>l.importForm.need_rewrite=!0),class:f([{"bg-dark text-white":l.importForm.need_rewrite},"card rounded-0"])},[e("div",Ao,[e("p",No,[l.importForm.need_rewrite?(i(),r("i",Ro)):a("",!0),m("Перезаписать старые значения")])])],2)]),e("div",qo,[e("div",{style:{"min-height":"80px"},onClick:t[4]||(t[4]=d=>l.importForm.need_rewrite=!1),class:f([{"bg-dark text-white":!l.importForm.need_rewrite},"card rounded-0"])},[e("div",Bo,[e("p",zo,[l.importForm.need_rewrite?a("",!0):(i(),r("i",Jo)),m(" Добавить новые значения")])])],2)])]),e("div",Wo,[e("input",{type:"file",class:"form-control",accept:".csv, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",id:"excel-file-for-import",ref:"importPriceFromExcel",onChange:t[5]||(t[5]=d=>c.onChangeFile(d))},null,544),Zo]),e("button",{type:"submit",disabled:l.timer!=null,class:"btn btn-dark rounded-0 w-100 p-3"},[m("Загрузить "),l.timer!=null?(i(),r("span",Qo,u(l.timer)+" сек",1)):a("",!0)],8,Ko)],32))]),ms])])])],64)}const ps=E(ko,[["render",hs]]),us=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Ручки",-1),_s={class:"py-12"},fs={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},gs={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},bs={class:"p-6 text-gray-900"},vs=e("hr",{class:"hr my-5"},null,-1),ys={data(){return{loading:!1,selectedHandle:null}},mounted(){this.$store.dispatch("loadRalColors")},methods:{selectHandle(s){this.selectedHandle=s,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackHandleForm(){this.loading=!0,this.selectedHandle=null,this.$nextTick(()=>{this.loading=!1})}}},Is=Object.assign(ys,{__name:"HandlesPage",setup(s){return(t,o)=>(i(),r(_,null,[v(x(I),{title:"Ручки"}),v(F,null,{header:$(()=>[us]),default:$(()=>[e("div",_s,[e("div",fs,[e("div",gs,[e("div",bs,[v(ps),t.loading?a("",!0):(i(),g(k,{key:0,item:t.selectedHandle,onCallback:t.callbackHandleForm},null,8,["item","onCallback"])),vs,t.loading?a("",!0):(i(),g(wo,{key:1,onSelect:t.selectHandle},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{Is as default};
