import{_ as C}from"./AuthenticatedLayout-D0Ysoo1C.js";import{m as v,o as s,c as n,b as e,g as p,v as $,f as d,e as l,F as _,r as m,t as r,d as h,q as O,a as f,w as b,u as g,s as k,p as L,Z as j}from"./app-BvYOzfhc.js";import{P as y}from"./Pagination-CXhOZLA_.js";import{_ as A}from"./CalcPreview-CWg6omY6.js";import{E as w}from"./main-B-qIJRNL.js";import"./ApplicationLogo-BJnfpv3O.js";import"./_plugin-vue_export-helper-DlAUqK2U.js";import"./vue-the-mask-VflqCbN2.js";import"./DoorItemEditor-CdBLkulR.js";import"./RalColorSelector-8fhTa7Y4.js";import"./HandleDetail-bntwaP0H.js";const D={class:"row"},I={class:"col-12"},V={class:"input-group mb-3"},E={class:"form-floating"},M=e("label",{for:"search-orderDetails"},"Поиск по деталям заказа",-1),P=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),T=[P],z={class:"d-flex scrollable-area"},B={key:0,class:"table"},F={key:0},U=e("i",{class:"fa-solid fa-caret-down"},null,-1),N=[U],R={key:1},S=e("i",{class:"fa-solid fa-caret-up"},null,-1),K=[S],q={key:0},G=e("i",{class:"fa-solid fa-caret-down"},null,-1),Z=[G],H={key:1},J=e("i",{class:"fa-solid fa-caret-up"},null,-1),Q=[J],W={key:0},X=e("i",{class:"fa-solid fa-caret-down"},null,-1),Y=[X],x={key:1},tt=e("i",{class:"fa-solid fa-caret-up"},null,-1),et=[tt],st={key:0},ot=e("i",{class:"fa-solid fa-caret-down"},null,-1),nt=[ot],lt={key:1},at=e("i",{class:"fa-solid fa-caret-up"},null,-1),it=[at],dt={key:0},rt=e("i",{class:"fa-solid fa-caret-down"},null,-1),ct=[rt],ut={key:1},_t=e("i",{class:"fa-solid fa-caret-up"},null,-1),ht=[_t],pt={key:0},mt=e("i",{class:"fa-solid fa-caret-down"},null,-1),ft=[mt],bt={key:1},kt=e("i",{class:"fa-solid fa-caret-up"},null,-1),vt=[kt],$t={key:0},gt=e("i",{class:"fa-solid fa-caret-down"},null,-1),yt=[gt],wt={key:1},Ct=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ot=[Ct],Lt={key:0},jt=e("i",{class:"fa-solid fa-caret-down"},null,-1),At=[jt],Dt={key:1},It=e("i",{class:"fa-solid fa-caret-up"},null,-1),Vt=[It],Et=e("th",{scope:"col",class:"text-center"},"Действие",-1),Mt={scope:"row"},Pt=["onClick"],Tt={class:"text-center"},zt={class:"text-center"},Bt={class:"text-center"},Ft={class:"text-center"},Ut={class:"text-center"},Nt={class:"text-center"},Rt={class:"text-center"},St={class:"dropdown"},Kt=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),qt={class:"dropdown-menu"},Gt=["onClick"],Zt=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),Ht=["onClick"],Jt=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),Qt={key:0,class:"alert alert-success",role:"alert"},Wt=e("h4",{class:"alert-heading"},"Детали заказа",-1),Xt=e("p",null,"К сожалению,в данном заказе нет деталей заказа",-1),Yt=[Wt,Xt],xt={key:1,class:"row mb-3"},te={class:"col-12"},ee={props:["orderId"],data(){return{sort:{column:null,direction:"desc"},search:null,current_page:0,paginate_object:null,items:[{id:null,title:null,price:0,variants:[]}]}},computed:{...v(["getOrderDetails","getOrderDetailsPaginateObject"])},mounted(){this.loadOrderDetails()},methods:{sortAndLoad(i){this.sort.column=i,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadOrderDetails(this.current_page)},loadOrderDetails(i=0){this.current_page=i,this.$store.dispatch("loadOrderDetails",{dataObject:{order_id:this.orderId,search:this.search,order:this.sort.column,direction:this.sort.direction},page:this.current_page}).then(t=>{this.items=this.getOrderDetails,this.paginate_object=this.getOrderDetailsPaginateObject}).catch(()=>{this.loading=!1})},selectItem(i){this.$emit("select",i)},duplicateItem(i){this.$store.dispatch("duplicateOrderDetail",{orderDetailId:i}).then(()=>{this.sortAndLoad("id")})},removeItem(i){this.$store.dispatch("removeOrderDetail",{orderDetailId:i}).then(()=>{this.sortAndLoad("id")})}}},se=Object.assign(ee,{__name:"OrderDetailTable",setup(i){return(t,a)=>(s(),n(_,null,[e("form",D,[e("div",I,[e("div",V,[e("div",E,[p(e("input",{type:"search","onUpdate:modelValue":a[0]||(a[0]=o=>t.search=o),class:"form-control",id:"search-orderDetails"},null,512),[[$,t.search]]),M]),e("button",{type:"button",onClick:a[1]||(a[1]=o=>t.sortAndLoad("id")),class:"btn btn-outline-secondary rounded-0"},T)])])]),e("div",z,[t.items.length>0?(s(),n("table",B,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:a[2]||(a[2]=o=>t.sortAndLoad("id"))},[d("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(s(),n("span",F,N)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(s(),n("span",R,K)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:a[3]||(a[3]=o=>t.sortAndLoad("door_type"))},[d("Тип двери "),t.sort.direction==="desc"&&t.sort.column==="door_type"?(s(),n("span",q,Z)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="door_type"?(s(),n("span",H,Q)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:a[4]||(a[4]=o=>t.sortAndLoad("count"))},[d("Кол-во "),t.sort.direction==="desc"&&t.sort.column==="count"?(s(),n("span",W,Y)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="count"?(s(),n("span",x,et)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:a[5]||(a[5]=o=>t.sortAndLoad("price"))},[d("Цена "),t.sort.direction==="desc"&&t.sort.column==="price"?(s(),n("span",st,nt)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="price"?(s(),n("span",lt,it)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:a[6]||(a[6]=o=>t.sortAndLoad("comment"))},[d("Комментарий "),t.sort.direction==="desc"&&t.sort.column==="comment"?(s(),n("span",dt,ct)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="comment"?(s(),n("span",ut,ht)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:a[7]||(a[7]=o=>t.sortAndLoad("purpose"))},[d("Назначение двери "),t.sort.direction==="desc"&&t.sort.column==="purpose"?(s(),n("span",pt,ft)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="purpose"?(s(),n("span",bt,vt)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:a[8]||(a[8]=o=>t.sortAndLoad("door"))},[d("Параметры двери "),t.sort.direction==="desc"&&t.sort.column==="door"?(s(),n("span",$t,yt)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="door"?(s(),n("span",wt,Ot)):l("",!0)]),e("th",{scope:"col",class:"text-center cursor-pointer",onClick:a[9]||(a[9]=o=>t.sortAndLoad("updated_at"))},[d(" Дата изменения "),t.sort.direction==="desc"&&t.sort.column==="updated_at"?(s(),n("span",Lt,At)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="updated_at"?(s(),n("span",Dt,Vt)):l("",!0)]),Et])]),e("tbody",null,[(s(!0),n(_,null,m(t.items,(o,u)=>(s(),n("tr",null,[e("th",Mt,r(o.id||u),1),e("td",{class:"text-center",onClick:c=>t.selectItem(o)},r(o.door_type||"-"),9,Pt),e("td",Tt,r(o.count||0),1),e("td",zt,r(o.price||0),1),e("td",Bt,r(o.comment||"-"),1),e("td",Ft,r(o.purpose||"-"),1),e("td",Ut,r(o.door||"-"),1),e("td",Nt,r(o.updated_at||"-"),1),e("td",Rt,[e("div",St,[Kt,e("ul",qt,[e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItem(o),href:"javascript:void(0)"},[Zt,d("Редактировать")],8,Gt)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(o.id),href:"javascript:void(0)"},[Jt,d("Удалить")],8,Ht)])])])])]))),256))])])):l("",!0)]),t.items.length===0?(s(),n("div",Qt,Yt)):l("",!0),t.items.length>0?(s(),n("div",xt,[e("div",te,[t.paginate_object?(s(),h(y,{key:0,onPagination_page:t.loadOrderDetails,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):l("",!0)],64))}}),oe={class:"row"},ne={class:"col-12"},le={class:"input-group mb-3"},ae={class:"form-floating"},ie=e("label",{for:"search-orders"},"Поиск по заказам",-1),de={class:"dropdown"},re=e("button",{class:"btn btn-outline-secondary rounded-0 h-100",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-up-right-and-down-left-from-center"})],-1),ce={class:"dropdown-menu"},ue=e("i",{class:"fa-solid fa-magnifying-glass"},null,-1),_e=e("i",{class:"fa-regular fa-file-excel"},null,-1),he={class:"col-12"},pe={class:"action-row"},me=["onClick"],fe=["onClick"],be={class:"col-12"},ke=["onClick"],ve=e("i",{class:"fa-solid fa-retweet"},null,-1),$e=[ve],ge=e("i",{class:"fa-solid fa-xmark"},null,-1),ye=[ge],we={key:0,class:"my-2 small italic"},Ce={class:"d-flex scrollable-area"},Oe={key:0,class:"table"},Le={key:0},je=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ae=[je],De={key:1},Ie=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ve=[Ie],Ee=e("th",{scope:"col",class:"text-center"},"Действие",-1),Me={key:0},Pe=e("i",{class:"fa-solid fa-caret-down"},null,-1),Te=[Pe],ze={key:1},Be=e("i",{class:"fa-solid fa-caret-up"},null,-1),Fe=[Be],Ue={key:0},Ne=e("i",{class:"fa-solid fa-caret-down"},null,-1),Re=[Ne],Se={key:1},Ke=e("i",{class:"fa-solid fa-caret-up"},null,-1),qe=[Ke],Ge={key:0},Ze=e("i",{class:"fa-solid fa-caret-down"},null,-1),He=[Ze],Je={key:1},Qe=e("i",{class:"fa-solid fa-caret-up"},null,-1),We=[Qe],Xe={key:0},Ye=e("i",{class:"fa-solid fa-caret-down"},null,-1),xe=[Ye],ts={key:1},es=e("i",{class:"fa-solid fa-caret-up"},null,-1),ss=[es],os={key:0},ns=e("i",{class:"fa-solid fa-caret-down"},null,-1),ls=[ns],as={key:1},is=e("i",{class:"fa-solid fa-caret-up"},null,-1),ds=[is],rs={key:0},cs=e("i",{class:"fa-solid fa-caret-down"},null,-1),us=[cs],_s={key:1},hs=e("i",{class:"fa-solid fa-caret-up"},null,-1),ps=[hs],ms={key:0},fs=e("i",{class:"fa-solid fa-caret-down"},null,-1),bs=[fs],ks={key:1},vs=e("i",{class:"fa-solid fa-caret-up"},null,-1),$s=[vs],gs={key:0},ys=e("i",{class:"fa-solid fa-caret-down"},null,-1),ws=[ys],Cs={key:1},Os=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ls=[Os],js={key:0},As=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ds=[As],Is={key:1},Vs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Es=[Vs],Ms={key:0},Ps=e("i",{class:"fa-solid fa-caret-down"},null,-1),Ts=[Ps],zs={key:1},Bs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Fs=[Bs],Us={key:0},Ns=e("i",{class:"fa-solid fa-caret-down"},null,-1),Rs=[Ns],Ss={key:1},Ks=e("i",{class:"fa-solid fa-caret-up"},null,-1),qs=[Ks],Gs={key:0},Zs=e("i",{class:"fa-solid fa-caret-down"},null,-1),Hs=[Zs],Js={key:1},Qs=e("i",{class:"fa-solid fa-caret-up"},null,-1),Ws=[Qs],Xs={key:0},Ys=e("i",{class:"fa-solid fa-caret-down"},null,-1),xs=[Ys],to={key:1},eo=e("i",{class:"fa-solid fa-caret-up"},null,-1),so=[eo],oo={scope:"row"},no={class:"text-center"},lo={class:"dropdown"},ao=e("button",{class:"btn btn-link",type:"button","data-bs-toggle":"dropdown","aria-expanded":"false"},[e("i",{class:"fa-solid fa-bars"})],-1),io={class:"dropdown-menu"},ro=["href"],co=e("i",{class:"fa-regular fa-file-excel mr-2"},null,-1),uo=["onClick"],_o=e("i",{class:"fa-solid fa-file-signature mr-2"},null,-1),ho=["onClick"],po=e("i",{class:"fa-solid fa-pen mr-2"},null,-1),mo=["onClick"],fo=e("i",{class:"fa-solid fa-trash-can mr-2"},null,-1),bo=["onClick"],ko=["onClick"],vo={key:2,class:"text-center"},$o={key:3,class:"text-center"},go={key:4,class:"text-center"},yo={key:0},wo={key:1},Co={key:5,class:"text-center"},Oo={key:6,class:"text-center"},Lo={key:7,class:"text-center"},jo={key:8,class:"text-center"},Ao={key:9,class:"text-center"},Do={key:10,class:"text-center"},Io={key:11,class:"text-center"},Vo={key:12,class:"text-center"},Eo={key:1,class:"alert alert-success rounded-0",role:"alert"},Mo=e("h4",{class:"alert-heading"},"Заказы",-1),Po=e("p",null,"К сожалению, раздел заказов пуст.",-1),To=[Mo,Po],zo={key:2,class:"row mb-3"},Bo={class:"col-12"},Fo={class:"modal fade",id:"order-details",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Uo={class:"modal-dialog modal-fullscreen"},No={class:"modal-content"},Ro=e("div",{class:"modal-header"},[e("h1",{class:"modal-title fs-5",id:"exampleModalLabel"},"Детали заказа"),e("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},[e("i",{class:"fa-solid fa-xmark"})])],-1),So={class:"modal-body"},Ko=e("div",{class:"modal-footer"},[e("button",{type:"button",class:"btn btn-outline-secondary rounded-0","data-bs-dismiss":"modal"},"Закрыть ")],-1),qo={class:"modal fade",id:"confirm-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},Go={class:"modal-dialog modal-dialog-centered"},Zo={class:"modal-content rounded-0"},Ho={class:"modal-body"},Jo=e("div",{class:"d-flex justify-center p-3"},[e("img",{src:"/images/logo.png",style:{width:"100px"},alt:""})],-1),Qo={class:"font-bold text-center py-3"},Wo={class:"text-center pb-3"},Xo={class:"row mb-3"},Yo={class:"col-md-6 d-flex justify-center"},xo={class:"form-check"},tn=e("label",{class:"form-check-label",for:"work-with-nds"}," Работаю с НДС ",-1),en={class:"col-md-6 d-flex justify-center"},sn={class:"form-check"},on=e("label",{class:"form-check-label",for:"work-without-nds"}," Работаю без НДС ",-1),nn={class:"row"},ln={class:"col-6"},an={class:"col-6"},dn={class:"modal fade",id:"order-editor-modal",tabindex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true"},rn={class:"modal-dialog modal-xl"},cn={class:"modal-content rounded-0"},un={class:"modal-body"},_n={components:{VueDatePicker:w},data(){return{editor_modal:null,selected_item:null,table:{contract_number:{title:"Номер договора",value:!0},contract_date:{title:"Дата договора",value:!0},completion_at:{title:"Дата закрытия",value:!0},client_id:{title:"Идентификатор клиента",value:!0},status:{title:"Статус",value:!0},source:{title:"Источник",value:!0},contact_person:{title:"Контактное лицо",value:!0},phone:{title:"Номер телефона",value:!0},organizational_form:{title:"Организационная форма",value:!0},contract_amount:{title:"Сумма договора",value:!0},paid:{title:"Оплачено",value:!0},debt:{title:"Остаток",value:!0},profit:{title:"Доход",value:!0}},sort:{column:null,date:null,direction:"desc"},selected_order:null,order_detail_modal:null,order_status:["Новый заказ","В работе","Завершен"],search:null,current_page:0,paginate_object:null,loading:!1,confirm_modal:null,confirm:{title:null,message:null,work_with_nds:1,item:null},items:[{id:null,contract_number:null,contract_date:null,completion_at:null,client_id:null,status:null,source:null,contact_person:null,phone:null,organizational_form:null,contract_amount:null,paid:null,debt:null,profit:null}]}},computed:{...v(["getOrders","getOrdersPaginateObject"])},mounted(){this.loadOrders(),this.order_detail_modal=new bootstrap.Modal(document.getElementById("order-details"),{}),this.confirm_modal=new bootstrap.Modal(document.getElementById("confirm-modal"),{}),this.editor_modal=new bootstrap.Modal(document.getElementById("order-editor-modal"),{})},methods:{resetColumns(){Object.keys(this.table).forEach(i=>{this.table[i].value=!0})},changeColumns(i){i?this.table[i].value=!this.table[i].value:Object.keys(this.table).forEach(t=>{this.table[t].value=!this.table[t].value})},openConfirmModal(i,t,a){this.confirm.title=i||null,this.confirm.message=t||null,this.confirm.item=a||null,this.confirm_modal.show()},sortAndLoad(i){this.sort.column=i,this.sort.direction=this.sort.direction==="desc"?"asc":"desc",this.loadOrders(this.current_page)},filteredDownload(){let i=this.sort,t=(i.date||[]).length>0?new Date(i.date[0]).getTime():null,a=(i.date||[]).length>1?new Date(i.date[1]).getTime():null,o="/orders/download-filtered-orders?order=id";t&&a&&(o+=`&df=${t}&dt=${a}`),this.search&&(o+=`&search=${this.search||null}`),window.open(o,"_blank").focus()},downloadDocument(){let i=this.confirm.item;window.open(`/orders/download-contract?c=${i.client_id}&o=${i.id}&nds=${this.confirm.work_with_nds}`,"_blank").focus(),this.confirm_modal.hide()},loadOrders(i=0){this.current_page=i;let t=this.sort,a=(t.date||[]).length>0?t.date[0]:null,o=(t.date||[]).length>1?t.date[1]:null;this.$store.dispatch("loadOrders",{dataObject:{search:this.search,order:this.sort.column,direction:this.sort.direction,df:a||null,dt:o||null},page:this.current_page}).then(u=>{this.items=this.getOrders,this.paginate_object=this.getOrdersPaginateObject}).catch(()=>{this.loading=!1})},selectItemForEdit(i){if(i==null){this.selected_item=null,this.editor_modal.hide();return}this.selected_item=null,this.$nextTick(()=>{this.selected_item=i,this.editor_modal.show()})},selectItem(i){this.loading=!0,this.selected_order=i,this.$nextTick(()=>{this.loading=!1,this.order_detail_modal.show()})},duplicateItem(i){this.$store.dispatch("duplicateOrder",{materialId:i}).then(()=>{this.sortAndLoad("id")})},removeItem(i){this.$store.dispatch("removeOrder",{materialId:i}).then(()=>{this.sortAndLoad("id")})}}},hn=Object.assign(_n,{__name:"OrderTable",setup(i){return(t,a)=>(s(),n(_,null,[e("div",oe,[e("div",ne,[e("div",le,[e("div",ae,[p(e("input",{type:"search","onUpdate:modelValue":a[0]||(a[0]=o=>t.search=o),onKeydown:a[1]||(a[1]=O(o=>t.sortAndLoad("id"),["enter"])),class:"form-control",id:"search-orders"},null,544),[[$,t.search]]),ie]),e("div",de,[re,e("ul",ce,[e("li",null,[e("a",{class:"dropdown-item",href:"javascript:void(0)",onClick:a[2]||(a[2]=o=>t.sortAndLoad("id"))},[ue,d(" Искать")])]),e("li",null,[e("a",{class:"dropdown-item",onClick:a[3]||(a[3]=(...o)=>t.filteredDownload&&t.filteredDownload(...o)),href:"javascript:void(0)"},[_e,d(" Скачать в Excel ")])])])])])]),e("div",he,[f(g(w),{class:"rounded-0",locale:"ru",range:"","multi-calendars":"",modelValue:t.sort.date,"onUpdate:modelValue":a[4]||(a[4]=o=>t.sort.date=o)},{"action-row":b(({internalModelValue:o,selectDate:u,closePicker:c})=>[e("div",pe,[e("button",{class:"btn btn-dark rounded-0 mr-2",onClick:u},"Выбрать",8,me),e("button",{class:"btn btn-outline-secondary rounded-0",onClick:c},"Закрыть",8,fe)])]),_:1},8,["modelValue"])]),e("div",be,[(s(!0),n(_,null,m(Object.keys(t.table),o=>(s(),n("span",{class:L(["badge mr-1 rounded-0 cursor-pointer",{"bg-dark":t.table[o].value===!0,"bg-secondary":t.table[o].value===!1}]),onClick:u=>t.changeColumns(o)},r(t.table[o].title||"-"),11,ke))),256)),e("span",{onClick:a[5]||(a[5]=o=>t.changeColumns(null)),class:"badge mr-1 bg-danger rounded-0 cursor-pointer"},$e),e("span",{onClick:a[6]||(a[6]=(...o)=>t.resetColumns&&t.resetColumns(...o)),class:"badge mr-1 bg-secondary rounded-0 cursor-pointer"},ye)])]),t.paginate_object?(s(),n("p",we,[d("Найдено результатов "),e("strong",null,r(t.paginate_object.meta.total),1)])):l("",!0),e("div",Ce,[t.items.length>0?(s(),n("table",Oe,[e("thead",null,[e("tr",null,[e("th",{scope:"col",class:"cursor-pointer",onClick:a[7]||(a[7]=o=>t.sortAndLoad("id"))},[d("# "),t.sort.direction==="desc"&&t.sort.column==="id"?(s(),n("span",Le,Ae)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="id"?(s(),n("span",De,Ve)):l("",!0)]),Ee,t.table.contract_number.value?(s(),n("th",{key:0,scope:"col",class:"text-center cursor-pointer",onClick:a[8]||(a[8]=o=>t.sortAndLoad("contract_number"))},[d("Номер договора "),t.sort.direction==="desc"&&t.sort.column==="contract_number"?(s(),n("span",Me,Te)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_number"?(s(),n("span",ze,Fe)):l("",!0)])):l("",!0),t.table.contract_date.value?(s(),n("th",{key:1,scope:"col",class:"text-center cursor-pointer",onClick:a[9]||(a[9]=o=>t.sortAndLoad("contract_date"))},[d("Дата договора "),t.sort.direction==="desc"&&t.sort.column==="contract_date"?(s(),n("span",Ue,Re)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_date"?(s(),n("span",Se,qe)):l("",!0)])):l("",!0),t.table.completion_at.value?(s(),n("th",{key:2,scope:"col",class:"text-center cursor-pointer",onClick:a[10]||(a[10]=o=>t.sortAndLoad("completion_at"))},[d("Дата закрытия "),t.sort.direction==="desc"&&t.sort.column==="completion_at"?(s(),n("span",Ge,He)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="completion_at"?(s(),n("span",Je,We)):l("",!0)])):l("",!0),t.table.client_id.value?(s(),n("th",{key:3,scope:"col",class:"text-center cursor-pointer",onClick:a[11]||(a[11]=o=>t.sortAndLoad("client_id"))},[d("Клиент "),t.sort.direction==="desc"&&t.sort.column==="client_id"?(s(),n("span",Xe,xe)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="client_id"?(s(),n("span",ts,ss)):l("",!0)])):l("",!0),t.table.status.value?(s(),n("th",{key:4,scope:"col",class:"text-center cursor-pointer",onClick:a[12]||(a[12]=o=>t.sortAndLoad("status"))},[d("Статус заказа "),t.sort.direction==="desc"&&t.sort.column==="status"?(s(),n("span",os,ls)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="status"?(s(),n("span",as,ds)):l("",!0)])):l("",!0),t.table.source.value?(s(),n("th",{key:5,scope:"col",class:"text-center cursor-pointer",onClick:a[13]||(a[13]=o=>t.sortAndLoad("source"))},[d("Источник "),t.sort.direction==="desc"&&t.sort.column==="source"?(s(),n("span",rs,us)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="source"?(s(),n("span",_s,ps)):l("",!0)])):l("",!0),t.table.contact_person.value?(s(),n("th",{key:6,scope:"col",class:"text-center cursor-pointer",onClick:a[14]||(a[14]=o=>t.sortAndLoad("contact_person"))},[d("Контактное лицо "),t.sort.direction==="desc"&&t.sort.column==="contact_person"?(s(),n("span",ms,bs)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="contact_person"?(s(),n("span",ks,$s)):l("",!0)])):l("",!0),t.table.phone.value?(s(),n("th",{key:7,scope:"col",class:"text-center cursor-pointer",onClick:a[15]||(a[15]=o=>t.sortAndLoad("phone"))},[d("Телефон "),t.sort.direction==="desc"&&t.sort.column==="phone"?(s(),n("span",gs,ws)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="phone"?(s(),n("span",Cs,Ls)):l("",!0)])):l("",!0),t.table.organizational_form.value?(s(),n("th",{key:8,scope:"col",class:"text-center cursor-pointer",onClick:a[16]||(a[16]=o=>t.sortAndLoad("organizational_form"))},[d("На ип\\ооо "),t.sort.direction==="desc"&&t.sort.column==="organizational_form"?(s(),n("span",js,Ds)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="organizational_form"?(s(),n("span",Is,Es)):l("",!0)])):l("",!0),t.table.contract_amount.value?(s(),n("th",{key:9,scope:"col",class:"text-center cursor-pointer",onClick:a[17]||(a[17]=o=>t.sortAndLoad("contract_amount"))},[d("Сумма договора "),t.sort.direction==="desc"&&t.sort.column==="contract_amount"?(s(),n("span",Ms,Ts)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="contract_amount"?(s(),n("span",zs,Fs)):l("",!0)])):l("",!0),t.table.paid.value?(s(),n("th",{key:10,scope:"col",class:"text-center cursor-pointer",onClick:a[18]||(a[18]=o=>t.sortAndLoad("paid"))},[d("Оплачено "),t.sort.direction==="desc"&&t.sort.column==="paid"?(s(),n("span",Us,Rs)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="paid"?(s(),n("span",Ss,qs)):l("",!0)])):l("",!0),t.table.debt.value?(s(),n("th",{key:11,scope:"col",class:"text-center cursor-pointer",onClick:a[19]||(a[19]=o=>t.sortAndLoad("debt"))},[d("Задолженность "),t.sort.direction==="desc"&&t.sort.column==="debt"?(s(),n("span",Gs,Hs)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="debt"?(s(),n("span",Js,Ws)):l("",!0)])):l("",!0),t.table.profit.value?(s(),n("th",{key:12,scope:"col",class:"text-center cursor-pointer",onClick:a[20]||(a[20]=o=>t.sortAndLoad("profit"))},[d("Прибыль "),t.sort.direction==="desc"&&t.sort.column==="profit"?(s(),n("span",Xs,xs)):l("",!0),t.sort.direction==="asc"&&t.sort.column==="profit"?(s(),n("span",to,so)):l("",!0)])):l("",!0)])]),e("tbody",null,[(s(!0),n(_,null,m(t.items,(o,u)=>(s(),n("tr",null,[e("th",oo,r(o.id||u),1),e("td",no,[e("div",lo,[ao,e("ul",io,[e("li",null,[e("a",{class:"dropdown-item",target:"_blank",href:"/orders/download-order-excel/"+o.id},[co,d("Скачать Excel-документ по заказу")],8,ro)]),e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.openConfirmModal("Подготовка договора","Вам необходимо выбрать как вам предпочтительнее работать",o),href:"javascript:void(0)"},[_o,d("Скачать договор")],8,uo)]),e("li",null,[e("a",{class:"dropdown-item",onClick:c=>t.selectItemForEdit(o),href:"javascript:void(0)"},[po,d("Редактор заказа")],8,ho)]),e("li",null,[e("a",{class:"dropdown-item text-danger",onClick:c=>t.removeItem(o.id),href:"javascript:void(0)"},[fo,d("Удалить")],8,mo)])])])]),t.table.contract_number.value?(s(),n("td",{key:0,class:"text-center",onClick:c=>t.selectItem(o)},r(o.contract_number||"-"),9,bo)):l("",!0),t.table.contract_date.value?(s(),n("td",{key:1,class:"text-center",onClick:c=>t.selectItem(o)},r(o.contract_date||"-"),9,ko)):l("",!0),t.table.completion_at.value?(s(),n("td",vo,r(o.completion_at||"-"),1)):l("",!0),t.table.client_id.value?(s(),n("td",$o,r(o.client_id||"-"),1)):l("",!0),t.table.status.value?(s(),n("td",go,[(o.status||0)<=2?(s(),n("span",yo,r(t.order_status[o.status]),1)):(s(),n("span",wo,"Не указан"))])):l("",!0),t.table.source.value?(s(),n("td",Co,r(o.source||"-"),1)):l("",!0),t.table.contact_person.value?(s(),n("td",Oo,r(o.contact_person||"-"),1)):l("",!0),t.table.phone.value?(s(),n("td",Lo,r(o.phone||"-"),1)):l("",!0),t.table.organizational_form.value?(s(),n("td",jo,r(o.organizational_form||"-"),1)):l("",!0),t.table.contract_amount.value?(s(),n("td",Ao,r(o.contract_amount||0),1)):l("",!0),t.table.paid.value?(s(),n("td",Do,r(o.paid||0),1)):l("",!0),t.table.debt.value?(s(),n("td",Io,r(o.debt||0),1)):l("",!0),t.table.profit.value?(s(),n("td",Vo,r(o.profit||0),1)):l("",!0)]))),256))])])):l("",!0)]),t.items.length===0?(s(),n("div",Eo,To)):l("",!0),t.items.length>0?(s(),n("div",zo,[e("div",Bo,[t.paginate_object?(s(),h(y,{key:0,onPagination_page:t.loadOrders,pagination:t.paginate_object},null,8,["onPagination_page","pagination"])):l("",!0)])])):l("",!0),e("div",Fo,[e("div",Uo,[e("div",No,[Ro,e("div",So,[t.selected_order&&!t.loading?(s(),h(se,{key:0,"order-id":t.selected_order.id},null,8,["order-id"])):l("",!0)]),Ko])])]),e("div",qo,[e("div",Go,[e("div",Zo,[e("div",Ho,[Jo,e("h3",Qo,r(t.confirm.title||"-"),1),e("p",Wo,r(t.confirm.message||"-"),1),e("div",Xo,[e("div",Yo,[e("div",xo,[p(e("input",{class:"form-check-input",type:"radio",value:"1","onUpdate:modelValue":a[21]||(a[21]=o=>t.confirm.work_with_nds=o),name:"flexRadioDefault",id:"work-with-nds"},null,512),[[k,t.confirm.work_with_nds]]),tn])]),e("div",en,[e("div",sn,[p(e("input",{class:"form-check-input",type:"radio",value:"0",name:"flexRadioDefault","onUpdate:modelValue":a[22]||(a[22]=o=>t.confirm.work_with_nds=o),id:"work-without-nds"},null,512),[[k,t.confirm.work_with_nds]]),on])])]),e("div",nn,[e("div",ln,[e("button",{class:"btn btn-dark rounded-0 w-100",type:"button",onClick:a[23]||(a[23]=(...o)=>t.downloadDocument&&t.downloadDocument(...o))},"Скачать договор ")]),e("div",an,[e("button",{class:"btn btn-outline-secondary rounded-0 w-100",onClick:a[24]||(a[24]=o=>t.confirm_modal.hide())}," Закрыть ")])])])])])]),e("div",dn,[e("div",rn,[e("div",cn,[e("div",un,[t.selected_item?(s(),h(A,{key:0,"can-edit":!0,doors:t.selected_item.details,order:t.selected_item},null,8,["doors","order"])):l("",!0)])])])])],64))}}),pn=e("h2",{class:"font-semibold text-xl text-gray-800 leading-tight"},"Заказы",-1),mn={class:"py-12"},fn={class:"max-w-7xl mx-auto sm:px-6 lg:px-8"},bn={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg"},kn={class:"p-6 text-gray-900"},vn={data(){return{loading:!1,selectedOrder:null}},methods:{selectOrder(i){this.selectedOrder=i,this.loading=!0,this.$nextTick(()=>{this.loading=!1})},callbackOrderForm(){this.loading=!0,this.selectedOrder=null,this.$nextTick(()=>{this.loading=!1})}}},Vn=Object.assign(vn,{__name:"OrdersPage",setup(i){return(t,a)=>(s(),n(_,null,[f(g(j),{title:"Заказы"}),f(C,null,{header:b(()=>[pn]),default:b(()=>[e("div",mn,[e("div",fn,[e("div",bn,[e("div",kn,[t.loading?l("",!0):(s(),h(hn,{key:0,onSelect:t.selectOrder},null,8,["onSelect"]))])])])])]),_:1})],64))}});export{Vn as default};
